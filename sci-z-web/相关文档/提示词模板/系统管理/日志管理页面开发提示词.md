# 日志管理页面开发提示词

## 📋 页面信息
- **页面名称**: 日志管理
- **文件路径**: `src/views/System/Logs.vue`
- **路由路径**: `/system/logs`
- **权限代码**: `system:logs:view`

## 🎯 开发要求

### 页面结构
1. **页面头部**: 标题 + 操作按钮（导出日志、清空日志）
2. **搜索筛选区域**: 日志级别筛选 + 日期范围筛选 + 用户筛选 + 搜索/重置按钮
3. **日志列表表格**: 使用Element Plus表格组件展示日志信息
4. **分页组件**: 使用Element Plus分页组件
5. **日志详情对话框**: 显示完整的日志信息，包括请求参数和响应结果

### 组件使用
- **布局组件**: `MainLayout` (默认布局)
- **通用组件**: `BaseCard`, `BaseButton`, `BasePagination`
- **业务组件**: `DataTable`, `SearchForm`, `ActionButtons`
- **Element Plus**: `el-table`, `el-table-column`, `el-dialog`, `el-tag`, `el-date-picker`, `el-select`, `el-input`

### 核心功能实现
1. **日志列表展示**: 时间、级别、用户、操作、IP地址、详情
2. **搜索筛选**: 日志级别筛选、日期范围筛选、用户筛选
3. **日志操作**: 查看详情、导出日志、清空日志
4. **级别标识**: 不同日志级别使用不同颜色的标签
5. **权限控制**: 根据用户权限显示不同操作按钮

### 信息展示
- **基本信息**: 时间戳、日志级别、操作用户、操作内容
- **网络信息**: IP地址、用户代理
- **详细信息**: 请求参数、响应结果、错误详情
- **统计信息**: 总日志数量、各级别日志数量

## 📝 代码结构

### Vue模板结构
```vue
<template>
  <div class="log-management-container">
    <!-- 页面头部 -->
    <div class="page-header">
      <h1 class="page-title">{{ $t('system.logs.title') }}</h1>
      <div class="header-actions">
        <el-button @click="handleExport" :loading="exporting">
          <el-icon><Download /></el-icon>
          {{ $t('system.logs.exportLogs') }}
        </el-button>
        <el-button type="danger" @click="handleClear">
          <el-icon><Delete /></el-icon>
          {{ $t('system.logs.clearLogs') }}
        </el-button>
      </div>
    </div>

    <!-- 内容卡片 -->
    <BaseCard>
      <!-- 筛选区域 -->
      <div class="filter-section">
        <div class="filter-item">
          <span class="filter-label">{{ $t('system.logs.logLevel') }}</span>
          <el-select
            v-model="searchForm.level"
            :placeholder="$t('common.all')"
            clearable
            style="width: 150px"
            @change="handleSearch"
          >
            <el-option :label="$t('common.all')" value="" />
            <el-option 
              v-for="option in logLevelOptions" 
              :key="option.value" 
              :label="option.label" 
              :value="option.value" 
            />
          </el-select>
        </div>

        <div class="filter-item">
          <span class="filter-label">{{ $t('system.logs.dateRange') }}</span>
          <el-date-picker
            v-model="searchForm.dateRange"
            type="daterange"
            range-separator="至"
            :start-placeholder="$t('system.logs.startDate')"
            :end-placeholder="$t('system.logs.endDate')"
            value-format="YYYY-MM-DD"
            style="width: 300px"
            @change="handleSearch"
          />
        </div>

        <div class="filter-item">
          <span class="filter-label">{{ $t('system.logs.user') }}</span>
          <el-input
            v-model="searchForm.user"
            :placeholder="$t('system.logs.userPlaceholder')"
            clearable
            style="width: 200px"
            @clear="handleSearch"
          >
            <template #prefix>
              <el-icon><Search /></el-icon>
            </template>
          </el-input>
        </div>

        <el-button type="primary" @click="handleSearch">{{ $t('common.search') }}</el-button>
        <el-button @click="handleReset">{{ $t('common.reset') }}</el-button>
      </div>

      <!-- 日志列表表格 -->
      <el-table
        :data="filteredLogs"
        v-loading="loading"
        stripe
        border
        style="width: 100%"
      >
        <el-table-column prop="timestamp" :label="$t('system.logs.time')" width="180" />
        <el-table-column prop="level" :label="$t('system.logs.level')" width="100" align="center">
          <template #default="{ row }">
            <el-tag :type="getLevelTagType(row.level)">
              {{ row.level }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column prop="user" :label="$t('system.logs.user')" width="120" align="center" />
        <el-table-column prop="operation" :label="$t('system.logs.operation')" width="200" show-overflow-tooltip />
        <el-table-column prop="ip" :label="$t('system.logs.ipAddress')" width="150" align="center" />
        <el-table-column prop="detail" :label="$t('system.logs.detail')" min-width="250" show-overflow-tooltip />
        <el-table-column :label="$t('common.actions')" width="100" fixed="right" align="center">
          <template #default="{ row }">
            <el-button size="small" type="primary" @click="handleViewDetail(row)">
              {{ $t('system.logs.viewDetail') }}
            </el-button>
          </template>
        </el-table-column>
      </el-table>

      <!-- 分页 -->
      <BasePagination
        v-model:current-page="pagination.current"
        v-model:page-size="pagination.size"
        :total="pagination.total"
        @current-change="handlePageChange"
        @size-change="handleSizeChange"
      />
    </BaseCard>

    <!-- 日志详情对话框 -->
    <el-dialog
      v-model="showDetailDialog"
      :title="$t('system.logs.logDetail')"
      width="700px"
      @close="handleDetailDialogClose"
    >
      <div class="log-detail" v-if="currentLog">
        <div class="detail-row">
          <div class="detail-label">{{ $t('system.logs.time') }}：</div>
          <div class="detail-value">{{ currentLog.timestamp }}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">{{ $t('system.logs.level') }}：</div>
          <div class="detail-value">
            <el-tag :type="getLevelTagType(currentLog.level)">
              {{ currentLog.level }}
            </el-tag>
          </div>
        </div>
        <div class="detail-row">
          <div class="detail-label">{{ $t('system.logs.user') }}：</div>
          <div class="detail-value">{{ currentLog.user }}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">{{ $t('system.logs.operation') }}：</div>
          <div class="detail-value">{{ currentLog.operation }}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">{{ $t('system.logs.ipAddress') }}：</div>
          <div class="detail-value">{{ currentLog.ip }}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">{{ $t('system.logs.userAgent') }}：</div>
          <div class="detail-value">{{ currentLog.userAgent }}</div>
        </div>
        <div class="detail-row" v-if="currentLog.requestParams">
          <div class="detail-label">{{ $t('system.logs.requestParams') }}：</div>
          <div class="detail-value">
            <div class="code-block">{{ currentLog.requestParams }}</div>
          </div>
        </div>
        <div class="detail-row" v-if="currentLog.response">
          <div class="detail-label">{{ $t('system.logs.response') }}：</div>
          <div class="detail-value">
            <div class="code-block">{{ currentLog.response }}</div>
          </div>
        </div>
        <div class="detail-row">
          <div class="detail-label">{{ $t('system.logs.detail') }}：</div>
          <div class="detail-value">{{ currentLog.detail }}</div>
        </div>
      </div>

      <template #footer>
        <el-button @click="showDetailDialog = false">{{ $t('common.close') }}</el-button>
      </template>
    </el-dialog>
  </div>
</template>
```

### JavaScript逻辑
```javascript
import { ref, reactive, computed, onMounted } from 'vue'
import { ElMessage, ElMessageBox } from 'element-plus'
import { useRouter } from 'vue-router'
import { useAuthStore } from '@/store/modules/auth'
import { useI18n } from 'vue-i18n'
import { formatDate } from '@/utils/date'
import { LOG_LEVEL_OPTIONS, LOG_LEVEL_TAG_CONFIG } from '@/utils/constants'
import { createLogger } from '@/utils/simpleLogger'

export default {
  name: 'LogManagement',
  setup() {
    const router = useRouter()
    const authStore = useAuthStore()
    const { t } = useI18n()
    const logger = createLogger('LogManagement')
    
    // 响应式数据
    const loading = ref(false)
    const exporting = ref(false)
    const showDetailDialog = ref(false)
    const currentLog = ref(null)
    
    // 搜索表单
    const searchForm = reactive({
      dateRange: [],
      level: '',
      user: ''
    })
    
    // 分页
    const pagination = reactive({
      current: 1,
      size: 20,
      total: 0
    })
    
    // 日志列表数据（通过接口获取）
    const logs = ref([])
    
    // 日志级别选项（从constants.js导入）
    const logLevelOptions = LOG_LEVEL_OPTIONS
    
    // 加载日志列表
    const loadLogs = async () => {
      try {
        loading.value = true
        logger.info('Loading logs list', { 
          page: pagination.current, 
          size: pagination.size,
          filters: searchForm 
        })
        
        // TODO: 替换为实际的后端接口
        // const response = await getLogsList({
        //   page: pagination.current,
        //   size: pagination.size,
        //   level: searchForm.level,
        //   user: searchForm.user,
        //   startDate: searchForm.dateRange?.[0],
        //   endDate: searchForm.dateRange?.[1]
        // })
        // logs.value = response.data.list
        // pagination.total = response.data.total
        
        // 临时模拟数据（后端开发完成后删除）
        await new Promise(resolve => setTimeout(resolve, 500))
        
        const mockLogs = [
          {
            id: 1,
            timestamp: '2024-12-18 10:25:30',
            level: 'INFO',
            user: 'admin',
            operation: '用户登录',
            ip: '192.168.1.100',
            userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0',
            detail: '管理员 admin 登录系统成功',
            requestParams: '{"username": "admin", "loginType": "password"}',
            response: '{"code": 200, "message": "登录成功"}'
          },
          {
            id: 2,
            timestamp: '2024-12-18 10:30:15',
            level: 'INFO',
            user: 'admin',
            operation: '创建用户',
            ip: '192.168.1.100',
            userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0',
            detail: '创建新用户 zhang_prof',
            requestParams: '{"username": "zhang_prof", "role": "teacher", "email": "zhang@university.edu.cn"}',
            response: '{"code": 200, "message": "用户创建成功", "userId": 2}'
          },
          {
            id: 3,
            timestamp: '2024-12-18 11:15:42',
            level: 'WARN',
            user: 'li_student',
            operation: '修改项目',
            ip: '192.168.1.105',
            userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0',
            detail: '尝试修改无权限的项目',
            requestParams: '{"projectId": 10, "action": "edit"}',
            response: '{"code": 403, "message": "无权限执行此操作"}'
          },
          {
            id: 4,
            timestamp: '2024-12-18 14:20:08',
            level: 'ERROR',
            user: 'wang_prof',
            operation: '上传文件',
            ip: '192.168.1.110',
            userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0',
            detail: '文件上传失败：文件大小超过限制',
            requestParams: '{"fileName": "project_report.pdf", "fileSize": 15728640}',
            response: '{"code": 400, "message": "文件大小超过10MB限制"}'
          },
          {
            id: 5,
            timestamp: '2024-12-18 15:45:22',
            level: 'INFO',
            user: 'admin',
            operation: '修改系统配置',
            ip: '192.168.1.100',
            userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0',
            detail: '修改邮件配置',
            requestParams: '{"smtpHost": "smtp.qq.com", "smtpPort": 465, "enableSSL": true}',
            response: '{"code": 200, "message": "配置更新成功"}'
          },
          {
            id: 6,
            timestamp: '2024-12-18 16:30:55',
            level: 'INFO',
            user: 'zhang_prof',
            operation: '创建项目',
            ip: '192.168.1.108',
            userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0',
            detail: '创建新项目：AI 辅助教学平台研发',
            requestParams: '{"projectName": "AI 辅助教学平台研发", "projectType": "applied", "budget": 500000}',
            response: '{"code": 200, "message": "项目创建成功", "projectId": 15}'
          },
          {
            id: 7,
            timestamp: '2024-12-18 17:10:33',
            level: 'WARN',
            user: 'system',
            operation: '系统备份',
            ip: '127.0.0.1',
            userAgent: 'System',
            detail: '自动备份警告：磁盘空间不足',
            requestParams: '{"backupType": "auto", "backupPath": "/backup"}',
            response: '{"code": 500, "message": "磁盘空间不足，备份失败"}'
          },
          {
            id: 8,
            timestamp: '2024-12-18 18:05:18',
            level: 'ERROR',
            user: 'li_student',
            operation: '访问报告',
            ip: '192.168.1.105',
            userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0',
            detail: '访问被拒绝：项目报告不存在',
            requestParams: '{"reportId": 999, "action": "view"}',
            response: '{"code": 404, "message": "报告不存在"}'
          }
        ]
        
        logs.value = mockLogs
        pagination.total = mockLogs.length
        logger.info('Logs list loaded successfully', { count: logs.value.length })
      } catch (error) {
        logger.error('Failed to load logs list', error)
        ElMessage.error(t('system.logs.loadError'))
      } finally {
        loading.value = false
      }
    }
    
    // 计算属性
    const filteredLogs = computed(() => {
      // 筛选和分页逻辑由后端接口处理，直接返回日志列表
      return logs.value
    })
    
    // 方法
    const getLevelTagType = (level) => {
      return LOG_LEVEL_TAG_CONFIG[level]?.type || 'info'
    }
    
    const handleSearch = () => {
      pagination.current = 1
      loadLogs()
    }
    
    const handleReset = () => {
      searchForm.dateRange = []
      searchForm.level = ''
      searchForm.user = ''
      pagination.current = 1
      loadLogs()
      ElMessage.success(t('common.resetSuccess'))
    }
    
    const handleViewDetail = (log) => {
      currentLog.value = { ...log }
      showDetailDialog.value = true
    }
    
    const handleDetailDialogClose = () => {
      currentLog.value = null
    }
    
    const handleExport = async () => {
      try {
        await ElMessageBox.confirm(
          t('system.logs.exportConfirm'),
          t('system.logs.exportLogs'),
          {
            confirmButtonText: t('common.confirm'),
            cancelButtonText: t('common.cancel'),
            type: 'warning'
          }
        )
        
        exporting.value = true
        logger.info('Exporting logs', { filters: searchForm })
        
        // TODO: 替换为实际的后端接口
        // await exportLogs({
        //   level: searchForm.level,
        //   user: searchForm.user,
        //   startDate: searchForm.dateRange?.[0],
        //   endDate: searchForm.dateRange?.[1]
        // })
        
        // 临时模拟导出（后端开发完成后删除）
        await new Promise(resolve => setTimeout(resolve, 2000))
        
        ElMessage.success(t('system.logs.exportSuccess'))
        logger.info('Logs exported successfully')
        exporting.value = false
      } catch (error) {
        exporting.value = false
        if (error !== 'cancel') {
          logger.error('Failed to export logs', error)
          ElMessage.error(t('system.logs.exportFailed'))
        }
      }
    }
    
    const handleClear = async () => {
      try {
        await ElMessageBox.confirm(
          t('system.logs.clearConfirm'),
          t('system.logs.clearLogs'),
          {
            confirmButtonText: t('common.confirm'),
            cancelButtonText: t('common.cancel'),
            type: 'warning'
          }
        )
        
        loading.value = true
        logger.info('Clearing logs')
        
        // TODO: 替换为实际的后端接口
        // await clearLogs()
        
        // 临时模拟清空（后端开发完成后删除）
        await new Promise(resolve => setTimeout(resolve, 1000))
        
        logs.value = []
        pagination.total = 0
        ElMessage.success(t('system.logs.clearSuccess'))
        logger.info('Logs cleared successfully')
        loading.value = false
      } catch (error) {
        loading.value = false
        if (error !== 'cancel') {
          logger.error('Failed to clear logs', error)
          ElMessage.error(t('system.logs.clearFailed'))
        }
      }
    }
    
    const handlePageChange = (page) => {
      pagination.current = page
      loadLogs()
    }
    
    const handleSizeChange = (size) => {
      pagination.size = size
      pagination.current = 1
      loadLogs()
    }
    
    // 生命周期
    onMounted(() => {
      loadLogs()
    })
    
    return {
      loading,
      exporting,
      showDetailDialog,
      currentLog,
      searchForm,
      pagination,
      logs,
      logLevelOptions,
      filteredLogs,
      loadLogs,
      getLevelTagType,
      handleSearch,
      handleReset,
      handleViewDetail,
      handleDetailDialogClose,
      handleExport,
      handleClear,
      handlePageChange,
      handleSizeChange
    }
  }
}
```

## 🎨 样式实现

```scss
<style scoped>
.log-management-container {
  padding: 20px;
  background: #f7f9fc;
  min-height: calc(100vh - 56px);
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.page-title {
  font-size: 24px;
  font-weight: 600;
  color: #1e3a8a;
  margin: 0;
}

.header-actions {
  display: flex;
  gap: 12px;
}

.filter-section {
  display: flex;
  gap: 16px;
  margin-bottom: 20px;
  flex-wrap: wrap;
  align-items: center;
}

.filter-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

.filter-label {
  color: #6b7280;
  font-size: 14px;
  white-space: nowrap;
  font-weight: 500;
}

.log-detail {
  font-size: 14px;
  line-height: 1.8;
}

.detail-row {
  display: flex;
  margin-bottom: 16px;
  padding-bottom: 16px;
  border-bottom: 1px solid #e5e7eb;
}

.detail-row:last-child {
  border-bottom: none;
  margin-bottom: 0;
  padding-bottom: 0;
}

.detail-label {
  width: 120px;
  font-weight: 600;
  color: #1e3a8a;
  flex-shrink: 0;
}

.detail-value {
  flex: 1;
  color: #6b7280;
  word-break: break-all;
}

.code-block {
  background: #f9fafb;
  padding: 12px;
  border-radius: 6px;
  font-family: 'Courier New', monospace;
  font-size: 12px;
  overflow-x: auto;
  border: 1px solid #e5e7eb;
}

:deep(.el-table) {
  border-radius: 8px;
  overflow: hidden;
}

:deep(.el-table__header) {
  background: #f8fafc;
}

:deep(.el-table th) {
  background: #f8fafc;
  color: #374151;
  font-weight: 600;
}

:deep(.el-table--striped .el-table__body tr.el-table__row--striped td) {
  background: #f9fafb;
}

:deep(.el-table__body tr:hover > td) {
  background: #f0f9ff;
}

:deep(.el-tag) {
  border-radius: 4px;
  font-weight: 500;
}

:deep(.el-dialog) {
  border-radius: 12px;
}

:deep(.el-dialog__header) {
  border-bottom: 1px solid #f0f0f0;
  padding: 20px 24px 16px;
}

:deep(.el-dialog__title) {
  font-size: 18px;
  font-weight: 600;
  color: #1e3a8a;
}

:deep(.el-dialog__body) {
  padding: 20px 24px;
}

:deep(.el-dialog__footer) {
  border-top: 1px solid #f0f0f0;
  padding: 16px 24px 20px;
}

:deep(.el-date-editor) {
  border-radius: 6px;
}

:deep(.el-input__wrapper) {
  border-radius: 6px;
}

:deep(.el-select .el-input__wrapper) {
  border-radius: 6px;
}
</style>
```

## ⚠️ 注意事项

1. **表格组件**: 使用Element Plus的`el-table`和`el-table-column`组件，不要使用原生HTML表格
2. **日志级别**: 使用不同颜色的`el-tag`组件标识日志级别（INFO-绿色、WARN-橙色、ERROR-红色）
3. **搜索筛选**: 支持日期范围、日志级别、用户名的多维度筛选
4. **日志详情**: 详情对话框显示完整的日志信息，包括请求参数和响应结果
5. **代码块**: 请求参数和响应结果使用代码块样式显示，支持横向滚动
6. **分页功能**: 使用Element Plus分页组件，支持页码跳转和每页显示数量调整
7. **接口集成**: 所有数据操作通过后端接口实现，包含完整的错误处理和加载状态
8. **用户体验**: 操作成功/失败都有相应的消息提示，重要操作需要确认对话框
9. **权限控制**: 根据用户权限显示不同的操作按钮，导出和清空操作需要相应权限
10. **响应式设计**: 表格支持横向滚动，筛选区域支持换行显示
11. **数据安全**: 清空日志操作需要二次确认，防止误操作
12. **性能优化**: 大量日志数据需要分页加载，避免一次性加载所有数据

**最终要求：生成的代码必须与原型图的视觉效果和交互逻辑完全一致！**
