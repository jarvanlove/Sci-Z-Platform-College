# 用户管理页面开发提示词

## 📋 页面信息
- **页面名称**: 用户管理
- **文件路径**: `src/views/System/User.vue`
- **路由路径**: `/system/user`
- **权限代码**: `system:user:view`

## 🎯 开发要求

### 页面结构
1. **页面头部**: 标题 + 操作按钮（新增用户）
2. **搜索筛选区域**: 关键词搜索 + 角色筛选 + 状态筛选 + 搜索/重置按钮
3. **用户列表表格**: 使用Element Plus表格组件展示用户信息
4. **分页组件**: 使用Element Plus分页组件
5. **新增/编辑用户对话框**: 表单验证 + 角色选择 + 状态设置

### 组件使用
- **布局组件**: `MainLayout` (默认布局)
- **通用组件**: `BaseCard`, `BaseButton`, `BasePagination`
- **业务组件**: `DataTable`, `SearchForm`, `ActionButtons`
- **Element Plus**: `el-table`, `el-table-column`, `el-dialog`, `el-form`, `el-select`, `el-switch`, `el-tag`

### 核心功能实现
1. **用户列表展示**: 用户名、真实姓名、工号、邮箱、部门、角色、状态、创建时间
2. **搜索筛选**: 关键词搜索、角色筛选、状态筛选
3. **用户操作**: 新增、编辑、重置密码、启用/禁用、删除
4. **表单验证**: 用户名唯一性、邮箱格式、密码强度
5. **权限控制**: 根据用户角色显示不同操作按钮

### 信息展示
- **用户基本信息**: 用户名、真实姓名、工号、邮箱、手机号
- **组织信息**: 所属部门、职位
- **权限信息**: 角色、状态（启用/禁用）
- **时间信息**: 创建时间、最后登录时间

## 📝 代码结构

### Vue模板结构
```vue
<template>
  <div class="user-management-container">
    <!-- 页面头部 -->
    <div class="page-header">
      <h1 class="page-title">{{ $t('system.user.title') }}</h1>
      <div class="header-actions">
        <el-button type="primary" @click="handleAdd">
          <el-icon><Plus /></el-icon>
          {{ $t('system.user.addUser') }}
        </el-button>
      </div>
    </div>

    <!-- 内容卡片 -->
    <BaseCard>
      <!-- 搜索筛选区域 -->
      <div class="filter-section">
        <el-input
          v-model="searchForm.keyword"
          :placeholder="$t('system.user.searchPlaceholder')"
          clearable
          style="width: 250px"
        >
          <template #prefix>
            <el-icon><Search /></el-icon>
          </template>
        </el-input>
        
        <el-select
          v-model="searchForm.role"
          :placeholder="$t('system.user.selectRole')"
          clearable
          style="width: 150px"
        >
          <el-option :label="$t('common.all')" value="" />
          <el-option :label="$t('system.user.roleAdmin')" value="admin" />
          <el-option :label="$t('system.user.roleTeacher')" value="teacher" />
          <el-option :label="$t('system.user.roleStudent')" value="student" />
        </el-select>
        
        <el-select
          v-model="searchForm.status"
          :placeholder="$t('system.user.selectStatus')"
          clearable
          style="width: 120px"
        >
          <el-option :label="$t('common.all')" value="" />
          <el-option :label="$t('common.active')" value="active" />
          <el-option :label="$t('common.inactive')" value="inactive" />
        </el-select>
        
        <el-button type="primary" @click="handleSearch">{{ $t('common.search') }}</el-button>
        <el-button @click="handleReset">{{ $t('common.reset') }}</el-button>
      </div>

      <!-- 用户列表表格 -->
      <el-table
        :data="filteredUsers"
        v-loading="loading"
        stripe
        border
        style="width: 100%"
      >
        <el-table-column prop="username" :label="$t('system.user.username')" width="120" />
        <el-table-column prop="realName" :label="$t('system.user.realName')" width="120" />
        <el-table-column prop="employeeId" :label="$t('system.user.employeeId')" width="120" />
        <el-table-column prop="email" :label="$t('system.user.email')" width="200" />
        <el-table-column prop="department" :label="$t('system.user.department')" width="150" />
        <el-table-column prop="role" :label="$t('system.user.role')" width="100">
          <template #default="{ row }">
            <el-tag :type="getRoleTagType(row.role)">
              {{ getRoleText(row.role) }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column prop="status" :label="$t('common.status')" width="100">
          <template #default="{ row }">
            <el-tag :type="row.status === 'active' ? 'success' : 'danger'">
              {{ row.status === 'active' ? $t('common.active') : $t('common.inactive') }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column prop="createTime" :label="$t('common.createTime')" width="160" />
        <el-table-column :label="$t('common.actions')" width="280" fixed="right">
          <template #default="{ row }">
            <el-button size="small" @click="handleEdit(row)">{{ $t('common.edit') }}</el-button>
            <el-button size="small" @click="handleResetPassword(row)">{{ $t('system.user.resetPassword') }}</el-button>
            <el-button 
              size="small" 
              :type="row.status === 'active' ? 'warning' : 'success'"
              @click="handleToggleStatus(row)"
            >
              {{ row.status === 'active' ? $t('common.disable') : $t('common.enable') }}
            </el-button>
            <el-button size="small" type="danger" @click="handleDelete(row)">{{ $t('common.delete') }}</el-button>
          </template>
        </el-table-column>
      </el-table>

      <!-- 分页 -->
      <BasePagination
        v-model:current-page="pagination.current"
        v-model:page-size="pagination.size"
        :total="pagination.total"
        @current-change="handlePageChange"
        @size-change="handleSizeChange"
      />
    </BaseCard>

    <!-- 新增/编辑用户对话框 -->
    <el-dialog
      v-model="showDialog"
      :title="dialogTitle"
      width="600px"
      @close="handleDialogClose"
    >
      <el-form
        ref="formRef"
        :model="formData"
        :rules="formRules"
        label-width="100px"
      >
        <el-form-item :label="$t('system.user.username')" prop="username">
          <el-input v-model="formData.username" :disabled="isEdit" />
        </el-form-item>
        <el-form-item :label="$t('system.user.realName')" prop="realName">
          <el-input v-model="formData.realName" />
        </el-form-item>
        <el-form-item :label="$t('system.user.employeeId')" prop="employeeId">
          <el-input v-model="formData.employeeId" />
        </el-form-item>
        <el-form-item :label="$t('system.user.email')" prop="email">
          <el-input v-model="formData.email" />
        </el-form-item>
        <el-form-item :label="$t('system.user.phone')" prop="phone">
          <el-input v-model="formData.phone" />
        </el-form-item>
        <el-form-item :label="$t('system.user.department')" prop="department">
          <el-input v-model="formData.department" />
        </el-form-item>
        <el-form-item :label="$t('system.user.role')" prop="role">
          <el-select v-model="formData.role" style="width: 100%">
            <el-option :label="$t('system.user.roleAdmin')" value="admin" />
            <el-option :label="$t('system.user.roleTeacher')" value="teacher" />
            <el-option :label="$t('system.user.roleStudent')" value="student" />
          </el-select>
        </el-form-item>
        <el-form-item :label="$t('common.status')" prop="status">
          <el-switch
            v-model="formData.status"
            active-value="active"
            inactive-value="inactive"
          />
        </el-form-item>
        <el-form-item v-if="!isEdit" :label="$t('system.user.password')" prop="password">
          <el-input v-model="formData.password" type="password" show-password />
        </el-form-item>
      </el-form>
      
      <template #footer>
        <el-button @click="showDialog = false">{{ $t('common.cancel') }}</el-button>
        <el-button type="primary" @click="handleSubmit" :loading="submitting">
          {{ $t('common.confirm') }}
        </el-button>
      </template>
    </el-dialog>
  </div>
</template>
```

### JavaScript逻辑
```javascript
import { ref, reactive, computed, onMounted } from 'vue'
import { ElMessage, ElMessageBox } from 'element-plus'
import { useRouter } from 'vue-router'
import { useAuthStore } from '@/store/modules/auth'
import { useI18n } from 'vue-i18n'
import { formatDate } from '@/utils/date'
import { STATUS_CONFIG, PERMISSIONS } from '@/utils/constants'
import { validateEmail, validatePhone, validateUsername, validateChineseName } from '@/utils/validate'
import { createLogger } from '@/utils/simpleLogger'

export default {
  name: 'UserManagement',
  setup() {
    const router = useRouter()
    const authStore = useAuthStore()
    const { t } = useI18n()
    const logger = createLogger('UserManagement')
    
    // 响应式数据
    const loading = ref(false)
    const submitting = ref(false)
    const showDialog = ref(false)
    const isEdit = ref(false)
    const formRef = ref()
    
    // 搜索表单
    const searchForm = reactive({
      keyword: '',
      role: '',
      status: ''
    })
    
    // 分页
    const pagination = reactive({
      current: 1,
      size: 20,
      total: 0
    })
    
    // 表单数据
    const formData = reactive({
      id: null,
      username: '',
      realName: '',
      employeeId: '',
      email: '',
      phone: '',
      department: '',
      role: '',
      status: 'active',
      password: ''
    })
    
    // 表单验证规则
    const formRules = {
        username: [
          { required: true, message: t('system.user.usernameRequired'), trigger: 'blur' },
          { 
            validator: (rule, value, callback) => {
              if (!validateUsername(value)) {
                callback(new Error(t('system.user.usernameFormat')))
              } else {
                callback()
              }
            }, 
            trigger: 'blur' 
          }
        ],
        realName: [
          { required: true, message: t('system.user.realNameRequired'), trigger: 'blur' },
          { 
            validator: (rule, value, callback) => {
              if (!validateChineseName(value)) {
                callback(new Error(t('system.user.realNameFormat')))
              } else {
                callback()
              }
            }, 
            trigger: 'blur' 
          }
        ],
        email: [
          { required: true, message: t('system.user.emailRequired'), trigger: 'blur' },
          { 
            validator: (rule, value, callback) => {
              if (!validateEmail(value)) {
                callback(new Error(t('system.user.emailFormat')))
              } else {
                callback()
              }
            }, 
            trigger: 'blur' 
          }
        ],
      role: [
        { required: true, message: t('system.user.roleRequired'), trigger: 'change' }
      ]
    }
    
    // 用户列表数据（通过接口获取）
    const users = ref([])
    
    // 加载用户列表
    const loadUsers = async () => {
      try {
        loading.value = true
        logger.info('Loading users list', { 
          page: pagination.current, 
          size: pagination.size,
          filters: searchForm 
        })
        
        // TODO: 替换为实际的后端接口
        // const response = await getUsersList({
        //   page: pagination.current,
        //   size: pagination.size,
        //   keyword: searchForm.keyword,
        //   role: searchForm.role,
        //   status: searchForm.status
        // })
        // users.value = response.data.list
        // pagination.total = response.data.total
        
        // 临时模拟数据（后端开发完成后删除）
        await new Promise(resolve => setTimeout(resolve, 500))
        
        const mockUsers = [
          {
            id: 1,
            username: 'admin',
            realName: '系统管理员',
            employeeId: 'A001',
            email: 'admin@university.edu.cn',
            phone: '13800138000',
            department: '信息中心',
            role: 'admin',
            status: 'active',
            createTime: '2024-01-01 10:00:00'
          },
          {
            id: 2,
            username: 'zhang_prof',
            realName: '张教授',
            employeeId: 'T001',
            email: 'zhang@university.edu.cn',
            phone: '13800138001',
            department: '计算机学院',
            role: 'teacher',
            status: 'active',
            createTime: '2024-01-02 10:00:00'
          },
          {
            id: 3,
            username: 'li_student',
            realName: '李同学',
            employeeId: 'S001',
            email: 'li@university.edu.cn',
            phone: '13800138002',
            department: '计算机学院',
            role: 'student',
            status: 'active',
            createTime: '2024-01-03 10:00:00'
          }
        ]
        
        users.value = mockUsers
        pagination.total = mockUsers.length
        logger.info('Users list loaded successfully', { count: users.value.length })
      } catch (error) {
        logger.error('Failed to load users list', error)
        ElMessage.error(t('system.user.loadError'))
      } finally {
        loading.value = false
      }
    }
    
    // 计算属性
    const dialogTitle = computed(() => isEdit.value ? t('system.user.editUser') : t('system.user.addUser'))
    
    const filteredUsers = computed(() => {
      // 筛选和分页逻辑由后端接口处理，直接返回用户列表
      return users.value
    })
    
    // 方法
    const getRoleTagType = (role) => {
      const typeMap = {
        admin: 'danger',
        teacher: 'primary',
        student: 'success'
      }
      return typeMap[role] || 'info'
    }
    
    const getRoleText = (role) => {
      const textMap = {
        admin: t('system.user.roleAdmin'),
        teacher: t('system.user.roleTeacher'),
        student: t('system.user.roleStudent')
      }
      return textMap[role] || role
    }
    
    const handleSearch = () => {
      pagination.current = 1
      loadUsers()
    }
    
    const handleReset = () => {
      searchForm.keyword = ''
      searchForm.role = ''
      searchForm.status = ''
      pagination.current = 1
      loadUsers()
      ElMessage.success(t('common.resetSuccess'))
    }
    
    const handleAdd = () => {
      isEdit.value = false
      resetForm()
      showDialog.value = true
    }
    
    const handleEdit = (user) => {
      isEdit.value = true
      Object.assign(formData, user)
      showDialog.value = true
    }
    
    const handleResetPassword = async (user) => {
      try {
        await ElMessageBox.confirm(
          t('system.user.resetPasswordConfirm', { name: user.realName }),
          t('system.user.resetPassword'),
          { type: 'warning' }
        )
        
        logger.info('Reset user password', { userId: user.id, username: user.username })
        
        // TODO: 替换为实际的后端接口
        // await resetUserPassword(user.id)
        
        // 临时模拟重置密码（后端开发完成后删除）
        await new Promise(resolve => setTimeout(resolve, 1000))
        
        ElMessage.success(t('system.user.resetPasswordSuccess'))
        logger.info('Password reset successful', { userId: user.id })
      } catch (error) {
        if (error !== 'cancel') {
          logger.error('Failed to reset password', error)
          ElMessage.error(t('system.user.resetPasswordFailed'))
        }
      }
    }
    
    const handleToggleStatus = async (user) => {
      const action = user.status === 'active' ? t('common.disable') : t('common.enable')
      try {
        await ElMessageBox.confirm(
          t('system.user.toggleStatusConfirm', { action, name: user.realName }),
          t('system.user.toggleStatus'),
          { type: 'warning' }
        )
        
        logger.info('Toggle user status', { userId: user.id, username: user.username, action })
        
        // TODO: 替换为实际的后端接口
        // await updateUserStatus(user.id, user.status === 'active' ? 'inactive' : 'active')
        
        // 临时模拟状态切换（后端开发完成后删除）
        await new Promise(resolve => setTimeout(resolve, 500))
        
        user.status = user.status === 'active' ? 'inactive' : 'active'
        ElMessage.success(t('system.user.toggleStatusSuccess', { action }))
        logger.info('User status toggled successfully', { userId: user.id, newStatus: user.status })
      } catch (error) {
        if (error !== 'cancel') {
          logger.error('Failed to toggle user status', error)
          ElMessage.error(t('system.user.toggleStatusFailed'))
        }
      }
    }
    
    const handleDelete = async (user) => {
      try {
        await ElMessageBox.confirm(
          t('system.user.deleteConfirm', { name: user.realName }),
          t('system.user.deleteUser'),
          { type: 'warning' }
        )
        
        logger.info('Delete user', { userId: user.id, username: user.username })
        
        // TODO: 替换为实际的后端接口
        // await deleteUser(user.id)
        
        // 临时模拟删除（后端开发完成后删除）
        await new Promise(resolve => setTimeout(resolve, 500))
        
        const index = users.value.findIndex(u => u.id === user.id)
        if (index > -1) {
          users.value.splice(index, 1)
        }
        
        ElMessage.success(t('system.user.deleteSuccess'))
        logger.info('User deleted successfully', { userId: user.id })
      } catch (error) {
        if (error !== 'cancel') {
          logger.error('Failed to delete user', error)
          ElMessage.error(t('system.user.deleteFailed'))
        }
      }
    }
    
    const handleSubmit = async () => {
      try {
        await formRef.value.validate()
        
        submitting.value = true
        logger.info('Submit user form', { isEdit: isEdit.value, userId: formData.id })
        
        // TODO: 替换为实际的后端接口
        // if (isEdit.value) {
        //   await updateUser(formData.id, formData)
        // } else {
        //   await createUser(formData)
        // }
        
        // 临时模拟保存（后端开发完成后删除）
        await new Promise(resolve => setTimeout(resolve, 1000))
        
        if (isEdit.value) {
          // 更新用户
          const index = users.value.findIndex(u => u.id === formData.id)
          if (index > -1) {
            Object.assign(users.value[index], formData)
          }
          ElMessage.success(t('system.user.updateSuccess'))
          logger.info('User updated successfully', { userId: formData.id })
        } else {
          // 新增用户
          const newUser = {
            ...formData,
            id: Date.now(),
            createTime: new Date().toLocaleString()
          }
          users.value.unshift(newUser)
          ElMessage.success(t('system.user.createSuccess'))
          logger.info('User created successfully', { userId: newUser.id, username: newUser.username })
        }
        
        showDialog.value = false
        submitting.value = false
      } catch (error) {
        submitting.value = false
        logger.error('User form submission failed', error)
        if (error !== false) {
          ElMessage.error(t('common.operationFailed'))
        }
      }
    }
    
    const handleDialogClose = () => {
      resetForm()
      formRef.value?.resetFields()
    }
    
    const resetForm = () => {
      Object.assign(formData, {
        id: null,
        username: '',
        realName: '',
        employeeId: '',
        email: '',
        phone: '',
        department: '',
        role: '',
        status: 'active',
        password: ''
      })
    }
    
    const handlePageChange = (page) => {
      pagination.current = page
      loadUsers()
    }
    
    const handleSizeChange = (size) => {
      pagination.size = size
      pagination.current = 1
      loadUsers()
    }
    
    // 生命周期
    onMounted(() => {
      loadUsers()
    })
    
    return {
      loading,
      submitting,
      showDialog,
      isEdit,
      formRef,
      searchForm,
      pagination,
      formData,
      formRules,
      users,
      dialogTitle,
      filteredUsers,
      loadUsers,
      getRoleTagType,
      getRoleText,
      handleSearch,
      handleReset,
      handleAdd,
      handleEdit,
      handleResetPassword,
      handleToggleStatus,
      handleDelete,
      handleSubmit,
      handleDialogClose,
      handlePageChange,
      handleSizeChange
    }
  }
}
```

## 🎨 样式实现

```scss
<style scoped>
.user-management-container {
  padding: 20px;
  background: #f7f9fc;
  min-height: calc(100vh - 56px);
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.page-title {
  font-size: 24px;
  font-weight: 600;
  color: #1e3a8a;
  margin: 0;
}

.header-actions {
  display: flex;
  gap: 12px;
}

.filter-section {
  display: flex;
  gap: 16px;
  margin-bottom: 20px;
  flex-wrap: wrap;
  align-items: center;
}

:deep(.el-table) {
  border-radius: 8px;
  overflow: hidden;
}

:deep(.el-table__header) {
  background: #f8fafc;
}

:deep(.el-table th) {
  background: #f8fafc;
  color: #374151;
  font-weight: 600;
}

:deep(.el-table--striped .el-table__body tr.el-table__row--striped td) {
  background: #f9fafb;
}

:deep(.el-table__body tr:hover > td) {
  background: #f0f9ff;
}

:deep(.el-tag) {
  border-radius: 4px;
  font-weight: 500;
}

:deep(.el-dialog) {
  border-radius: 12px;
}

:deep(.el-dialog__header) {
  border-bottom: 1px solid #f0f0f0;
  padding: 20px 24px 16px;
}

:deep(.el-dialog__title) {
  font-size: 18px;
  font-weight: 600;
  color: #1e3a8a;
}

:deep(.el-dialog__body) {
  padding: 20px 24px;
}

:deep(.el-dialog__footer) {
  border-top: 1px solid #f0f0f0;
  padding: 16px 24px 20px;
}
</style>
```

## ⚠️ 注意事项

1. **表格组件**: 使用Element Plus的`el-table`和`el-table-column`组件，不要使用原生HTML表格
2. **权限控制**: 根据用户角色显示不同的操作按钮，管理员可以执行所有操作
3. **表单验证**: 用户名唯一性检查、邮箱格式验证、密码强度要求
4. **状态管理**: 用户状态切换需要确认操作，删除操作需要二次确认
5. **分页功能**: 使用Element Plus分页组件，支持页码跳转和每页显示数量调整
6. **接口集成**: 所有数据操作通过后端接口实现，包含完整的错误处理和加载状态
7. **响应式设计**: 表格支持横向滚动，筛选区域支持换行显示
8. **用户体验**: 操作成功/失败都有相应的消息提示，重要操作需要确认对话框

**最终要求：生成的代码必须与原型图的视觉效果和交互逻辑完全一致！**
