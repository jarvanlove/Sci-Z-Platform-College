# 系统配置页面开发提示词

## 📋 页面信息
- **页面名称**: 系统配置
- **文件路径**: `src/views/System/Config.vue`
- **路由路径**: `/system/config`
- **权限代码**: `system:config:view`

## 🎯 开发要求

### 页面结构
1. **页面头部**: 标题 + 操作按钮（保存配置、重置配置）
2. **配置选项卡**: 基础配置、Dify配置、邮件配置、文件配置、安全配置
3. **配置表单**: 每个选项卡包含相应的配置项和表单验证
4. **操作按钮**: 保存、重置、测试连接（邮件配置）

### 组件使用
- **布局组件**: `MainLayout` (默认布局)
- **通用组件**: `BaseCard`, `BaseButton`
- **Element Plus**: `el-tabs`, `el-tab-pane`, `el-form`, `el-form-item`, `el-input`, `el-switch`, `el-select`, `el-tag`, `el-button`

### 核心功能实现
1. **配置分类**: 基础、Dify、邮件、文件、安全五个配置类别
2. **表单验证**: 邮箱格式、URL格式、端口范围、文件大小限制
3. **配置保存**: 批量保存所有配置项
4. **配置重置**: 重置为默认配置
5. **测试功能**: 邮件配置支持测试连接

### 信息展示
- **基础配置**: 系统名称、系统描述、时区、语言
- **Dify配置**: API地址、API密钥、模型配置
- **邮件配置**: SMTP服务器、端口、用户名、密码、SSL设置
- **文件配置**: 上传路径、允许格式、大小限制
- **安全配置**: 密码策略、登录策略、会话超时

## 📝 代码结构

### Vue模板结构
```vue
<template>
  <div class="system-config-container">
    <!-- 页面头部 -->
    <div class="page-header">
      <h1 class="page-title">{{ $t('system.config.title') }}</h1>
      <div class="header-actions">
        <el-button @click="handleReset">
          <el-icon><Refresh /></el-icon>
          {{ $t('system.config.resetConfig') }}
        </el-button>
        <el-button type="primary" @click="handleSave" :loading="saving">
          <el-icon><Check /></el-icon>
          {{ $t('system.config.saveConfig') }}
        </el-button>
      </div>
    </div>

    <!-- 配置内容 -->
    <BaseCard>
      <el-tabs v-model="activeTab" type="border-card">
        <!-- 基础配置 -->
        <el-tab-pane :label="$t('system.config.basicConfig')" name="basic">
          <el-form
            ref="basicFormRef"
            :model="basicConfig"
            :rules="basicRules"
            label-width="120px"
            class="config-form"
          >
            <el-form-item label="系统名称" prop="systemName">
              <el-input v-model="basicConfig.systemName" placeholder="请输入系统名称" />
            </el-form-item>
            <el-form-item label="系统描述" prop="systemDescription">
              <el-textarea 
                v-model="basicConfig.systemDescription" 
                :rows="3"
                placeholder="请输入系统描述"
              />
            </el-form-item>
            <el-form-item label="时区" prop="timezone">
              <el-select v-model="basicConfig.timezone" style="width: 100%">
                <el-option label="北京时间 (UTC+8)" value="Asia/Shanghai" />
                <el-option label="东京时间 (UTC+9)" value="Asia/Tokyo" />
                <el-option label="纽约时间 (UTC-5)" value="America/New_York" />
                <el-option label="伦敦时间 (UTC+0)" value="Europe/London" />
              </el-select>
            </el-form-item>
            <el-form-item label="默认语言" prop="defaultLanguage">
              <el-select v-model="basicConfig.defaultLanguage" style="width: 100%">
                <el-option label="简体中文" value="zh-CN" />
                <el-option label="English" value="en-US" />
                <el-option label="日本語" value="ja-JP" />
                <el-option label="한국어" value="ko-KR" />
              </el-select>
            </el-form-item>
            <el-form-item label="启用维护模式" prop="maintenanceMode">
              <el-switch v-model="basicConfig.maintenanceMode" />
              <span class="form-tip">启用后系统将显示维护页面</span>
            </el-form-item>
          </el-form>
        </el-tab-pane>

        <!-- Dify配置 -->
        <el-tab-pane :label="$t('system.config.difyConfig')" name="dify">
          <el-form
            ref="difyFormRef"
            :model="difyConfig"
            :rules="difyRules"
            label-width="120px"
            class="config-form"
          >
            <el-form-item label="API地址" prop="apiUrl">
              <el-input v-model="difyConfig.apiUrl" placeholder="https://api.dify.ai" />
            </el-form-item>
            <el-form-item label="API密钥" prop="apiKey">
              <el-input 
                v-model="difyConfig.apiKey" 
                type="password" 
                show-password
                placeholder="请输入API密钥"
              />
            </el-form-item>
            <el-form-item label="默认模型" prop="defaultModel">
              <el-select v-model="difyConfig.defaultModel" style="width: 100%">
                <el-option label="GPT-4" value="gpt-4" />
                <el-option label="GPT-3.5 Turbo" value="gpt-3.5-turbo" />
                <el-option label="Claude-3" value="claude-3" />
                <el-option label="文心一言" value="ernie-bot" />
              </el-select>
            </el-form-item>
            <el-form-item label="最大Token数" prop="maxTokens">
              <el-input-number 
                v-model="difyConfig.maxTokens" 
                :min="100" 
                :max="4000" 
                style="width: 100%"
              />
            </el-form-item>
            <el-form-item label="温度参数" prop="temperature">
              <el-slider 
                v-model="difyConfig.temperature" 
                :min="0" 
                :max="2" 
                :step="0.1"
                show-input
              />
            </el-form-item>
            <el-form-item label="启用Dify" prop="enabled">
              <el-switch v-model="difyConfig.enabled" />
              <span class="form-tip">启用后将使用Dify AI服务</span>
            </el-form-item>
          </el-form>
        </el-tab-pane>

        <!-- 邮件配置 -->
        <el-tab-pane :label="$t('system.config.emailConfig')" name="email">
          <el-form
            ref="emailFormRef"
            :model="emailConfig"
            :rules="emailRules"
            label-width="120px"
            class="config-form"
          >
            <el-form-item label="SMTP服务器" prop="smtpHost">
              <el-input v-model="emailConfig.smtpHost" placeholder="smtp.qq.com" />
            </el-form-item>
            <el-form-item label="SMTP端口" prop="smtpPort">
              <el-input-number 
                v-model="emailConfig.smtpPort" 
                :min="1" 
                :max="65535" 
                style="width: 100%"
              />
            </el-form-item>
            <el-form-item label="用户名" prop="username">
              <el-input v-model="emailConfig.username" placeholder="请输入邮箱用户名" />
            </el-form-item>
            <el-form-item label="密码" prop="password">
              <el-input 
                v-model="emailConfig.password" 
                type="password" 
                show-password
                placeholder="请输入邮箱密码或授权码"
              />
            </el-form-item>
            <el-form-item label="发件人邮箱" prop="fromEmail">
              <el-input v-model="emailConfig.fromEmail" placeholder="请输入发件人邮箱" />
            </el-form-item>
            <el-form-item label="发件人名称" prop="fromName">
              <el-input v-model="emailConfig.fromName" placeholder="请输入发件人名称" />
            </el-form-item>
            <el-form-item label="启用SSL" prop="enableSSL">
              <el-switch v-model="emailConfig.enableSSL" />
            </el-form-item>
            <el-form-item label="启用TLS" prop="enableTLS">
              <el-switch v-model="emailConfig.enableTLS" />
            </el-form-item>
            <el-form-item>
              <el-button type="primary" @click="handleTestEmail" :loading="testingEmail">
                测试邮件连接
              </el-button>
            </el-form-item>
          </el-form>
        </el-tab-pane>

        <!-- 文件配置 -->
        <el-tab-pane :label="$t('system.config.fileConfig')" name="file">
          <el-form
            ref="fileFormRef"
            :model="fileConfig"
            :rules="fileRules"
            label-width="120px"
            class="config-form"
          >
            <el-form-item label="上传路径" prop="uploadPath">
              <el-input v-model="fileConfig.uploadPath" placeholder="/uploads" />
            </el-form-item>
            <el-form-item label="允许格式" prop="allowedFormats">
              <el-tag
                v-for="format in fileConfig.allowedFormats"
                :key="format"
                closable
                @close="removeFormat(format)"
                style="margin-right: 8px; margin-bottom: 8px;"
              >
                {{ format }}
              </el-tag>
              <el-input
                v-if="inputVisible"
                ref="inputRef"
                v-model="inputValue"
                size="small"
                style="width: 100px"
                @keyup.enter="handleInputConfirm"
                @blur="handleInputConfirm"
              />
              <el-button v-else size="small" @click="showInput">+ 添加格式</el-button>
            </el-form-item>
            <el-form-item label="最大文件大小" prop="maxFileSize">
              <el-input-number 
                v-model="fileConfig.maxFileSize" 
                :min="1" 
                :max="1024" 
                style="width: 200px"
              />
              <span style="margin-left: 8px;">MB</span>
            </el-form-item>
            <el-form-item label="最大上传数量" prop="maxFileCount">
              <el-input-number 
                v-model="fileConfig.maxFileCount" 
                :min="1" 
                :max="100" 
                style="width: 200px"
              />
              <span style="margin-left: 8px;">个文件</span>
            </el-form-item>
            <el-form-item label="启用文件压缩" prop="enableCompression">
              <el-switch v-model="fileConfig.enableCompression" />
              <span class="form-tip">启用后自动压缩图片文件</span>
            </el-form-item>
          </el-form>
        </el-tab-pane>

        <!-- 安全配置 -->
        <el-tab-pane :label="$t('system.config.securityConfig')" name="security">
          <el-form
            ref="securityFormRef"
            :model="securityConfig"
            :rules="securityRules"
            label-width="120px"
            class="config-form"
          >
            <el-form-item label="密码最小长度" prop="minPasswordLength">
              <el-input-number 
                v-model="securityConfig.minPasswordLength" 
                :min="6" 
                :max="32" 
                style="width: 200px"
              />
              <span style="margin-left: 8px;">位</span>
            </el-form-item>
            <el-form-item label="密码复杂度" prop="passwordComplexity">
              <el-checkbox-group v-model="securityConfig.passwordComplexity">
                <el-checkbox label="uppercase">包含大写字母</el-checkbox>
                <el-checkbox label="lowercase">包含小写字母</el-checkbox>
                <el-checkbox label="numbers">包含数字</el-checkbox>
                <el-checkbox label="symbols">包含特殊字符</el-checkbox>
              </el-checkbox-group>
            </el-form-item>
            <el-form-item label="登录失败次数" prop="maxLoginAttempts">
              <el-input-number 
                v-model="securityConfig.maxLoginAttempts" 
                :min="3" 
                :max="10" 
                style="width: 200px"
              />
              <span style="margin-left: 8px;">次后锁定账户</span>
            </el-form-item>
            <el-form-item label="锁定时间" prop="lockoutDuration">
              <el-input-number 
                v-model="securityConfig.lockoutDuration" 
                :min="5" 
                :max="60" 
                style="width: 200px"
              />
              <span style="margin-left: 8px;">分钟</span>
            </el-form-item>
            <el-form-item label="会话超时时间" prop="sessionTimeout">
              <el-input-number 
                v-model="securityConfig.sessionTimeout" 
                :min="30" 
                :max="480" 
                style="width: 200px"
              />
              <span style="margin-left: 8px;">分钟</span>
            </el-form-item>
            <el-form-item label="启用双因子认证" prop="enable2FA">
              <el-switch v-model="securityConfig.enable2FA" />
              <span class="form-tip">启用后用户可设置双因子认证</span>
            </el-form-item>
            <el-form-item label="启用IP白名单" prop="enableIPWhitelist">
              <el-switch v-model="securityConfig.enableIPWhitelist" />
              <span class="form-tip">启用后只允许白名单IP访问</span>
            </el-form-item>
          </el-form>
        </el-tab-pane>
      </el-tabs>
    </BaseCard>
  </div>
</template>
```

### JavaScript逻辑
```javascript
import { ref, reactive, nextTick } from 'vue'
import { ElMessage, ElMessageBox } from 'element-plus'
import { useRouter } from 'vue-router'
import { useAuthStore } from '@/store/modules/auth'
import { useI18n } from 'vue-i18n'
import { formatDate } from '@/utils/date'
import { validateSystemName, validateSystemDescription, validateApiUrl, validateSmtpHost, validatePort, validateFileSizeMB, validatePasswordLength, validateMaxLoginAttempts, validateSessionTimeout, validateUploadPath } from '@/utils/validate'
import { createLogger } from '@/utils/simpleLogger'

export default {
  name: 'SystemConfig',
  setup() {
    const router = useRouter()
    const authStore = useAuthStore()
    const { t } = useI18n()
    const logger = createLogger('SystemConfig')
    
    // 响应式数据
    const saving = ref(false)
    const testingEmail = ref(false)
    const activeTab = ref('basic')
    const inputVisible = ref(false)
    const inputValue = ref('')
    const inputRef = ref()
    
    // 表单引用
    const basicFormRef = ref()
    const difyFormRef = ref()
    const emailFormRef = ref()
    const fileFormRef = ref()
    const securityFormRef = ref()
    
    // 基础配置
    const basicConfig = reactive({
      systemName: '生成式高校科研管理平台',
      systemDescription: '基于AIGC的高校科研项目管理平台',
      timezone: 'Asia/Shanghai',
      defaultLanguage: 'zh-CN',
      maintenanceMode: false
    })
    
    // Dify配置
    const difyConfig = reactive({
      apiUrl: 'https://api.dify.ai',
      apiKey: '',
      defaultModel: 'gpt-3.5-turbo',
      maxTokens: 2000,
      temperature: 0.7,
      enabled: false
    })
    
    // 邮件配置
    const emailConfig = reactive({
      smtpHost: 'smtp.qq.com',
      smtpPort: 587,
      username: '',
      password: '',
      fromEmail: '',
      fromName: '系统通知',
      enableSSL: false,
      enableTLS: true
    })
    
    // 文件配置
    const fileConfig = reactive({
      uploadPath: '/uploads',
      allowedFormats: ['jpg', 'jpeg', 'png', 'pdf', 'doc', 'docx', 'xls', 'xlsx'],
      maxFileSize: 10,
      maxFileCount: 5,
      enableCompression: true
    })
    
    // 安全配置
    const securityConfig = reactive({
      minPasswordLength: 8,
      passwordComplexity: ['lowercase', 'numbers'],
      maxLoginAttempts: 5,
      lockoutDuration: 15,
      sessionTimeout: 120,
      enable2FA: false,
      enableIPWhitelist: false
    })
    
    // 表单验证规则
    const basicRules = {
      systemName: [
        { required: true, message: t('system.config.systemNameRequired'), trigger: 'blur' },
        { 
          validator: (rule, value, callback) => {
            if (!validateSystemName(value)) {
              callback(new Error(t('system.config.systemNameFormat')))
            } else {
              callback()
            }
          }, 
          trigger: 'blur' 
        }
      ],
      systemDescription: [
        { required: true, message: t('system.config.systemDescriptionRequired'), trigger: 'blur' },
        { 
          validator: (rule, value, callback) => {
            if (!validateSystemDescription(value)) {
              callback(new Error(t('system.config.systemDescriptionFormat')))
            } else {
              callback()
            }
          }, 
          trigger: 'blur' 
        }
      ],
      timezone: [
        { required: true, message: t('system.config.timezoneRequired'), trigger: 'change' }
      ],
      defaultLanguage: [
        { required: true, message: t('system.config.defaultLanguageRequired'), trigger: 'change' }
      ]
    }
    
    const difyRules = {
      apiUrl: [
        { required: true, message: t('system.config.apiUrlRequired'), trigger: 'blur' },
        { 
          validator: (rule, value, callback) => {
            if (!validateApiUrl(value)) {
              callback(new Error(t('system.config.apiUrlFormat')))
            } else {
              callback()
            }
          }, 
          trigger: 'blur' 
        }
      ],
      apiKey: [
        { required: true, message: t('system.config.apiKeyRequired'), trigger: 'blur' }
      ]
    }
    
    const emailRules = {
      smtpHost: [
        { required: true, message: t('system.config.smtpHostRequired'), trigger: 'blur' }
      ],
      smtpPort: [
        { required: true, message: t('system.config.smtpPortRequired'), trigger: 'blur' }
      ],
      username: [
        { required: true, message: t('system.config.usernameRequired'), trigger: 'blur' }
      ],
      password: [
        { required: true, message: t('system.config.passwordRequired'), trigger: 'blur' }
      ],
      fromEmail: [
        { required: true, message: t('system.config.fromEmailRequired'), trigger: 'blur' },
        { type: 'email', message: t('system.config.fromEmailFormat'), trigger: 'blur' }
      ]
    }
    
    const fileRules = {
      uploadPath: [
        { required: true, message: t('system.config.uploadPathRequired'), trigger: 'blur' }
      ],
      maxFileSize: [
        { required: true, message: t('system.config.maxFileSizeRequired'), trigger: 'blur' }
      ]
    }
    
    const securityRules = {
      minPasswordLength: [
        { required: true, message: t('system.config.minPasswordLengthRequired'), trigger: 'blur' }
      ],
      maxLoginAttempts: [
        { required: true, message: t('system.config.maxLoginAttemptsRequired'), trigger: 'blur' }
      ]
    }
    
    // 方法
    const handleSave = async () => {
      try {
        // 验证所有表单
        const forms = [basicFormRef, difyFormRef, emailFormRef, fileFormRef, securityFormRef]
        const validations = await Promise.all(forms.map(form => form.value?.validate().catch(() => false)))
        
        if (validations.some(valid => !valid)) {
          ElMessage.error(t('system.config.formValidationFailed'))
          return
        }
        
        saving.value = true
        
        // TODO: 调用保存配置API
        await new Promise(resolve => setTimeout(resolve, 2000))
        
        ElMessage.success(t('system.config.saveSuccess'))
        saving.value = false
      } catch (error) {
        saving.value = false
        ElMessage.error(t('system.config.saveFailed'))
      }
    }
    
    const handleReset = async () => {
      try {
        await ElMessageBox.confirm(
          t('system.config.resetConfirm'),
          t('system.config.resetConfig'),
          { type: 'warning' }
        )
        
        // 重置为默认配置
        Object.assign(basicConfig, {
          systemName: '生成式高校科研管理平台',
          systemDescription: '基于AIGC的高校科研项目管理平台',
          timezone: 'Asia/Shanghai',
          defaultLanguage: 'zh-CN',
          maintenanceMode: false
        })
        
        Object.assign(difyConfig, {
          apiUrl: 'https://api.dify.ai',
          apiKey: '',
          defaultModel: 'gpt-3.5-turbo',
          maxTokens: 2000,
          temperature: 0.7,
          enabled: false
        })
        
        Object.assign(emailConfig, {
          smtpHost: 'smtp.qq.com',
          smtpPort: 587,
          username: '',
          password: '',
          fromEmail: '',
          fromName: '系统通知',
          enableSSL: false,
          enableTLS: true
        })
        
        Object.assign(fileConfig, {
          uploadPath: '/uploads',
          allowedFormats: ['jpg', 'jpeg', 'png', 'pdf', 'doc', 'docx', 'xls', 'xlsx'],
          maxFileSize: 10,
          maxFileCount: 5,
          enableCompression: true
        })
        
        Object.assign(securityConfig, {
          minPasswordLength: 8,
          passwordComplexity: ['lowercase', 'numbers'],
          maxLoginAttempts: 5,
          lockoutDuration: 15,
          sessionTimeout: 120,
          enable2FA: false,
          enableIPWhitelist: false
        })
        
        ElMessage.success(t('system.config.resetSuccess'))
      } catch (error) {
        // 用户取消
      }
    }
    
    const handleTestEmail = async () => {
      try {
        await emailFormRef.value.validate()
        
        testingEmail.value = true
        
        // TODO: 调用测试邮件API
        await new Promise(resolve => setTimeout(resolve, 2000))
        
        ElMessage.success(t('system.config.emailTestSuccess'))
        testingEmail.value = false
      } catch (error) {
        testingEmail.value = false
        if (error !== false) {
          ElMessage.error(t('system.config.emailTestFailed'))
        }
      }
    }
    
    const removeFormat = (format) => {
      const index = fileConfig.allowedFormats.indexOf(format)
      if (index > -1) {
        fileConfig.allowedFormats.splice(index, 1)
      }
    }
    
    const showInput = () => {
      inputVisible.value = true
      nextTick(() => {
        inputRef.value?.focus()
      })
    }
    
    const handleInputConfirm = () => {
      if (inputValue.value && !fileConfig.allowedFormats.includes(inputValue.value)) {
        fileConfig.allowedFormats.push(inputValue.value)
      }
      inputVisible.value = false
      inputValue.value = ''
    }
    
    return {
      saving,
      testingEmail,
      activeTab,
      inputVisible,
      inputValue,
      inputRef,
      basicFormRef,
      difyFormRef,
      emailFormRef,
      fileFormRef,
      securityFormRef,
      basicConfig,
      difyConfig,
      emailConfig,
      fileConfig,
      securityConfig,
      basicRules,
      difyRules,
      emailRules,
      fileRules,
      securityRules,
      handleSave,
      handleReset,
      handleTestEmail,
      removeFormat,
      showInput,
      handleInputConfirm
    }
  }
}
```

## 🎨 样式实现

```scss
<style scoped>
.system-config-container {
  padding: 20px;
  background: #f7f9fc;
  min-height: calc(100vh - 56px);
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.page-title {
  font-size: 24px;
  font-weight: 600;
  color: #1e3a8a;
  margin: 0;
}

.header-actions {
  display: flex;
  gap: 12px;
}

.config-form {
  padding: 20px;
  max-width: 800px;
}

.form-tip {
  margin-left: 12px;
  color: #6b7280;
  font-size: 12px;
}

:deep(.el-tabs) {
  border-radius: 8px;
  overflow: hidden;
}

:deep(.el-tabs__header) {
  margin: 0;
  background: #f8fafc;
}

:deep(.el-tabs__nav-wrap) {
  padding: 0 20px;
}

:deep(.el-tabs__item) {
  font-weight: 500;
  color: #6b7280;
}

:deep(.el-tabs__item.is-active) {
  color: #1e3a8a;
  font-weight: 600;
}

:deep(.el-tabs__content) {
  padding: 0;
}

:deep(.el-tab-pane) {
  padding: 0;
}

:deep(.el-form-item__label) {
  font-weight: 500;
  color: #374151;
}

:deep(.el-input__wrapper) {
  border-radius: 6px;
}

:deep(.el-textarea__inner) {
  border-radius: 6px;
}

:deep(.el-select .el-input__wrapper) {
  border-radius: 6px;
}

:deep(.el-switch) {
  margin-right: 8px;
}

:deep(.el-tag) {
  border-radius: 4px;
  font-weight: 500;
}

:deep(.el-checkbox-group) {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

:deep(.el-checkbox) {
  margin-right: 0;
}

:deep(.el-slider) {
  margin: 0 12px;
}

:deep(.el-input-number) {
  width: 100%;
}

:deep(.el-input-number .el-input__wrapper) {
  border-radius: 6px;
}
</style>
```

## ⚠️ 注意事项

1. **配置分类**: 使用Element Plus的`el-tabs`组件，分为基础、Dify、邮件、文件、安全五个配置类别
2. **表单验证**: 每个配置类别都有相应的验证规则，包括必填项、格式验证、数值范围验证
3. **文件格式管理**: 使用`el-tag`组件管理允许的文件格式，支持动态添加和删除
4. **配置保存**: 保存前验证所有表单，支持批量保存所有配置项
5. **配置重置**: 重置为默认配置，需要用户确认操作
6. **测试功能**: 邮件配置支持测试连接功能，验证配置是否正确
7. **模拟数据**: 使用TODO注释标记需要后端集成的API调用
8. **用户体验**: 操作成功/失败都有相应的消息提示，重要操作需要确认对话框
9. **响应式设计**: 表单支持响应式布局，在不同屏幕尺寸下都能正常显示
10. **配置持久化**: 配置保存后需要持久化存储，页面刷新后保持配置状态

**最终要求：生成的代码必须与原型图的视觉效果和交互逻辑完全一致！**
