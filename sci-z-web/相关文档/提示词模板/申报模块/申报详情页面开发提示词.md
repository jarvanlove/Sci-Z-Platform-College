# 申报详情页面开发提示词

## 📋 页面信息
- **原型图路径**：`原型图/申报模块/申报详情.html`
- **页面类型**：详情页面
- **页面名称**：申报详情
- **主要功能**：申报信息展示、工作流状态、处理结果、操作按钮
- **对应文件路径**：`src/views/Declaration/Detail.vue`

## 🎨 原型图视觉分析

### **整体布局**
- 背景色：`#f7f9fc`
- 容器：`padding: 20px`，`min-height: calc(100vh - 56px)`
- 页面结构：页面标题 + 返回按钮 + 详情卡片区域

### **页面头部**
- 返回按钮：带左箭头图标，触发返回列表
- 标题：`申报详情`，字体大小24px，颜色`#1e3a8a`

### **详情卡片区域**
- 基本信息卡片：申报编号、申报人、部门、负责人、时间等
- 研究信息卡片：研究方向、研究课题、研究领域标签
- 工作流状态卡片：处理状态、进度条、时间线、结果展示

### **状态展示**
- 工作流状态：处理中、处理完成、处理失败
- 进度条：动态显示处理进度
- 时间线：显示处理步骤和时间
- 结果展示：成功时显示项目信息，失败时显示错误信息

## 🔧 技术实现要求

### 1. 页面结构
```vue
<template>
  <div class="declaration-detail-container">
    <!-- 页面标题和返回按钮 -->
    <div class="page-header">
      <el-button class="back-button" @click="handleBack" :icon="ArrowLeft">
        {{ $t('common.backToList') }}
      </el-button>
      <h1 class="page-title">{{ $t('declaration.detailTitle') }}</h1>
    </div>

    <!-- 加载状态 -->
    <div v-if="loading" class="loading-container">
      <el-icon class="is-loading"><Loading /></el-icon>
      <span>{{ $t('common.loading') }}</span>
    </div>

    <!-- 基本信息 -->
    <div v-else class="detail-card">
      <div class="card-title">{{ $t('declaration.basicInfo') }}</div>
      <div class="info-grid">
        <div class="info-item">
          <div class="info-label">{{ $t('declaration.number') }}</div>
          <div class="info-value">{{ declaration.number }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">{{ $t('declaration.applicant') }}</div>
          <div class="info-value">{{ declaration.applicant }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">{{ $t('declaration.department') }}</div>
          <div class="info-value">{{ declaration.department }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">{{ $t('declaration.projectLeader') }}</div>
          <div class="info-value">{{ declaration.projectLeader }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">{{ $t('declaration.documentPublishTime') }}</div>
          <div class="info-value">{{ formatDate(declaration.documentPublishTime) }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">{{ $t('declaration.projectStartTime') }}</div>
          <div class="info-value">{{ formatDate(declaration.projectStartTime) }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">{{ $t('declaration.projectEndTime') }}</div>
          <div class="info-value">{{ formatDate(declaration.projectEndTime) }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">{{ $t('declaration.submitTime') }}</div>
          <div class="info-value">{{ declaration.submitTime }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">{{ $t('declaration.currentStatus') }}</div>
          <div class="info-value">
            <el-tag
              :type="getStatusTagType(declaration.statusType)"
              :class="`status-${declaration.statusType}`"
              size="large"
            >
              {{ declaration.status }}
            </el-tag>
          </div>
        </div>
      </div>
    </div>

    <!-- 研究信息 -->
    <div class="detail-card">
      <div class="card-title">{{ $t('declaration.researchInfo') }}</div>
      <div class="info-item" style="margin-bottom: 16px">
        <div class="info-label">{{ $t('declaration.direction') }}</div>
        <div class="research-direction">{{ declaration.direction }}</div>
      </div>
      <div class="info-item" style="margin-bottom: 16px">
        <div class="info-label">{{ $t('declaration.topic') }}</div>
        <div class="research-direction">{{ declaration.topic }}</div>
      </div>
      <div class="info-item">
        <div class="info-label">{{ $t('declaration.fields') }}</div>
        <div class="field-tags">
          <el-tag
            v-for="field in declaration.fields"
            :key="field"
            class="field-tag"
            size="large"
          >
            {{ field }}
          </el-tag>
        </div>
      </div>
    </div>

    <!-- 工作流状态 -->
    <div class="detail-card">
      <div class="card-title">{{ $t('declaration.workflowStatus') }}</div>
      <div class="workflow-container">
        <div class="workflow-status">
          <div class="workflow-icon" :class="workflowStatus.type">
            {{ workflowStatus.icon }}
          </div>
          <div class="workflow-info">
            <div class="workflow-title">{{ workflowStatus.title }}</div>
            <div class="workflow-description">
              {{ workflowStatus.description }}
            </div>
            <div v-if="workflowStatus.showProgress" class="progress-bar">
              <el-progress
                :percentage="workflowStatus.progress"
                :color="getProgressColor(workflowStatus.progress)"
                :stroke-width="6"
                :show-text="false"
              />
            </div>
          </div>
        </div>

        <!-- 时间线 -->
        <div v-if="workflowTimeline.length > 0" class="workflow-timeline">
          <div
            v-for="item in workflowTimeline"
            :key="item.id"
            class="timeline-item"
          >
            <div class="timeline-icon" :class="item.status">
              {{ item.icon }}
            </div>
            <div class="timeline-content">
              <div class="timeline-title">{{ item.title }}</div>
              <div class="timeline-time">{{ item.time }}</div>
            </div>
          </div>
        </div>

        <!-- 结果展示 -->
        <div v-if="workflowResult" class="result-container">
          <div
            class="result-success"
            v-if="declaration.statusType === 'success'"
          >
            <div class="result-title">
              <el-icon><Check /></el-icon>
              {{ $t('declaration.processSuccess') }}
            </div>
            <div class="result-content">
              <p>
                <strong>{{ $t('declaration.projectId') }}:</strong> {{ workflowResult.projectId }}
              </p>
              <p>
                <strong>{{ $t('declaration.projectName') }}:</strong> {{ workflowResult.projectName }}
              </p>
              <p>
                <strong>{{ $t('declaration.projectDescription') }}:</strong> {{ workflowResult.projectDescription }}
              </p>
              <p>
                <a class="project-link" href="#" @click="handleViewProject">
                  <el-icon><View /></el-icon>
                  {{ $t('declaration.viewProject') }}
                </a>
              </p>
            </div>
          </div>

          <div
            class="result-failed"
            v-else-if="declaration.statusType === 'failed'"
          >
            <div class="result-title">
              <el-icon><Close /></el-icon>
              {{ $t('declaration.processFailed') }}
            </div>
            <div class="result-content">
              <p>
                <strong>{{ $t('declaration.failureReason') }}:</strong> {{ workflowResult.errorMessage }}
              </p>
              <p>
                <strong>{{ $t('declaration.suggestion') }}:</strong> {{ workflowResult.suggestion }}
              </p>
              <div v-if="workflowResult.errorDetails" class="error-details">
                {{ workflowResult.errorDetails }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 操作按钮 -->
    <div class="detail-card" v-if="showActionButtons">
      <div class="action-buttons">
        <el-button
          v-if="declaration.statusType === 'failed'"
          type="info"
          @click="handleRedeclare"
        >
          <el-icon><Refresh /></el-icon>
          {{ $t('declaration.redeclare') }}
        </el-button>
        <el-button
          v-if="declaration.statusType === 'success'"
          type="primary"
          @click="handleViewProject"
        >
          <el-icon><View /></el-icon>
          {{ $t('declaration.viewProject') }}
        </el-button>
      </div>
    </div>
  </div>
</template>
```

### 2. 核心功能实现
```javascript
<script setup>
import { ref, reactive, computed, onMounted } from 'vue'
import { useRouter, useRoute } from 'vue-router'
import { useI18n } from 'vue-i18n'
import { ElMessage } from 'element-plus'
import { ArrowLeft, Check, Close, Refresh, View, Loading } from '@element-plus/icons-vue'
import { formatDate } from '@/utils/date'
import { STATUS_CONFIG, DECLARATION_STATUS_CONFIG } from '@/utils/constants'
import { createLogger } from '@/utils/simpleLogger'

const router = useRouter()
const route = useRoute()
const { t } = useI18n()
const logger = createLogger('DeclarationDetail')

// 申报数据
const declaration = ref({})
const loading = ref(false)

// 工作流时间线
const workflowTimeline = ref([])

// 工作流结果
const workflowResult = ref(null)

// 工作流状态
const workflowStatus = computed(() => {
  const status = declaration.value.statusType || 'pending'

  switch (status) {
    case 'submitting':
      return {
        type: 'processing',
        icon: '⏳',
        title: t('declaration.processing'),
        description: t('declaration.processingDesc'),
        showProgress: true,
        progress: declaration.value.progress || 65
      }
    case 'success':
      return {
        type: 'completed',
        icon: '✓',
        title: t('declaration.completed'),
        description: t('declaration.completedDesc'),
        showProgress: false,
        progress: 100
      }
    case 'failed':
      return {
        type: 'failed',
        icon: '✗',
        title: t('declaration.failed'),
        description: t('declaration.failedDesc'),
        showProgress: false,
        progress: 0
      }
    default:
      return {
        type: 'pending',
        icon: '?',
        title: t('declaration.unknown'),
        description: t('declaration.unknownDesc'),
        showProgress: false,
        progress: 0
      }
  }
})

// 是否显示操作按钮
const showActionButtons = computed(() => {
  return declaration.value.statusType === 'failed' || declaration.value.statusType === 'success'
})

// 获取状态标签类型（从constants.js导入）
const getStatusTagType = (statusType) => {
  return DECLARATION_STATUS_CONFIG[statusType]?.type || 'info'
}

// 获取进度条颜色
const getProgressColor = (progress) => {
  if (progress <= 30) return '#dc2626'
  if (progress <= 70) return '#f59e0b'
  return '#16a34a'
}

// 加载申报详情
const loadDeclarationDetail = async () => {
  try {
    loading.value = true
    logger.info('Starting to load declaration detail', { id: route.params.id })
    
    // TODO: 替换为实际的后端接口
    // const response = await getDeclarationDetail(route.params.id)
    // declaration.value = response.data.declaration
    // workflowTimeline.value = response.data.timeline
    // workflowResult.value = response.data.result
    
    // 临时模拟数据（后端开发完成后删除）
    await new Promise(resolve => setTimeout(resolve, 1000)) // 模拟网络延迟
    
    // 模拟申报数据
    declaration.value = {
      id: route.params.id || 1,
      number: 'SB2024001',
      applicant: '张教授',
      department: '科委',
      projectLeader: '张教授',
      documentPublishTime: '2024-01-10',
      projectStartTime: '2024-02-01',
      projectEndTime: '2024-12-31',
      direction: '基于深度学习的智能制造关键技术研究，重点围绕工业互联网、智能传感器、机器视觉等核心技术，推动制造业数字化转型升级。通过构建智能制造平台，实现生产过程的智能化监控、预测性维护和质量优化控制。',
      topic: '面向智能制造的多模态数据融合与决策优化技术研究',
      fields: ['人工智能', '智能制造', '机器学习', '工业互联网', '数据融合'],
      submitTime: '2024-01-15',
      status: '申报中',
      statusType: 'submitting',
      progress: 65
    }
    
    // 模拟工作流时间线
    workflowTimeline.value = [
      {
        id: 1,
        title: t('declaration.timelineSubmit'),
        time: '2024-01-15 14:30:25',
        status: 'completed',
        icon: '✓'
      },
      {
        id: 2,
        title: t('declaration.timelineStart'),
        time: '2024-01-15 14:30:28',
        status: 'completed',
        icon: '✓'
      },
      {
        id: 3,
        title: t('declaration.timelineAnalysis'),
        time: '2024-01-15 14:31:15',
        status: 'completed',
        icon: '✓'
      },
      {
        id: 4,
        title: t('declaration.timelineGenerate'),
        time: '2024-01-15 14:32:45',
        status: 'completed',
        icon: '✓'
      },
      {
        id: 5,
        title: t('declaration.timelineStore'),
        time: '2024-01-15 14:33:00',
        status: 'completed',
        icon: '✓'
      },
      {
        id: 6,
        title: t('declaration.timelineDocument'),
        time: '2024-01-15 14:33:30',
        status: 'completed',
        icon: '✓'
      }
    ]
    
    // 模拟工作流结果
    if (declaration.value.statusType === 'success') {
      workflowResult.value = {
        projectId: 'PRJ_20240115_001',
        projectName: t('declaration.sampleProjectName'),
        projectDescription: t('declaration.sampleProjectDesc')
      }
    }
    
    if (declaration.value.statusType === 'failed') {
      workflowResult.value = {
        errorMessage: t('declaration.sampleErrorMessage'),
        suggestion: t('declaration.sampleSuggestion'),
        errorDetails: t('declaration.sampleErrorDetails')
      }
    }
    
    logger.info('Declaration detail loaded successfully', { id: declaration.value.id })
  } catch (error) {
    logger.error('Failed to load declaration detail', error)
    ElMessage.error(t('declaration.loadError'))
  } finally {
    loading.value = false
  }
}

// 事件处理
const handleBack = () => {
  router.push('/declaration/list')
}

const handleRedeclare = () => {
  ElMessage.info(t('declaration.redeclareInfo'))
  router.push('/declaration/create')
}

const handleViewProject = () => {
  ElMessage.info(t('declaration.viewProjectInfo'))
  router.push('/project/detail')
}

// 日期格式化函数
const formatDate = (dateString) => {
  if (!dateString) return ''
  return dateString
}

onMounted(() => {
  loadDeclarationDetail()
})
</script>
```

### 3. 样式实现
```scss
<style lang="scss" scoped>
.declaration-detail-container {
  padding: 20px;
  background: #f7f9fc;
  min-height: calc(100vh - 56px);
}

.page-header {
  display: flex;
  align-items: center;
  margin-bottom: 20px;
}

.back-button {
  margin-right: 12px;
}

.page-title {
  font-size: 24px;
  font-weight: 600;
  color: #1e3a8a;
  margin: 0;
}

.detail-card {
  background: #ffffff;
  border-radius: 8px;
  padding: 24px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
  border: 1px solid #e5e7eb;
  margin-bottom: 20px;
}

.card-title {
  font-size: 18px;
  font-weight: 600;
  color: #1e3a8a;
  margin-bottom: 16px;
  padding-bottom: 8px;
  border-bottom: 1px solid #e5e7eb;
}

.info-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 16px;
  margin-bottom: 16px;
}

.info-item {
  display: flex;
  flex-direction: column;
}

.info-label {
  font-size: 14px;
  color: #6b7280;
  margin-bottom: 4px;
  font-weight: 500;
}

.info-value {
  font-size: 16px;
  color: #374151;
  font-weight: 500;
}

// 状态标签样式
:deep(.status-submitting) {
  background-color: #fef3c7 !important;
  color: #f59e0b !important;
  border-color: #f59e0b !important;
}

:deep(.status-success) {
  background-color: #dcfce7 !important;
  color: #16a34a !important;
  border-color: #16a34a !important;
}

:deep(.status-failed) {
  background-color: #fee2e2 !important;
  color: #dc2626 !important;
  border-color: #dc2626 !important;
}

.field-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.field-tag {
  background: #e0e7ff;
  color: #1e3a8a;
  border: none;
}

.research-direction {
  background: #f8fafc;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  padding: 16px;
  font-size: 14px;
  line-height: 1.6;
  color: #374151;
  white-space: pre-wrap;
}

// 工作流状态样式
.workflow-container {
  margin-top: 16px;
}

.workflow-status {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
  padding: 12px;
  background: #f8fafc;
  border-radius: 6px;
  border: 1px solid #e5e7eb;
}

.workflow-icon {
  font-size: 20px;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;

  &.processing {
    background: #f59e0b;
    color: white;
    animation: pulse 2s infinite;
  }

  &.completed {
    background: #16a34a;
    color: white;
  }

  &.failed {
    background: #dc2626;
    color: white;
  }

  &.pending {
    background: #e5e7eb;
    color: #6b7280;
  }
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

.workflow-info {
  flex: 1;
}

.workflow-title {
  font-size: 16px;
  font-weight: 600;
  color: #374151;
  margin-bottom: 4px;
}

.workflow-description {
  font-size: 14px;
  color: #6b7280;
}

.progress-bar {
  margin-top: 8px;
}

.workflow-timeline {
  margin-top: 16px;
}

.timeline-item {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 8px 0;
  position: relative;

  &:not(:last-child)::after {
    content: "";
    position: absolute;
    left: 8px;
    top: 32px;
    bottom: -8px;
    width: 2px;
    background: #e5e7eb;
  }
}

.timeline-icon {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  color: #ffffff;
  z-index: 1;
  position: relative;

  &.pending {
    background: #e5e7eb;
    color: #6b7280;
  }

  &.processing {
    background: #f59e0b;
    animation: pulse 2s infinite;
  }

  &.completed {
    background: #16a34a;
  }

  &.failed {
    background: #dc2626;
  }
}

.timeline-content {
  flex: 1;
}

.timeline-title {
  font-size: 14px;
  font-weight: 500;
  color: #374151;
  margin-bottom: 2px;
}

.timeline-time {
  font-size: 12px;
  color: #6b7280;
}

// 结果展示样式
.result-container {
  margin-top: 16px;
}

.result-success {
  background: #f0fdf4;
  border: 1px solid #bbf7d0;
  border-radius: 6px;
  padding: 16px;
}

.result-failed {
  background: #fef2f2;
  border: 1px solid #fecaca;
  border-radius: 6px;
  padding: 16px;
}

.result-title {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.result-success .result-title {
  color: #16a34a;
}

.result-failed .result-title {
  color: #dc2626;
}

.result-content {
  font-size: 14px;
  color: #374151;
  line-height: 1.6;
}

.project-link {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  color: #1e3a8a;
  text-decoration: none;
  font-weight: 500;

  &:hover {
    text-decoration: underline;
  }
}

// 操作按钮样式
.action-buttons {
  display: flex;
  gap: 12px;
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid #e5e7eb;
}

.action-buttons .el-button {
  padding: 10px 20px;
}

// 错误信息样式
.error-details {
  background: #fef2f2;
  border: 1px solid #fecaca;
  border-radius: 6px;
  padding: 12px;
  margin-top: 8px;
  font-family: monospace;
  font-size: 12px;
  color: #dc2626;
  white-space: pre-wrap;
}

// 响应式设计
@media (max-width: 768px) {
  .info-grid {
    grid-template-columns: 1fr;
  }

  .action-buttons {
    flex-direction: column;
  }
}
</style>
```

## ⚠️ 重要注意事项

1. **严格按照原型图实现**：布局、颜色、动画效果必须与原型图一致
2. **信息展示**：基本信息、研究信息、工作流状态三个主要卡片
3. **状态管理**：根据申报状态显示不同的工作流状态和结果
4. **进度条**：使用`el-progress`组件显示处理进度
5. **时间线**：使用自定义时间线组件展示处理步骤
6. **结果展示**：成功时显示项目信息，失败时显示错误详情
7. **操作按钮**：根据状态显示重新申报或查看项目按钮
8. **响应式设计**：支持不同屏幕尺寸，移动端优化布局
9. **国际化支持**：所有文本使用$t()函数
10. **图标使用**：使用Element Plus图标库，如`ArrowLeft`、`Check`、`Close`等
11. **动画效果**：处理中状态的脉冲动画效果
12. **接口集成**：所有数据通过后端接口获取，包含完整的错误处理和加载状态
13. **常量管理**：状态标签类型从constants.js导入，统一管理

**最终要求：生成的代码必须与原型图的视觉效果和交互逻辑完全一致！**
