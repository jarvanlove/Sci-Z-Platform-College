# 知识库页面开发提示词

## 📋 页面信息
- **原型图路径**：`原型图/AI助手/知识库.html`
- **页面类型**：知识库搜索页面
- **页面名称**：知识库
- **主要功能**：知识库搜索、文档管理、AI对话交互（与AI对话页面保持一致）
- **对应文件路径**：`src/views/AI/Knowledge.vue`

## 🎨 原型图视觉分析

### **整体布局**
- 三栏布局：左侧知识库列表 + 中间搜索结果 + 右侧AI对话
- 背景色：`#f7f9fc`
- 高度：`100vh`，全屏显示

### **左侧知识库列表区域**
- 宽度：`280px`
- 背景：`#ffffff`
- 边框：`1px solid #e5e7eb`
- 头部：搜索框、新建知识库按钮
- 列表：知识库分类，支持展开/收起

### **中间搜索结果区域**
- 搜索框：顶部固定，支持实时搜索
- 结果列表：文档卡片，显示标题、摘要、来源、时间
- 分页：底部分页组件
- 筛选：支持按类型、时间筛选

### **右侧AI对话区域**
- **与AI对话页面完全一致**：对话历史、消息显示、输入框
- 支持流式响应、代码高亮、Markdown渲染
- 对话上下文与知识库搜索结果关联

## 🔧 技术实现要求

### 1. 页面结构
```vue
<template>
  <div class="knowledge-base-container">
    <!-- 左侧知识库列表 -->
    <div class="kb-list-sidebar">
      <div class="kb-list-header">
        <div class="search-input-wrap">
          <el-input
            v-model="kbSearchKeyword"
            :placeholder="$t('ai.knowledge.searchKb')"
            clearable
            @input="handleKbSearch"
          >
            <template #prefix>
              <el-icon><Search /></el-icon>
            </template>
          </el-input>
        </div>
        <el-button type="primary" class="new-kb-btn" @click="createKnowledgeBase">
          <el-icon><Plus /></el-icon>
          {{ $t('ai.knowledge.newKb') }}
        </el-button>
      </div>
      
      <div class="kb-list">
        <div
          v-for="kb in knowledgeBases"
          :key="kb.id"
          class="kb-item"
          :class="{ active: currentKbId === kb.id }"
          @click="selectKnowledgeBase(kb.id)"
        >
          <div class="kb-item-content">
            <div class="kb-title">{{ kb.name }}</div>
            <div class="kb-desc">{{ kb.description }}</div>
            <div class="kb-meta">
              <span class="kb-count">{{ kb.documentCount }} {{ $t('ai.knowledge.documents') }}</span>
              <span class="kb-time">{{ formatTime(kb.updatedAt) }}</span>
            </div>
          </div>
          <div class="kb-item-actions" @click.stop>
            <el-dropdown @command="(action) => handleKbAction(action, kb)">
              <el-button class="kb-more-btn" text>
                <el-icon><MoreFilled /></el-icon>
              </el-button>
              <template #dropdown>
                <el-dropdown-menu>
                  <el-dropdown-item command="edit">{{ $t('common.edit') }}</el-dropdown-item>
                  <el-dropdown-item command="settings">{{ $t('common.settings') }}</el-dropdown-item>
                  <el-dropdown-item command="delete" divided>
                    {{ $t('common.delete') }}
                  </el-dropdown-item>
                </el-dropdown-menu>
              </template>
            </el-dropdown>
          </div>
        </div>
      </div>
    </div>

    <!-- 中间搜索结果区域 -->
    <div class="search-results-area">
      <!-- 搜索头部 -->
      <div class="search-header">
        <div class="search-input-container">
          <el-input
            v-model="searchKeyword"
            :placeholder="$t('ai.knowledge.searchPlaceholder')"
            size="large"
            @keyup.enter="handleSearch"
            @input="handleSearchInput"
          >
            <template #prefix>
              <el-icon><Search /></el-icon>
            </template>
            <template #suffix>
              <el-button
                v-if="searchKeyword"
                text
                @click="clearSearch"
              >
                <el-icon><Close /></el-icon>
              </el-button>
            </template>
          </el-input>
        </div>
        
        <div class="search-actions">
          <el-button @click="handleSearch">
            <el-icon><Search /></el-icon>
            {{ $t('common.search') }}
          </el-button>
          <el-button @click="showFilters">
            <el-icon><Filter /></el-icon>
            {{ $t('common.filter') }}
          </el-button>
        </div>
      </div>

      <!-- 筛选条件 -->
      <div v-if="showFilterPanel" class="filter-panel">
        <div class="filter-row">
          <div class="filter-item">
            <label>{{ $t('ai.knowledge.documentType') }}</label>
            <el-select v-model="filters.type" clearable>
              <el-option label="全部" value="" />
              <el-option label="PDF" value="pdf" />
              <el-option label="Word" value="docx" />
              <el-option label="Markdown" value="md" />
              <el-option label="文本" value="txt" />
            </el-select>
          </div>
          <div class="filter-item">
            <label>{{ $t('ai.knowledge.timeRange') }}</label>
            <el-date-picker
              v-model="filters.dateRange"
              type="daterange"
              :range-separator="$t('common.to')"
              :start-placeholder="$t('common.startDate')"
              :end-placeholder="$t('common.endDate')"
            />
          </div>
          <div class="filter-item">
            <el-button @click="applyFilters">{{ $t('common.apply') }}</el-button>
            <el-button @click="resetFilters">{{ $t('common.reset') }}</el-button>
          </div>
        </div>
      </div>

      <!-- 搜索结果 -->
      <div class="search-results">
        <div v-if="searching" class="search-loading">
          <el-icon class="is-loading"><Loading /></el-icon>
          <span>{{ $t('ai.knowledge.searching') }}</span>
        </div>

        <div v-else-if="searchResults.length === 0 && searchKeyword" class="no-results">
          <div class="no-results-icon">🔍</div>
          <div class="no-results-title">{{ $t('ai.knowledge.noResults') }}</div>
          <div class="no-results-subtitle">{{ $t('ai.knowledge.tryDifferentKeywords') }}</div>
        </div>

        <div v-else-if="searchResults.length === 0" class="empty-state">
          <div class="empty-icon">📚</div>
          <div class="empty-title">{{ $t('ai.knowledge.welcome') }}</div>
          <div class="empty-subtitle">{{ $t('ai.knowledge.searchHint') }}</div>
        </div>

        <div v-else class="results-list">
          <div
            v-for="result in searchResults"
            :key="result.id"
            class="result-item"
            @click="selectDocument(result)"
          >
            <div class="result-header">
              <div class="result-title">{{ result.title }}</div>
              <div class="result-type">
                <el-tag :type="getTypeTagType(result.type)" size="small">
                  {{ result.type.toUpperCase() }}
                </el-tag>
              </div>
            </div>
            
            <div class="result-content">
              <div class="result-summary">{{ result.summary }}</div>
              <div class="result-highlights" v-if="result.highlights">
                <div
                  v-for="highlight in result.highlights"
                  :key="highlight"
                  class="highlight-item"
                  v-html="highlight"
                ></div>
              </div>
            </div>
            
            <div class="result-meta">
              <div class="result-source">
                <el-icon><Document /></el-icon>
                <span>{{ result.source }}</span>
              </div>
              <div class="result-time">{{ formatTime(result.updatedAt) }}</div>
              <div class="result-score">
                <el-icon><Star /></el-icon>
                <span>{{ Math.round(result.score * 100) }}%</span>
              </div>
            </div>
          </div>
        </div>

        <!-- 分页 -->
        <BasePagination
          v-if="searchResults.length > 0"
          :current="pagination.current"
          :size="pagination.size"
          :total="pagination.total"
          @change="handlePageChange"
          @size-change="handlePageSizeChange"
        />
      </div>
    </div>

    <!-- 右侧AI对话区域 - 与AI对话页面完全一致 -->
    <div class="chat-sidebar">
      <div class="chat-header">
        <div class="chat-title-header">
          {{ $t('ai.knowledge.aiAssistant') }}
        </div>
        <div class="chat-actions">
          <el-button text @click="clearChatMessages">
            <el-icon><Delete /></el-icon>
            {{ $t('ai.chat.clear') }}
          </el-button>
        </div>
      </div>

      <!-- 消息区域 - 与AI对话页面完全一致 -->
      <div class="messages-container" ref="messagesContainer">
        <div v-if="chatMessages.length === 0" class="empty-chat-message">
          <div class="empty-icon">🤖</div>
          <div class="empty-title">{{ $t('ai.knowledge.chatWelcome') }}</div>
          <div class="empty-subtitle">{{ $t('ai.knowledge.chatHint') }}</div>
        </div>

        <div
          v-for="message in chatMessages"
          :key="message.id"
          class="message-item"
          :class="message.role"
        >
          <div class="message-avatar">
            <div v-if="message.role === 'user'" class="user-avatar">
              <el-icon><User /></el-icon>
            </div>
            <div v-else class="ai-avatar">
              <el-icon><Robot /></el-icon>
            </div>
          </div>
          
          <div class="message-content">
            <div class="message-header">
              <span class="message-role">
                {{ message.role === 'user' ? $t('ai.chat.user') : $t('ai.chat.assistant') }}
              </span>
              <span class="message-time">{{ formatTime(message.timestamp) }}</span>
            </div>
            
            <div class="message-body">
              <!-- 文本内容 -->
              <div v-if="message.contentType === 'text'" class="text-content">
                {{ message.content }}
              </div>
              
              <!-- Markdown内容 -->
              <div v-else-if="message.contentType === 'markdown'" class="markdown-content">
                <div v-html="renderMarkdown(message.content)"></div>
              </div>
              
              <!-- 代码内容 -->
              <div v-else-if="message.contentType === 'code'" class="code-content">
                <div class="code-header">
                  <span class="code-language">{{ message.payload.language }}</span>
                  <el-button text size="small" @click="copyCode(message.payload.content)">
                    <el-icon><CopyDocument /></el-icon>
                    {{ $t('common.copy') }}
                  </el-button>
                </div>
                <pre><code :class="message.payload.language">{{ message.payload.content }}</code></pre>
              </div>
              
              <!-- 流式响应 -->
              <div v-if="message.streaming" class="streaming-indicator">
                <el-icon class="is-loading"><Loading /></el-icon>
                <span>{{ $t('ai.chat.thinking') }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 输入区域 - 与AI对话页面完全一致 -->
      <div class="input-area">
        <div class="input-container">
          <div class="input-actions">
            <el-button text @click="toggleAttachment">
              <el-icon><Paperclip /></el-icon>
            </el-button>
          </div>
          
          <el-input
            v-model="chatInputMessage"
            type="textarea"
            :rows="1"
            :autosize="{ minRows: 1, maxRows: 6 }"
            :placeholder="$t('ai.knowledge.chatPlaceholder')"
            class="message-input"
            @keydown.enter.exact="handleChatSend"
            @keydown.enter.shift.exact="handleNewLine"
          />
          
          <el-button
            type="primary"
            class="send-button"
            :disabled="!chatInputMessage.trim() || isGenerating"
            :loading="isGenerating"
            @click="handleChatSend"
          >
            <el-icon v-if="!isGenerating"><Position /></el-icon>
            <el-icon v-else class="is-loading"><Loading /></el-icon>
          </el-button>
        </div>
        
        <div class="input-footer">
          <span class="input-tip">{{ $t('ai.knowledge.chatTip') }}</span>
        </div>
      </div>
    </div>
  </div>
</template>
```

### 2. 核心功能实现
```javascript
<script setup>
import { ref, reactive, computed, onMounted, nextTick, watch } from 'vue'
import { useI18n } from 'vue-i18n'
import { ElMessage, ElMessageBox } from 'element-plus'
import {
  Search, Plus, MoreFilled, Close, Filter, Document, Star,
  Delete, User, Robot, CopyDocument, Loading, Paperclip, Position
} from '@element-plus/icons-vue'
import { BasePagination } from '@/components/Common'
import { searchDocuments, getKnowledgeBases, createKnowledgeBase, sendMessage } from '@/api/AI'
import { formatDate } from '@/utils/date'
import { createLogger } from '@/utils/simpleLogger'

const { t } = useI18n()
const logger = createLogger('KnowledgeBase')

// 响应式数据
const messagesContainer = ref()
const kbSearchKeyword = ref('')
const searchKeyword = ref('')
const searching = ref(false)
const showFilterPanel = ref(false)
const currentKbId = ref(null)
const isGenerating = ref(false)

// 知识库列表
const knowledgeBases = ref([])

// 搜索结果
const searchResults = ref([])

// 分页
const pagination = reactive({
  current: 1,
  size: 10,
  total: 0
})

// 筛选条件
const filters = reactive({
  type: '',
  dateRange: []
})

// 对话相关 - 与AI对话页面完全一致
const chatInputMessage = ref('')
const chatMessages = ref([])

// 知识库与搜索结果均通过后端接口获取（无本地Mock）
// TODO: getKnowledgeBases / searchDocuments 接口由后端提供

// 方法
const loadKnowledgeBases = async () => {
  try {
    // TODO: 调用API获取知识库列表
    // const response = await getKnowledgeBases()
    // knowledgeBases.value = response.data
    knowledgeBases.value = []
  } catch (error) {
    ElMessage.error(t('ai.knowledge.loadKbError'))
  }
}

const selectKnowledgeBase = (kbId) => {
  currentKbId.value = kbId
  // 清空搜索结果
  searchResults.value = []
  searchKeyword.value = ''
}

const handleKbSearch = (keyword) => {
  // 实时搜索知识库（建议后端支持关键词筛选）
  // TODO: getKnowledgeBases({ keyword }) 并更新 knowledgeBases
}

const handleSearch = async () => {
  if (!searchKeyword.value.trim()) {
    ElMessage.warning(t('ai.knowledge.enterKeyword'))
    return
  }
  
  searching.value = true
  
  try {
    // TODO: 调用API搜索文档
    // const response = await searchDocuments({
    //   keyword: searchKeyword.value,
    //   kbId: currentKbId.value,
    //   page: pagination.current,
    //   size: pagination.size,
    //   filters: filters
    // })
    // searchResults.value = response.data
    // pagination.total = response.total
    ElMessage.success(t('ai.knowledge.searchComplete'))
  } catch (error) {
    ElMessage.error(t('ai.knowledge.searchError'))
  } finally {
    searching.value = false
  }
}

const handleSearchInput = () => {
  // 实时搜索建议（可选）
}

const clearSearch = () => {
  searchKeyword.value = ''
  searchResults.value = []
  pagination.total = 0
}

const showFilters = () => {
  showFilterPanel.value = !showFilterPanel.value
}

const applyFilters = () => {
  pagination.current = 1
  handleSearch()
}

const resetFilters = () => {
  filters.type = ''
  filters.dateRange = []
  pagination.current = 1
  handleSearch()
}

const selectDocument = (document) => {
  // 将文档内容发送到AI对话
  const message = `请帮我分析这个文档：${document.title}\n\n${document.summary}`
  chatInputMessage.value = message
  handleChatSend()
}

const getTypeTagType = (type) => {
  const typeMap = {
    pdf: 'danger',
    docx: 'primary',
    md: 'success',
    txt: 'info'
  }
  return typeMap[type] || 'info'
}

const handlePageChange = (page) => {
  pagination.current = page
  handleSearch()
}

const handlePageSizeChange = (size) => {
  pagination.size = size
  pagination.current = 1
  handleSearch()
}

const createKnowledgeBase = async () => {
  try {
    const { value: name } = await ElMessageBox.prompt(
      t('ai.knowledge.createKbTitle'),
      t('ai.knowledge.newKb'),
      {
        confirmButtonText: t('common.confirm'),
        cancelButtonText: t('common.cancel'),
        inputPlaceholder: t('ai.knowledge.kbNamePlaceholder')
      }
    )
    
    const newKb = {
      id: Date.now().toString(),
      name,
      description: t('ai.knowledge.newKbDesc'),
      documentCount: 0,
      updatedAt: new Date()
    }
    
    // TODO: 调用API创建知识库
    // await createKnowledgeBase(newKb)
    
    knowledgeBases.value.unshift(newKb)
    ElMessage.success(t('ai.knowledge.kbCreated'))
  } catch (error) {
    // 用户取消
  }
}

const handleKbAction = async (action, kb) => {
  switch (action) {
    case 'edit':
      await editKnowledgeBase(kb)
      break
    case 'settings':
      await openKbSettings(kb)
      break
    case 'delete':
      await deleteKnowledgeBase(kb)
      break
  }
}

const editKnowledgeBase = async (kb) => {
  try {
    const { value: name } = await ElMessageBox.prompt(
      t('ai.knowledge.editKbTitle'),
      t('common.edit'),
      {
        confirmButtonText: t('common.confirm'),
        cancelButtonText: t('common.cancel'),
        inputValue: kb.name
      }
    )
    
    kb.name = name
    // TODO: 调用API更新知识库
    // await updateKnowledgeBase(kb.id, { name })
    
    ElMessage.success(t('ai.knowledge.kbUpdated'))
  } catch (error) {
    // 用户取消
  }
}

const openKbSettings = (kb) => {
  ElMessage.info(t('ai.knowledge.settingsComingSoon'))
}

const deleteKnowledgeBase = async (kb) => {
  try {
    await ElMessageBox.confirm(
      t('ai.knowledge.deleteKbConfirm'),
      t('common.confirm'),
      {
        confirmButtonText: t('common.confirm'),
        cancelButtonText: t('common.cancel'),
        type: 'warning'
      }
    )
    
    // TODO: 调用API删除知识库
    // await deleteKnowledgeBase(kb.id)
    
    const index = knowledgeBases.value.findIndex(k => k.id === kb.id)
    if (index > -1) {
      knowledgeBases.value.splice(index, 1)
    }
    
    if (currentKbId.value === kb.id) {
      currentKbId.value = null
      searchResults.value = []
    }
    
    ElMessage.success(t('ai.knowledge.kbDeleted'))
  } catch (error) {
    // 用户取消
  }
}

// AI对话相关方法 - 与AI对话页面完全一致
const handleChatSend = async () => {
  if (!chatInputMessage.value.trim() || isGenerating.value) return
  
  const userMessage = {
    id: Date.now().toString(),
    role: 'user',
    content: chatInputMessage.value,
    contentType: 'text',
    timestamp: new Date()
  }
  
  chatMessages.value.push(userMessage)
  const userInput = chatInputMessage.value
  chatInputMessage.value = ''
  
  await nextTick()
  scrollToBottom()
  
  await sendAIMessage(userInput)
}

const sendAIMessage = async (userInput) => {
  isGenerating.value = true
  
  const aiMessage = {
    id: Date.now().toString(),
    role: 'assistant',
    content: '',
    contentType: 'text',
    timestamp: new Date(),
    streaming: true
  }
  
  chatMessages.value.push(aiMessage)
  
  try {
    // TODO: 调用AI对话接口（流式），结合知识库上下文
    // 约定：sendMessage支持ReadableStream或SSE事件：
    // { type: 'text' | 'markdown' | 'code' | 'image' | 'file' | 'metadata' | 'end' | 'error', payload }
    // 示例：Fetch + ReadableStream
    // const stream = await sendMessage({ message: userInput, context: searchResults.value, kbId: currentKbId.value })
    // const reader = stream.getReader()
    // const decoder = new TextDecoder()
    // while (true) {
    //   const { value, done } = await reader.read()
    //   if (done) break
    //   const chunk = decoder.decode(value, { stream: true })
    //   for (const line of chunk.split('\n')) {
    //     if (!line) continue
    //     const event = JSON.parse(line)
    //     switch (event.type) {
    //       case 'text':
    //         aiMessage.content += event.payload
    //         break
    //       case 'markdown':
    //         aiMessage.contentType = 'markdown'
    //         aiMessage.content += event.payload
    //         break
    //       case 'code':
    //         aiMessage.contentType = 'code'
    //         aiMessage.payload = { ...(aiMessage.payload || {}), ...event.payload }
    //         break
    //       case 'image':
    //         // TODO: 渲染图片消息
    //         break
    //       case 'file':
    //         // TODO: 渲染文件附件
    //         break
    //       case 'metadata':
    //         // TODO: 处理元信息
    //         break
    //       case 'end':
    //         break
    //       case 'error':
    //         throw new Error(event.payload?.message || 'AI error')
    //     }
    //     await nextTick(); scrollToBottom()
    //   }
    // }
    
  } catch (error) {
    aiMessage.content = t('ai.chat.responseError')
    ElMessage.error(t('ai.chat.sendError'))
  } finally {
    aiMessage.streaming = false
    isGenerating.value = false
    await nextTick()
    scrollToBottom()
  }
}

// 流式处理由sendMessage实现，前端按事件类型增量渲染（见上方TODO示例）

const clearChatMessages = async () => {
  try {
    await ElMessageBox.confirm(
      t('ai.chat.clearConfirm'),
      t('common.confirm'),
      {
        confirmButtonText: t('common.confirm'),
        cancelButtonText: t('common.cancel'),
        type: 'warning'
      }
    )
    
    chatMessages.value = []
    ElMessage.success(t('ai.chat.cleared'))
  } catch (error) {
    // 用户取消
  }
}

const copyCode = async (code) => {
  try {
    await navigator.clipboard.writeText(code)
    ElMessage.success(t('common.copied'))
  } catch (error) {
    ElMessage.error(t('common.copyError'))
  }
}

const renderMarkdown = (content) => {
  // TODO: 实现Markdown渲染
  return content.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
    .replace(/\*(.*?)\*/g, '<em>$1</em>')
    .replace(/`(.*?)`/g, '<code>$1</code>')
}

const scrollToBottom = () => {
  if (messagesContainer.value) {
    messagesContainer.value.scrollTop = messagesContainer.value.scrollHeight
  }
}

const formatTime = (date) => {
  return new Date(date).toLocaleTimeString('zh-CN', {
    hour: '2-digit',
    minute: '2-digit'
  })
}

const handleNewLine = () => {
  // Shift+Enter 换行，不发送
}

const toggleAttachment = () => {
  ElMessage.info(t('ai.chat.attachmentComingSoon'))
}

// 监听消息变化，自动滚动
watch(chatMessages, () => {
  nextTick(() => {
    scrollToBottom()
  })
}, { deep: true })

onMounted(() => {
  loadKnowledgeBases()
})
</script>
```

### 3. 样式实现
```scss
<style lang="scss" scoped>
.knowledge-base-container {
  display: flex;
  height: 100vh;
  background: #f7f9fc;
}

/* 左侧知识库列表 */
.kb-list-sidebar {
  width: 280px;
  background: #ffffff;
  border-right: 1px solid #e5e7eb;
  display: flex;
  flex-direction: column;
  flex-shrink: 0;
}

.kb-list-header {
  padding: 16px;
  border-bottom: 1px solid #f3f4f6;
}

.search-input-wrap {
  margin-bottom: 12px;
}

.new-kb-btn {
  width: 100%;
  background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
  color: white;
  border: none;
  border-radius: 8px;
  padding: 12px 16px;
  font-weight: 500;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  transition: all 0.2s;
  
  &:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
  }
}

.kb-list {
  flex: 1;
  overflow-y: auto;
  padding: 8px;
}

.kb-item {
  display: flex;
  align-items: center;
  padding: 12px;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
  margin-bottom: 4px;
  
  &:hover {
    background: #f8fafc;
  }
  
  &.active {
    background: #eff6ff;
    border: 1px solid #dbeafe;
  }
}

.kb-item-content {
  flex: 1;
  min-width: 0;
}

.kb-title {
  font-weight: 500;
  color: #111827;
  font-size: 14px;
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.kb-desc {
  color: #6b7280;
  font-size: 12px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  margin-bottom: 4px;
}

.kb-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 11px;
  color: #9ca3af;
}

.kb-item-actions {
  opacity: 0;
  transition: opacity 0.2s;
}

.kb-item:hover .kb-item-actions {
  opacity: 1;
}

.kb-more-btn {
  padding: 4px;
  color: #6b7280;
  
  &:hover {
    color: #374151;
    background: #f3f4f6;
  }
}

/* 中间搜索结果区域 */
.search-results-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  background: #ffffff;
  border-right: 1px solid #e5e7eb;
}

.search-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px 20px;
  border-bottom: 1px solid #f3f4f6;
  background: #fafbfc;
}

.search-input-container {
  flex: 1;
}

.search-actions {
  display: flex;
  gap: 8px;
}

.filter-panel {
  padding: 16px 20px;
  background: #f8fafc;
  border-bottom: 1px solid #e5e7eb;
}

.filter-row {
  display: flex;
  align-items: center;
  gap: 16px;
}

.filter-item {
  display: flex;
  align-items: center;
  gap: 8px;
  
  label {
    font-size: 14px;
    color: #374151;
    white-space: nowrap;
  }
}

.search-results {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
}

.search-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: #6b7280;
  font-size: 14px;
  
  .el-icon {
    margin-right: 8px;
    font-size: 16px;
  }
}

.no-results,
.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  text-align: center;
}

.no-results-icon,
.empty-icon {
  font-size: 64px;
  margin-bottom: 16px;
}

.no-results-title,
.empty-title {
  font-size: 20px;
  font-weight: 600;
  color: #111827;
  margin-bottom: 8px;
}

.no-results-subtitle,
.empty-subtitle {
  color: #6b7280;
  margin-bottom: 32px;
}

.results-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.result-item {
  padding: 16px;
  background: #ffffff;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    border-color: #dbeafe;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transform: translateY(-1px);
  }
}

.result-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 8px;
}

.result-title {
  font-size: 16px;
  font-weight: 600;
  color: #111827;
  flex: 1;
  margin-right: 12px;
}

.result-type {
  flex-shrink: 0;
}

.result-content {
  margin-bottom: 12px;
}

.result-summary {
  color: #6b7280;
  font-size: 14px;
  line-height: 1.6;
  margin-bottom: 8px;
}

.result-highlights {
  .highlight-item {
    background: #fef3c7;
    padding: 2px 4px;
    border-radius: 4px;
    margin: 2px 0;
    font-size: 13px;
    
    :deep(mark) {
      background: #fbbf24;
      color: #92400e;
      padding: 1px 2px;
      border-radius: 2px;
    }
  }
}

.result-meta {
  display: flex;
  align-items: center;
  gap: 16px;
  font-size: 12px;
  color: #9ca3af;
}

.result-source {
  display: flex;
  align-items: center;
  gap: 4px;
}

.result-score {
  display: flex;
  align-items: center;
  gap: 4px;
  color: #f59e0b;
}

/* 右侧AI对话区域 - 与AI对话页面完全一致 */
.chat-sidebar {
  width: 320px;
  background: #ffffff;
  display: flex;
  flex-direction: column;
  flex-shrink: 0;
}

.chat-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 1px solid #f3f4f6;
  background: #fafbfc;
}

.chat-title-header {
  font-size: 16px;
  font-weight: 600;
  color: #111827;
}

.chat-actions {
  display: flex;
  gap: 8px;
}

.messages-container {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
  background: #ffffff;
}

.empty-chat-message {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  text-align: center;
}

.empty-icon {
  font-size: 48px;
  margin-bottom: 16px;
}

.empty-title {
  font-size: 18px;
  font-weight: 600;
  color: #111827;
  margin-bottom: 8px;
}

.empty-subtitle {
  color: #6b7280;
  font-size: 14px;
}

.message-item {
  display: flex;
  margin-bottom: 16px;
  gap: 8px;
  
  &.user {
    flex-direction: row-reverse;
    
    .message-content {
      background: #eff6ff;
      border: 1px solid #dbeafe;
    }
  }
  
  &.assistant {
    .message-content {
      background: #ffffff;
      border: 1px solid #e5e7eb;
    }
  }
}

.message-avatar {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  
  .user-avatar {
    background: #3b82f6;
    color: white;
  }
  
  .ai-avatar {
    background: #10b981;
    color: white;
  }
}

.message-content {
  max-width: 80%;
  padding: 8px 12px;
  border-radius: 8px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.message-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 4px;
}

.message-role {
  font-size: 11px;
  font-weight: 500;
  color: #6b7280;
}

.message-time {
  font-size: 10px;
  color: #9ca3af;
}

.message-body {
  line-height: 1.5;
  color: #374151;
  font-size: 13px;
}

.text-content {
  white-space: pre-wrap;
  word-break: break-word;
}

.markdown-content {
  :deep(h1), :deep(h2), :deep(h3) {
    margin: 8px 0 4px 0;
    color: #111827;
    font-size: 14px;
  }
  
  :deep(p) {
    margin: 4px 0;
  }
  
  :deep(code) {
    background: #f3f4f6;
    padding: 1px 3px;
    border-radius: 3px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 12px;
  }
  
  :deep(ul), :deep(ol) {
    margin: 4px 0;
    padding-left: 16px;
  }
  
  :deep(li) {
    margin: 2px 0;
  }
}

.code-content {
  background: #1f2937;
  border-radius: 6px;
  overflow: hidden;
  margin: 4px 0;
}

.code-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 6px 8px;
  background: #374151;
  border-bottom: 1px solid #4b5563;
}

.code-language {
  color: #d1d5db;
  font-size: 10px;
  font-weight: 500;
}

.code-content pre {
  margin: 0;
  padding: 12px;
  overflow-x: auto;
  background: #1f2937;
  
  code {
    color: #f9fafb;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 12px;
    line-height: 1.4;
  }
}

.streaming-indicator {
  display: flex;
  align-items: center;
  gap: 6px;
  color: #6b7280;
  font-size: 12px;
  font-style: italic;
}

.input-area {
  padding: 16px;
  background: #fafbfc;
  border-top: 1px solid #f3f4f6;
}

.input-container {
  display: flex;
  align-items: flex-end;
  gap: 8px;
  background: #ffffff;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 8px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.input-actions {
  display: flex;
  gap: 4px;
  margin-bottom: 6px;
}

.message-input {
  flex: 1;
  
  :deep(.el-textarea__inner) {
    border: none;
    box-shadow: none;
    resize: none;
    font-size: 13px;
    line-height: 1.4;
    
    &:focus {
      box-shadow: none;
    }
  }
}

.send-button {
  width: 32px;
  height: 32px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.input-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: 6px;
}

.input-tip {
  font-size: 11px;
  color: #9ca3af;
}

/* 响应式设计 */
@media (max-width: 1200px) {
  .chat-sidebar {
    width: 280px;
  }
}

@media (max-width: 768px) {
  .knowledge-base-container {
    flex-direction: column;
  }
  
  .kb-list-sidebar {
    width: 100%;
    height: 200px;
    border-right: none;
    border-bottom: 1px solid #e5e7eb;
  }
  
  .search-results-area {
    height: calc(100vh - 200px - 300px);
  }
  
  .chat-sidebar {
    width: 100%;
    height: 300px;
    border-top: 1px solid #e5e7eb;
  }
  
  .result-item {
    padding: 12px;
  }
  
  .message-content {
    max-width: 85%;
  }
}
</style>
```

## ⚠️ 重要注意事项

1. **三栏布局**：左侧知识库列表 + 中间搜索结果 + 右侧AI对话
2. **AI对话一致性**：右侧对话区域与AI对话页面完全一致，包括：
   - 消息显示格式
   - 流式响应效果
   - 代码高亮
   - Markdown渲染
   - 输入交互
3. **知识库搜索**：支持实时搜索、筛选、分页
4. **文档关联**：点击搜索结果可直接发送到AI对话
5. **响应式设计**：移动端适配，支持三栏变单栏布局
6. **国际化支持**：所有文本使用$t()函数
7. **Mock数据**：包含TODO注释，便于后端集成

**最终要求：生成的代码必须与原型图的视觉效果和交互逻辑完全一致，特别是AI对话部分要与AI对话页面保持完全一致！**
