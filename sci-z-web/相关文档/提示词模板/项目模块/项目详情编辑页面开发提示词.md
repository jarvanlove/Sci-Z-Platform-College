# 项目详情/编辑页面开发提示词

## 📋 页面信息
- **原型图路径**：`原型图/项目模块/项目详情.html`
- **页面类型**：详情页面/编辑页面
- **页面名称**：项目详情/项目编辑
- **主要功能**：项目信息展示/编辑、成员管理、里程碑管理、文档管理
- **对应文件路径**：`src/views/Project/Detail.vue`

## 🎨 原型图视觉分析

### **整体布局**
- 背景色：`#f7f9fc`
- 容器：`padding: 20px`，`min-height: calc(100vh - 56px)`
- 页面标题：`font-size: 24px`，`color: #1e3a8a`，`font-weight: 600`

### **卡片设计**
- 白色卡片：`background: #ffffff`，`border-radius: 8px`，`padding: 20px`
- 阴影效果：`box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04)`
- 边框：`border: 1px solid #e5e7eb`
- 卡片头部：`border-bottom: 1px solid #e5e7eb`，`padding-bottom: 12px`

### **信息展示设计**
- 网格布局：`grid-template-columns: 1fr 1fr`，`gap: 16px`
- 信息项：`display: flex`，`flex-direction: column`，`gap: 4px`
- 标签：`color: #6b7280`，`font-weight: 500`
- 值：`color: #374151`

### **成员管理设计**
- 成员项：`background: #f8fafc`，`border-radius: 6px`，`padding: 12px`
- 头像：`width: 40px`，`height: 40px`，`border-radius: 50%`
- 搜索区域：`border: 1px solid #e5e7eb`，`border-radius: 6px`

### **里程碑管理设计**
- 里程碑项：`border: 1px solid #e5e7eb`，`border-radius: 6px`，`padding: 16px`
- 文档上传：`border: 2px dashed #d1d5db`，`border-radius: 6px`

## 🔧 技术实现要求

### 1. 页面结构
```vue
<template>
  <div class="project-detail-container">
    <!-- 页面头部 -->
    <div class="page-header">
      <div class="header-left">
        <el-button @click="handleBack">
          <el-icon><ArrowLeft /></el-icon>
          {{ $t('common.back') }}
        </el-button>
        <h1 class="page-title">
          {{ isEditMode ? $t('project.detail.editTitle') : $t('project.detail.title') }}
        </h1>
      </div>
    </div>

    <!-- 加载状态 -->
    <div v-if="loading" class="loading-container">
      <el-icon class="is-loading"><Loading /></el-icon>
      <span>{{ $t('common.loading') }}</span>
    </div>

    <!-- 主要内容 -->
    <div v-else class="main-content-single">
      <!-- 基本信息 -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">{{ $t('project.detail.basicInfo') }}</h2>
        </div>
        <div class="info-grid">
          <!-- 项目编号、项目名称 -->
          <div class="info-item">
            <span class="info-label">{{ $t('project.detail.number') }}</span>
            <span class="info-value">{{ project.number }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">{{ $t('project.detail.name') }}</span>
            <template v-if="isEditMode">
              <el-input
                v-model="project.name"
                :placeholder="$t('project.detail.namePlaceholder')"
                maxlength="100"
                show-word-limit
              />
            </template>
            <template v-else>
              <span class="info-value">{{ project.name }}</span>
            </template>
          </div>

          <!-- 项目负责人、项目状态 -->
          <div class="info-item">
            <span class="info-label">{{ $t('project.detail.manager') }}</span>
            <template v-if="isEditMode">
              <el-input
                v-model="project.manager"
                :placeholder="$t('project.detail.managerPlaceholder')"
              />
            </template>
            <template v-else>
              <span class="info-value">{{ project.manager }}</span>
            </template>
          </div>
          <div class="info-item">
            <span class="info-label">{{ $t('project.detail.status') }}</span>
            <template v-if="isEditMode">
              <el-select v-model="project.status" :placeholder="$t('project.detail.statusPlaceholder')">
                <el-option
                  v-for="option in statusOptions"
                  :key="option.value"
                  :label="option.label"
                  :value="option.value"
                />
              </el-select>
            </template>
            <template v-else>
              <el-tag :type="getStatusTagType(project.status)" size="small" round>
                {{ getStatusText(project.status) }}
              </el-tag>
            </template>
          </div>

          <!-- 课题发布部门、研究方向 -->
          <div class="info-item">
            <span class="info-label">{{ $t('project.detail.department') }}</span>
            <template v-if="isEditMode">
              <el-input
                v-model="project.department"
                :placeholder="$t('project.detail.departmentPlaceholder')"
              />
            </template>
            <template v-else>
              <span class="info-value">{{ project.department || $t('common.none') }}</span>
            </template>
          </div>
          <div class="info-item">
            <span class="info-label">{{ $t('project.detail.researchDirection') }}</span>
            <template v-if="isEditMode">
              <el-input
                v-model="project.researchDirection"
                :placeholder="$t('project.detail.researchDirectionPlaceholder')"
              />
            </template>
            <template v-else>
              <span class="info-value">{{ project.researchDirection || $t('common.none') }}</span>
            </template>
          </div>

          <!-- 项目开始时间、项目结束时间 -->
          <div class="info-item">
            <span class="info-label">{{ $t('project.detail.startTime') }}</span>
            <template v-if="isEditMode">
              <el-date-picker
                v-model="project.createTime"
                type="date"
                :placeholder="$t('project.detail.startTimePlaceholder')"
                format="YYYY-MM-DD"
                value-format="YYYY-MM-DD"
                style="width: 100%"
              />
            </template>
            <template v-else>
              <span class="info-value">{{ project.createTime }}</span>
            </template>
          </div>
          <div class="info-item">
            <span class="info-label">{{ $t('project.detail.endTime') }}</span>
            <template v-if="isEditMode">
              <el-date-picker
                v-model="project.updateTime"
                type="date"
                :placeholder="$t('project.detail.endTimePlaceholder')"
                format="YYYY-MM-DD"
                value-format="YYYY-MM-DD"
                style="width: 100%"
              />
            </template>
            <template v-else>
              <span class="info-value">{{ project.updateTime }}</span>
            </template>
          </div>

          <!-- 项目预算 -->
          <div class="info-item">
            <span class="info-label">{{ $t('project.detail.budget') }}</span>
            <template v-if="isEditMode">
              <el-input-number
                v-model="project.budget"
                :min="0"
                :precision="2"
                :placeholder="$t('project.detail.budgetPlaceholder')"
                style="width: 100%"
              />
              <span class="budget-unit">{{ $t('common.yuan') }}</span>
            </template>
            <template v-else>
              <span class="info-value">{{ Number(project.budget || 0).toFixed(2) }} {{ $t('common.yuan') }}</span>
            </template>
          </div>
        </div>

        <!-- 项目描述 -->
        <div class="info-item" style="margin-top: 16px">
          <span class="info-label">{{ $t('project.detail.description') }}</span>
          <template v-if="isEditMode">
            <el-input
              type="textarea"
              :rows="4"
              v-model="project.description"
              :placeholder="$t('project.detail.descriptionPlaceholder')"
              maxlength="500"
              show-word-limit
            />
          </template>
          <template v-else>
            <span class="info-value">{{ project.description }}</span>
          </template>
        </div>
      </div>

      <!-- 成员管理 -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">{{ $t('project.detail.members') }}</h2>
          <el-button
            v-if="isEditMode"
            type="primary"
            size="small"
            @click="openMemberDialog"
          >
            <el-icon><Plus /></el-icon>
            {{ $t('project.detail.addMember') }}
          </el-button>
        </div>

        <!-- 已选成员列表 -->
        <div v-if="members.length > 0" class="member-list">
          <div v-for="member in members" :key="member.id" class="member-item">
            <div class="member-avatar">
              {{ member.name.charAt(0) }}
            </div>
            <div class="member-info">
              <div class="member-name">{{ member.name }}</div>
              <div class="member-role">
                {{ getRoleText(member.role) }} · {{ $t('project.detail.joinTime') }}: {{ member.joinTime }}
              </div>
            </div>
            <el-button
              v-if="isEditMode"
              type="danger"
              size="small"
              @click="handleRemoveMember(member.id)"
            >
              {{ $t('common.remove') }}
            </el-button>
          </div>
        </div>

        <div v-else class="empty-state">
          <div class="empty-state-icon">👥</div>
          <div class="empty-state-text">{{ $t('project.detail.noMembers') }}</div>
          <div class="empty-state-hint">{{ $t('project.detail.addMemberHint') }}</div>
        </div>
      </div>

      <!-- 添加成员对话框 -->
      <el-dialog
        v-model="showMemberDialog"
        :title="$t('project.detail.addMember')"
        width="600px"
        :close-on-click-modal="false"
      >
        <el-input
          v-model="memberSearchKeyword"
          :placeholder="$t('project.detail.searchMemberPlaceholder')"
          clearable
          @keyup.enter="handleMemberSearch"
          @input="handleMemberSearch"
        >
          <template #prefix>
            <el-icon><Search /></el-icon>
          </template>
        </el-input>
        <div v-if="memberSearchResults.length > 0" class="search-results">
          <div v-for="user in memberSearchResults" :key="user.id" class="search-result-item">
            <div class="search-result-info">
              <div class="search-result-avatar">
                {{ user.name.charAt(0) }}
              </div>
              <div class="search-result-details">
                <div class="search-result-name">{{ user.name }}</div>
              </div>
            </div>
            <el-button
              type="primary"
              size="small"
              :disabled="members.some(m => m.id === user.id)"
              @click="handleAddMember(user)"
            >
              {{ members.some(m => m.id === user.id) ? $t('common.added') : $t('common.add') }}
            </el-button>
          </div>
        </div>
        <div v-else class="empty-state">
          <div class="empty-state-text">{{ $t('project.detail.searchHint') }}</div>
        </div>
        <template #footer>
          <el-button @click="closeMemberDialog">{{ $t('common.close') }}</el-button>
        </template>
      </el-dialog>

      <!-- 项目里程碑 -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">{{ $t('project.detail.milestones') }}</h2>
          <el-button
            v-if="isEditMode"
            type="primary"
            size="small"
            @click="openMilestoneDialog"
          >
            <el-icon><Plus /></el-icon>
            {{ $t('project.detail.addMilestone') }}
          </el-button>
        </div>

        <!-- 里程碑列表 -->
        <div v-if="milestones.length > 0" class="milestone-list">
          <div v-for="(milestone, index) in milestones" :key="index" class="milestone-item">
            <div class="milestone-header">
              <span class="milestone-title">{{ $t('project.detail.milestone') }} {{ index + 1 }}</span>
              <el-button
                v-if="isEditMode"
                type="danger"
                size="small"
                @click="handleRemoveMilestone(index)"
              >
                {{ $t('common.delete') }}
              </el-button>
            </div>
            
            <div class="milestone-form">
              <el-form-item :label="$t('project.detail.milestoneName')">
                <el-input
                  v-model="milestone.name"
                  :placeholder="$t('project.detail.milestoneNamePlaceholder')"
                  :disabled="!isEditMode"
                />
              </el-form-item>
              
              <div class="form-row">
                <el-form-item :label="$t('project.detail.startTime')">
                  <el-date-picker
                    v-model="milestone.startTime"
                    type="date"
                    :placeholder="$t('project.detail.selectStartTime')"
                    style="width: 100%"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    :disabled="!isEditMode"
                  />
                </el-form-item>
                
                <el-form-item :label="$t('project.detail.endTime')">
                  <el-date-picker
                    v-model="milestone.endTime"
                    type="date"
                    :placeholder="$t('project.detail.selectEndTime')"
                    style="width: 100%"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    :disabled="!isEditMode"
                  />
                </el-form-item>
              </div>
              
              <el-form-item :label="$t('project.detail.description')">
                <el-input
                  v-model="milestone.description"
                  type="textarea"
                  :rows="2"
                  :placeholder="$t('project.detail.milestoneDescriptionPlaceholder')"
                  :disabled="!isEditMode"
                />
              </el-form-item>
            </div>

            <!-- 里程碑文档管理 -->
            <div class="milestone-documents">
              <div class="milestone-documents-header">
                <h4>{{ $t('project.detail.milestoneDocuments') }}</h4>
              </div>

              <!-- 文档列表 -->
              <div v-if="milestone.documents && milestone.documents.length > 0" class="document-list">
                <div v-for="doc in milestone.documents" :key="doc.id" class="document-item">
                  <div class="document-icon">📄</div>
                  <div class="document-info">
                    <div class="document-name">{{ doc.name }}</div>
                    <div class="document-meta">
                      {{ doc.type }} · {{ doc.uploader }} · {{ doc.uploadTime }} · {{ doc.size }}
                    </div>
                  </div>
                  <div class="document-actions">
                    <el-button size="small" @click="handlePreview(doc.id)">
                      {{ $t('common.preview') }}
                    </el-button>
                    <el-button size="small" @click="handleDownload(doc.id)">
                      {{ $t('common.download') }}
                    </el-button>
                    <el-button
                      v-if="isEditMode"
                      size="small"
                      type="danger"
                      @click="handleDeleteMilestoneDoc(index, doc.id)"
                    >
                      {{ $t('common.delete') }}
                    </el-button>
                  </div>
                </div>
              </div>

              <div v-else class="empty-state">
                <div class="empty-state-icon">📄</div>
                <div class="empty-state-text">{{ $t('project.detail.noDocuments') }}</div>
                <div class="empty-state-hint">{{ $t('project.detail.uploadDocumentsHint') }}</div>
              </div>

              <!-- 上传区域 -->
              <div v-if="isEditMode" class="upload-section">
                <div
                  class="upload-area"
                  @click="triggerMilestoneUpload(index)"
                  @dragover.prevent="handleMilestoneDragOver(index)"
                  @dragleave.prevent="handleMilestoneDragLeave(index)"
                  @drop.prevent="handleMilestoneDrop($event, index)"
                  :class="{ dragover: milestonesDragOver[index] }"
                >
                  <div class="upload-icon">
                    <el-icon><Upload /></el-icon>
                  </div>
                  <div class="upload-text">{{ $t('project.detail.uploadText') }}</div>
                  <div class="upload-hint">{{ $t('project.detail.uploadHint') }}</div>
                </div>
                <input
                  :id="`milestoneFileInput${index}`"
                  type="file"
                  multiple
                  style="display: none"
                  @change="handleMilestoneFileSelect($event, index)"
                  accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.md,.rtf,.jpg,.jpeg,.png,.gif,.bmp,.svg,.webp,.zip,.rar,.7z,.tar,.gz,.mp4,.avi,.mov,.wmv,.flv,.mp3,.wav,.flac,.aac"
                />
              </div>
            </div>
          </div>
        </div>

        <!-- 空状态 -->
        <div v-else class="empty-state">
          <div class="empty-state-icon">🎯</div>
          <div class="empty-state-text">{{ $t('project.detail.noMilestones') }}</div>
          <div class="empty-state-hint">{{ $t('project.detail.addMilestoneHint') }}</div>
        </div>
      </div>

      <!-- 新增里程碑对话框 -->
      <el-dialog
        v-model="showMilestoneDialog"
        :title="$t('project.detail.addMilestone')"
        width="700px"
        :close-on-click-modal="false"
      >
        <el-form ref="milestoneFormRef" :model="milestoneDraft" :rules="milestoneRules" label-width="120px">
          <el-form-item :label="$t('project.detail.milestoneName')" prop="name">
            <el-select
              v-model="milestoneDraft.name"
              :placeholder="$t('project.detail.selectMilestoneName')"
              style="width: 100%"
            >
              <el-option
                v-for="opt in milestoneOptions"
                :key="opt"
                :label="opt"
                :value="opt"
                :disabled="addedMilestoneNames && addedMilestoneNames.includes(opt)"
              />
            </el-select>
          </el-form-item>
          
          <div class="form-row">
            <el-form-item :label="$t('project.detail.startTime')" prop="startTime">
              <el-date-picker
                v-model="milestoneDraft.startTime"
                type="date"
                :placeholder="$t('project.detail.selectStartTime')"
                style="width: 100%"
                format="YYYY-MM-DD"
                value-format="YYYY-MM-DD"
              />
            </el-form-item>
            
            <el-form-item :label="$t('project.detail.endTime')" prop="endTime">
              <el-date-picker
                v-model="milestoneDraft.endTime"
                type="date"
                :placeholder="$t('project.detail.selectEndTime')"
                style="width: 100%"
                format="YYYY-MM-DD"
                value-format="YYYY-MM-DD"
              />
            </el-form-item>
          </div>
          
          <el-form-item :label="$t('project.detail.description')" prop="description">
            <el-input
              v-model="milestoneDraft.description"
              type="textarea"
              :rows="2"
              :placeholder="$t('project.detail.milestoneDescriptionPlaceholder')"
            />
          </el-form-item>
        </el-form>
        
        <template #footer>
          <el-button @click="closeMilestoneDialog">{{ $t('common.cancel') }}</el-button>
          <el-button type="primary" @click="confirmAddMilestone">
            {{ $t('common.confirm') }}
          </el-button>
        </template>
      </el-dialog>
    </div>

    <!-- 操作按钮 -->
    <div v-if="isEditMode" class="footer-actions">
      <el-button @click="handleCancel">{{ $t('common.cancel') }}</el-button>
      <el-button type="primary" :loading="saving" @click="handleSave">
        <el-icon><Check /></el-icon>
        {{ $t('project.detail.save') }}
      </el-button>
    </div>
  </div>
</template>
```

### 2. 核心功能实现
```javascript
<script setup>
import { ref, reactive, onMounted, computed, nextTick } from 'vue'
import { useRouter, useRoute } from 'vue-router'
import { useI18n } from 'vue-i18n'
import { ElMessage, ElMessageBox } from 'element-plus'
import { ArrowLeft, Loading, Plus, Search, Upload, Check } from '@element-plus/icons-vue'
import { formatDate } from '@/utils/date'
import { PROJECT_STATUS, PROJECT_STATUS_CONFIG, MILESTONE_OPTIONS } from '@/utils/constants'
import { formatFileSize, checkFileType, checkFileSize } from '@/utils/file'
import { validateProjectName, validateBudget, validateChineseName } from '@/utils/validate'
import { createLogger } from '@/utils/simpleLogger'

const router = useRouter()
const route = useRoute()
const { t } = useI18n()
const logger = createLogger('ProjectDetailEdit')

// 响应式数据
const loading = ref(false)
const saving = ref(false)
const isEditMode = ref(false)
const formRef = ref()
const milestoneFormRef = ref()

const project = ref({
  id: 0,
  number: '',
  name: '',
  description: '',
  manager: '',
  status: 'progress',
  createTime: '',
  updateTime: '',
  budget: 0,
  department: '',
  researchDirection: ''
})

const members = ref([])
const milestones = ref([])

// 表单验证规则
const formRules = reactive({
  name: [
    { required: true, message: t('project.nameRequired'), trigger: 'blur' },
    { 
      validator: (rule, value, callback) => {
        if (!validateProjectName(value)) {
          callback(new Error(t('project.nameFormat')))
        } else {
          callback()
        }
      }, 
      trigger: 'blur' 
    }
  ],
  manager: [
    { required: true, message: t('project.leaderRequired'), trigger: 'blur' },
    { 
      validator: (rule, value, callback) => {
        if (!validateChineseName(value)) {
          callback(new Error(t('project.leaderFormat')))
        } else {
          callback()
        }
      }, 
      trigger: 'blur' 
    }
  ],
  status: [
    { required: true, message: t('project.statusRequired'), trigger: 'change' }
  ],
  createTime: [
    { required: true, message: t('project.startTimeRequired'), trigger: 'change' }
  ],
  updateTime: [
    { required: true, message: t('project.endTimeRequired'), trigger: 'change' }
  ],
  budget: [
    { required: true, message: t('project.budgetRequired'), trigger: 'blur' },
    { 
      validator: (rule, value, callback) => {
        if (!validateBudget(value)) {
          callback(new Error(t('project.budgetFormat')))
        } else {
          callback()
        }
      }, 
      trigger: 'blur' 
    }
  ]
})

const milestoneRules = reactive({
  name: [
    { required: true, message: t('project.milestoneNameRequired'), trigger: 'blur' }
  ],
  startTime: [
    { required: true, message: t('project.milestoneStartTimeRequired'), trigger: 'change' }
  ],
  endTime: [
    { required: true, message: t('project.milestoneEndTimeRequired'), trigger: 'change' }
  ]
})

// 状态选项（从constants.js导入的项目状态常量生成）
const statusOptions = ref([
  { label: PROJECT_STATUS_CONFIG[PROJECT_STATUS.PLANNED].text, value: PROJECT_STATUS.PLANNED },
  { label: PROJECT_STATUS_CONFIG[PROJECT_STATUS.PROGRESS].text, value: PROJECT_STATUS.PROGRESS },
  { label: PROJECT_STATUS_CONFIG[PROJECT_STATUS.COMPLETED].text, value: PROJECT_STATUS.COMPLETED },
  { label: PROJECT_STATUS_CONFIG[PROJECT_STATUS.DELAYED].text, value: PROJECT_STATUS.DELAYED }
])

// 成员对话框相关
const showMemberDialog = ref(false)
const memberSearchKeyword = ref('')
const memberSearchResults = ref([])

// 里程碑对话框相关
const showMilestoneDialog = ref(false)
const milestoneDraft = ref({
  name: '',
  startTime: '',
  endTime: '',
  description: ''
})

// 里程碑选项（从constants.js导入）
const milestoneOptions = ref(MILESTONE_OPTIONS)

const addedMilestoneNames = computed(() => {
  if (!milestones.value || !Array.isArray(milestones.value)) {
    return []
  }
  return milestones.value
    .map(m => m.name)
    .filter(name => name && name.trim())
})

// 里程碑拖拽状态管理
const milestonesDragOver = ref({})

// 模拟数据
const mockProject = {
  id: 1,
  number: 'PRJ-2024-001',
  name: '基于人工智能的智能诊断系统研究',
  description: '本项目旨在开发一套基于深度学习的智能诊断系统，能够自动分析医学影像数据，为医生提供辅助诊断建议。',
  manager: '张教授',
  department: '科委',
  researchDirection: '基于深度学习的智能制造关键技术研究',
  status: 'progress',
  createTime: '2024-01-15',
  updateTime: '2024-01-20',
  budget: 120000
}

const mockMembers = [
  {
    id: 1,
    name: '张教授',
    role: 'manager',
    joinTime: '2024-01-15'
  },
  {
    id: 2,
    name: '李博士',
    role: 'core',
    joinTime: '2024-01-16'
  },
  {
    id: 3,
    name: '王硕士',
    role: 'member',
    joinTime: '2024-01-18'
  }
]

const mockMilestones = [
  {
    name: '项目启动',
    description: '项目启动阶段',
    startTime: '2024-01-15',
    endTime: '2024-01-20',
    documents: [
      {
        id: 1,
        name: '项目启动会议纪要.pdf',
        type: 'PDF',
        uploader: '张教授',
        uploadTime: '2024-01-15',
        size: '1.2MB'
      }
    ]
  }
]

const userList = [
  { id: '1', name: '张教授' },
  { id: '2', name: '李博士' },
  { id: '3', name: '王教授' },
  { id: '4', name: '赵博士' },
  { id: '5', name: '陈教授' }
]

// 获取状态文本（使用constants.js的配置）
const getStatusText = (status) => {
  return PROJECT_STATUS_CONFIG[status]?.text || status
}

// 获取状态标签类型（使用constants.js的配置）
const getStatusTagType = (status) => {
  return PROJECT_STATUS_CONFIG[status]?.type || 'info'
}

// 获取角色文本
const getRoleText = (role) => {
  const roleMap = {
    manager: '项目负责人',
    core: '核心成员',
    member: '普通成员'
  }
  return roleMap[role] || '普通成员'
}

// 解析URL参数
const getQueryParam = (key) => {
  const params = new URLSearchParams(window.location.search)
  return params.get(key)
}

const resolveMode = () => {
  const qs = getQueryParam('mode')
  if (qs === 'edit' || qs === 'view') return qs
  return 'view'
}

// 加载项目详情（通过接口获取）
const loadProjectDetail = async () => {
  loading.value = true
  try {
    logger.info('Loading project detail', { projectId: route.params.id })
    
    // TODO: 替换为实际后端接口
    // const response = await getProjectDetail(route.params.id)
    // const data = response.data
    // project.value = {
    //   id: data.id,
    //   number: data.number,
    //   name: data.name,
    //   description: data.description,
    //   manager: data.manager,
    //   status: data.status,
    //   createTime: data.createTime,
    //   updateTime: data.updateTime,
    //   budget: data.budget,
    //   department: data.department,
    //   researchDirection: data.researchDirection
    // }
    // members.value = data.members || []
    // milestones.value = data.milestones || []
    
    // 临时模拟数据（后端开发完成后删除）
    await new Promise(resolve => setTimeout(resolve, 1000))
    project.value = { ...mockProject }
    members.value = [...mockMembers]
    milestones.value = [...mockMilestones]
    
    // 设置模式
    const mode = resolveMode()
    isEditMode.value = mode === 'edit'
    
    logger.info('Project detail loaded successfully', { 
      projectId: route.params.id, 
      mode: isEditMode.value ? 'edit' : 'view' 
    })
  } catch (error) {
    logger.error('Failed to load project detail', error)
    ElMessage.error(t('project.detail.loadError'))
  } finally {
    loading.value = false
  }
}

// 返回列表
const handleBack = () => {
  router.push('/project/list')
}

// 取消编辑
const handleCancel = () => {
  ElMessageBox.confirm(
    t('project.detail.cancelConfirm'),
    t('project.detail.cancelTitle'),
    {
      confirmButtonText: t('common.confirm'),
      cancelButtonText: t('project.detail.continueEdit'),
      type: 'warning'
    }
  ).then(() => {
    handleBack()
  }).catch(() => {
    // 用户选择继续编辑
  })
}

// 保存项目
const handleSave = async () => {
  try {
    // 表单验证
    if (isEditMode.value && formRef.value) {
      await formRef.value.validate()
    }
    
    // 验证里程碑时间
    for (let i = 0; i < milestones.value.length; i++) {
      const milestone = milestones.value[i]
      if (milestone.startTime && milestone.endTime) {
        if (new Date(milestone.startTime) >= new Date(milestone.endTime)) {
          ElMessage.error(t('project.milestoneTimeError', { index: i + 1 }))
          return
        }
      }
    }
    
    saving.value = true
    logger.info('Saving project', { projectId: project.value.id, isEdit: isEditMode.value })
    
    // TODO: 替换为实际后端接口
    // if (isEditMode.value) {
    //   await updateProject(project.value.id, {
    //     name: project.value.name,
    //     description: project.value.description,
    //     manager: project.value.manager,
    //     status: project.value.status,
    //     createTime: project.value.createTime,
    //     updateTime: project.value.updateTime,
    //     budget: project.value.budget,
    //     department: project.value.department,
    //     researchDirection: project.value.researchDirection,
    //     members: members.value,
    //     milestones: milestones.value
    //   })
    // } else {
    //   await createProject({
    //     name: project.value.name,
    //     description: project.value.description,
    //     manager: project.value.manager,
    //     status: project.value.status,
    //     createTime: project.value.createTime,
    //     updateTime: project.value.updateTime,
    //     budget: project.value.budget,
    //     department: project.value.department,
    //     researchDirection: project.value.researchDirection,
    //     members: members.value,
    //     milestones: milestones.value
    //   })
    // }
    
    // 临时模拟API调用
    await new Promise(resolve => setTimeout(resolve, 1000))
    
    ElMessage.success(t('project.detail.saveSuccess'))
    logger.info('Project saved successfully', { projectId: project.value.id })
    handleBack()
  } catch (error) {
    if (error !== 'cancel') {
      logger.error('Failed to save project', error)
      ElMessage.error(t('project.detail.saveError'))
    }
  } finally {
    saving.value = false
  }
}

// 成员管理
const openMemberDialog = () => {
  memberSearchKeyword.value = ''
  memberSearchResults.value = []
  showMemberDialog.value = true
}

const closeMemberDialog = () => {
  showMemberDialog.value = false
}

const handleMemberSearch = () => {
  if (!memberSearchKeyword.value.trim()) {
    memberSearchResults.value = []
    return
  }
  
  const keyword = memberSearchKeyword.value.toLowerCase()
  memberSearchResults.value = userList.filter(
    user => user.name.toLowerCase().includes(keyword) ||
            user.id.toLowerCase().includes(keyword)
  )
}

const handleAddMember = (user) => {
  const isAlreadyMember = members.value.some(member => member.id === user.id)
  if (isAlreadyMember) {
    ElMessage.warning(t('project.detail.memberAlreadyExists'))
    return
  }
  
  const newMember = {
    id: user.id,
    name: user.name,
    role: 'member',
    joinTime: new Date().toISOString().split('T')[0]
  }
  
  members.value.push(newMember)
  ElMessage.success(t('project.detail.memberAddedSuccess', { name: user.name }))
  
  memberSearchKeyword.value = ''
  memberSearchResults.value = []
  
  setTimeout(() => {
    showMemberDialog.value = false
  }, 1000)
}

const handleRemoveMember = async (memberId) => {
  const member = members.value.find(m => m.id === memberId)
  if (!member) return
  
  try {
    await ElMessageBox.confirm(
      t('project.detail.removeMemberConfirm', { name: member.name }),
      t('project.detail.removeMemberTitle'),
      {
        confirmButtonText: t('common.confirm'),
        cancelButtonText: t('common.cancel'),
        type: 'warning'
      }
    )
    
    const index = members.value.findIndex(m => m.id === memberId)
    if (index > -1) {
      members.value.splice(index, 1)
      ElMessage.success(t('project.detail.memberRemovedSuccess', { name: member.name }))
    }
  } catch (error) {
    // 用户取消操作
  }
}

// 里程碑管理
const openMilestoneDialog = () => {
  milestoneDraft.value = {
    name: '',
    startTime: '',
    endTime: '',
    description: ''
  }
  showMilestoneDialog.value = true
}

const closeMilestoneDialog = () => {
  showMilestoneDialog.value = false
}

const confirmAddMilestone = async () => {
  try {
    await milestoneFormRef.value.validate()
    
    const d = milestoneDraft.value
    if (addedMilestoneNames.value.includes(d.name.trim())) {
      ElMessage.warning(t('project.detail.milestoneAlreadyExists'))
      return
    }
    if (new Date(d.startTime) >= new Date(d.endTime)) {
      ElMessage.warning(t('project.detail.milestoneTimeInvalid'))
      return
    }
    
    milestones.value.push({
      name: d.name.trim(),
      startTime: d.startTime,
      endTime: d.endTime,
      description: d.description || '',
      documents: []
    })
    
    showMilestoneDialog.value = false
    ElMessage.success(t('project.detail.milestoneAddedSuccess'))
  } catch (error) {
    // 表单验证失败
  }
}

const handleRemoveMilestone = async (index) => {
  try {
    await ElMessageBox.confirm(
      t('project.detail.deleteMilestoneConfirm'),
      t('project.detail.deleteMilestoneTitle'),
      {
        confirmButtonText: t('common.confirm'),
        cancelButtonText: t('common.cancel'),
        type: 'warning'
      }
    )
    
    milestones.value.splice(index, 1)
    ElMessage.success(t('project.detail.milestoneDeletedSuccess'))
  } catch (error) {
    // 用户取消操作
  }
}

// 里程碑文档管理
const triggerMilestoneUpload = (milestoneIndex) => {
  nextTick(() => {
    const fileInput = document.getElementById(`milestoneFileInput${milestoneIndex}`)
    if (fileInput) {
      fileInput.click()
    }
  })
}

const handleMilestoneFileSelect = (event, milestoneIndex) => {
  const files = event.target.files
  if (files.length > 0) {
    uploadMilestoneFiles(files, milestoneIndex)
    event.target.value = ''
  }
}

const uploadMilestoneFiles = (files, milestoneIndex) => {
  const allowedTypes = ['.pdf', '.doc', '.docx', '.xls', '.xlsx', '.ppt', '.pptx', '.txt', '.md', '.rtf']
  const maxSize = 50 * 1024 * 1024 // 50MB
  
  for (let file of files) {
    const fileExt = '.' + file.name.split('.').pop().toLowerCase()
    if (!allowedTypes.includes(fileExt)) {
      ElMessage.error(t('project.detail.unsupportedFileType', { name: file.name }))
      return
    }
    if (file.size > maxSize) {
      ElMessage.error(t('project.detail.fileTooLarge', { name: file.name, maxSize: '50MB' }))
      return
    }
  }
  
  if (!milestones.value[milestoneIndex].documents) {
    milestones.value[milestoneIndex].documents = []
  }
  
  const loadingMessage = ElMessage({
    message: t('project.detail.uploadingFiles', { count: files.length }),
    type: 'info',
    duration: 0,
    showClose: false
  })
  
  setTimeout(() => {
    loadingMessage.close()
    
    let successCount = 0
    for (let i = 0; i < files.length; i++) {
      const file = files[i]
      
      const existingDoc = milestones.value[milestoneIndex].documents.find(
        doc => doc.name === file.name
      )
      
      if (existingDoc) {
        ElMessage.warning(t('project.detail.fileAlreadyExists', { name: file.name }))
        continue
      }
      
      const newDoc = {
        id: Date.now() + Math.random() + i,
        name: file.name,
        type: file.name.split('.').pop().toUpperCase(),
        uploader: '当前用户',
        uploadTime: new Date().toISOString().split('T')[0],
        size: formatFileSize(file.size)
      }
      
      milestones.value[milestoneIndex].documents.push(newDoc)
      successCount++
    }
    
    if (successCount > 0) {
      ElMessage.success(t('project.detail.documentsAddedSuccess', { 
        milestoneIndex: milestoneIndex + 1, 
        count: successCount 
      }))
    }
  }, 1000)
}

const formatFileSize = (bytes) => {
  if (bytes === 0) return '0 B'
  const k = 1024
  const sizes = ['B', 'KB', 'MB', 'GB']
  const i = Math.floor(Math.log(bytes) / Math.log(k))
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]
}

const handleDeleteMilestoneDoc = (milestoneIndex, docId) => {
  const milestone = milestones.value[milestoneIndex]
  if (milestone.documents) {
    const docIndex = milestone.documents.findIndex(doc => doc.id === docId)
    if (docIndex > -1) {
      const docName = milestone.documents[docIndex].name
      milestone.documents.splice(docIndex, 1)
      ElMessage.success(t('project.detail.documentDeletedSuccess', { name: docName }))
    }
  }
}

// 里程碑拖拽事件处理
const handleMilestoneDragOver = (milestoneIndex) => {
  milestonesDragOver.value[milestoneIndex] = true
}

const handleMilestoneDragLeave = (milestoneIndex) => {
  milestonesDragOver.value[milestoneIndex] = false
}

const handleMilestoneDrop = (event, milestoneIndex) => {
  event.preventDefault()
  milestonesDragOver.value[milestoneIndex] = false
  const files = event.dataTransfer.files
  if (files.length > 0) {
    uploadMilestoneFiles(files, milestoneIndex)
  }
}

// 文档操作
const handlePreview = (docId) => {
  ElMessage.info(t('project.detail.previewDocument', { docId }))
}

const handleDownload = (docId) => {
  ElMessage.info(t('project.detail.downloadDocument', { docId }))
}

onMounted(() => {
  loadProjectDetail()
})
</script>
```

### 3. 样式实现
```scss
<style lang="scss" scoped>
.project-detail-container {
  padding: 20px;
  background: #f7f9fc;
  min-height: calc(100vh - 56px);
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.header-left {
  display: flex;
  align-items: center;
  gap: 16px;
}

.page-title {
  font-size: 24px;
  font-weight: 600;
  color: #1e3a8a;
  margin: 0;
}

.loading-container {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  gap: 8px;
  color: #6b7280;
}

.main-content-single {
  display: flex;
  flex-direction: column;
  gap: 20px;
  margin-bottom: 20px;
}

.card {
  background: #ffffff;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
  border: 1px solid #e5e7eb;
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid #e5e7eb;
}

.card-title {
  font-size: 16px;
  font-weight: 600;
  color: #1e3a8a;
  margin: 0;
}

.info-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.info-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.info-label {
  font-size: 14px;
  color: #6b7280;
  font-weight: 500;
}

.info-value {
  font-size: 14px;
  color: #374151;
}

.budget-unit {
  margin-left: 8px;
  color: #6b7280;
  font-size: 14px;
}

// 成员管理样式
.member-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.member-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  background: #f8fafc;
  border-radius: 6px;
}

.member-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: #e5e7eb;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #6b7280;
  font-weight: 600;
}

.member-info {
  flex: 1;
}

.member-name {
  font-size: 14px;
  font-weight: 500;
  color: #374151;
  margin-bottom: 2px;
}

.member-role {
  font-size: 12px;
  color: #6b7280;
}

.search-results {
  max-height: 200px;
  overflow-y: auto;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  background: #ffffff;
  margin-top: 12px;
}

.search-result-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px;
  border-bottom: 1px solid #f3f4f6;
}

.search-result-item:last-child {
  border-bottom: none;
}

.search-result-item:hover {
  background: #f8fafc;
}

.search-result-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.search-result-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: #f3f4f6;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #374151;
  font-weight: 500;
  font-size: 16px;
}

.search-result-details {
  flex: 1;
}

.search-result-name {
  font-weight: 500;
  color: #374151;
  font-size: 14px;
}

// 里程碑管理样式
.milestone-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.milestone-item {
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  padding: 16px;
  background: #fafafa;
}

.milestone-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.milestone-title {
  font-weight: 600;
  color: #1e3a8a;
}

.milestone-form {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.milestone-documents {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid #e5e7eb;
}

.milestone-documents-header {
  margin-bottom: 12px;
}

.milestone-documents-header h4 {
  margin: 0;
  font-size: 14px;
  font-weight: 600;
  color: #1e3a8a;
}

.document-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.document-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  background: #f8fafc;
  border-radius: 6px;
}

.document-icon {
  width: 32px;
  height: 32px;
  border-radius: 4px;
  background: #dbeafe;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #1e40af;
}

.document-info {
  flex: 1;
}

.document-name {
  font-size: 14px;
  font-weight: 500;
  color: #374151;
  margin-bottom: 2px;
}

.document-meta {
  font-size: 12px;
  color: #6b7280;
}

.document-actions {
  display: flex;
  gap: 8px;
}

.upload-section {
  margin-top: 12px;
}

.upload-area {
  border: 2px dashed #d1d5db;
  border-radius: 6px;
  padding: 20px;
  text-align: center;
  cursor: pointer;
  transition: border-color 0.3s, background-color 0.3s;
}

.upload-area:hover {
  border-color: #1e3a8a;
}

.upload-area.dragover {
  border-color: #1e3a8a;
  background: #f0f9ff;
}

.upload-icon {
  font-size: 24px;
  color: #9ca3af;
  margin-bottom: 8px;
}

.upload-text {
  font-size: 14px;
  color: #6b7280;
  margin-bottom: 4px;
}

.upload-hint {
  font-size: 12px;
  color: #9ca3af;
}

// 空状态样式
.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #6b7280;
}

.empty-state-icon {
  font-size: 48px;
  margin-bottom: 16px;
  opacity: 0.5;
}

.empty-state-text {
  font-size: 16px;
  margin-bottom: 8px;
}

.empty-state-hint {
  font-size: 14px;
  color: #9ca3af;
}

// 操作按钮样式
.footer-actions {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid #e5e7eb;
  position: sticky;
  bottom: 0;
  background: #ffffff;
  padding-bottom: 12px;
  z-index: 10;
  box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.03);
}

// 响应式设计
@media (max-width: 768px) {
  .info-grid {
    grid-template-columns: 1fr;
  }
  
  .form-row {
    grid-template-columns: 1fr;
  }
  
  .footer-actions {
    flex-direction: column;
    gap: 8px;
  }
}
</style>
```

## ⚠️ 重要注意事项

1. **模式切换**：通过URL参数`mode=edit`或`mode=view`控制编辑/查看模式
2. **表单验证**：编辑模式下完整的表单验证规则，包括必填项、长度限制、数值范围等，所有验证消息使用i18n
3. **成员管理**：支持搜索、添加、移除成员功能（仅编辑模式）
4. **里程碑管理**：支持添加、删除里程碑，每个里程碑可管理文档（仅编辑模式）
5. **文档管理**：支持拖拽上传、预览、下载、删除文档（仅编辑模式）
6. **保存确认**：取消编辑时提示未保存的更改
7. **响应式设计**：移动端适配
8. **国际化支持**：所有文本使用$t()函数，包括表单验证消息和UI提示
9. **权限控制**：编辑功能需要相应权限
10. **接口集成**：所有数据通过后端接口获取，包含完整的错误处理和加载状态
11. **常量管理**：项目状态和里程碑选项从constants.js导入，统一管理
12. **状态管理**：使用PROJECT_STATUS和PROJECT_STATUS_CONFIG进行状态文本和标签类型管理

**最终要求：生成的代码必须与原型图的视觉效果和交互逻辑完全一致！**
