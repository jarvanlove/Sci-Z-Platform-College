# å®‰å…¨è®¾ç½®é¡µé¢å¼€å‘æç¤ºè¯

## ğŸ“‹ é¡µé¢ä¿¡æ¯
- **åŸå‹å›¾è·¯å¾„**ï¼š`åŸå‹å›¾/ç”¨æˆ·ä¸­å¿ƒ/å®‰å…¨è®¾ç½®.html`
- **é¡µé¢ç±»å‹**ï¼šè¡¨å•é¡µé¢
- **é¡µé¢åç§°**ï¼šå®‰å…¨è®¾ç½®
- **ä¸»è¦åŠŸèƒ½**ï¼šå¯†ç ä¿®æ”¹ã€å¯†ç å¼ºåº¦æ£€æµ‹ã€ç™»å½•æ—¥å¿—æŸ¥çœ‹
- **å¯¹åº”æ–‡ä»¶è·¯å¾„**ï¼š`src/views/User/Security.vue`

## ğŸ¨ åŸå‹å›¾è§†è§‰åˆ†æ

### **æ•´ä½“å¸ƒå±€**
- å•æ å¸ƒå±€ï¼šå¯†ç ä¿®æ”¹ + ç™»å½•æ—¥å¿—
- èƒŒæ™¯è‰²ï¼š`#f7f9fc`
- å®¹å™¨ï¼š`padding: 20px`ï¼Œ`min-height: calc(100vh - 56px)`
- é¡µé¢æ ‡é¢˜ï¼š`font-size: 24px`ï¼Œ`color: #1e3a8a`ï¼Œ`font-weight: 600`

### **å¯†ç ä¿®æ”¹åŒºåŸŸ**
- ç™½è‰²å¡ç‰‡ï¼š`background: #ffffff`ï¼Œ`border-radius: 8px`ï¼Œ`padding: 24px`
- è¡¨å•å¸ƒå±€ï¼š`max-width: 600px`
- å¯†ç å¼ºåº¦æŒ‡ç¤ºå™¨ï¼š`height: 6px`ï¼Œ`border-radius: 3px`
- å¼ºåº¦ç­‰çº§ï¼šå¼±(33%)ã€ä¸­(66%)ã€å¼º(100%)

### **ç™»å½•æ—¥å¿—åŒºåŸŸ**
- ç­›é€‰æ¡ä»¶ï¼šçŠ¶æ€é€‰æ‹©å™¨ã€æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨
- **ä½¿ç”¨Element Plusè¡¨æ ¼ç»„ä»¶**ï¼š`el-table`ã€`el-table-column`
- çŠ¶æ€æ ‡ç­¾ï¼šæˆåŠŸ(ç»¿è‰²)ã€å¤±è´¥(çº¢è‰²)ã€å¼‚å¸¸(é»„è‰²)
- åˆ†é¡µç»„ä»¶ï¼š`BasePagination`

### **å¯†ç å¼ºåº¦æ£€æµ‹**
- å®æ—¶æ£€æµ‹ï¼šé•¿åº¦ã€æ•°å­—ã€å­—æ¯ã€ç‰¹æ®Šå­—ç¬¦
- è§†è§‰åé¦ˆï¼šé¢œè‰²æ¸å˜ã€è¿›åº¦æ¡ã€æç¤ºæ–‡æœ¬
- å¼ºåº¦ç­‰çº§ï¼šå¼±ã€ä¸­ã€å¼ºä¸‰ä¸ªç­‰çº§

## ğŸ”§ æŠ€æœ¯å®ç°è¦æ±‚

### 1. é¡µé¢ç»“æ„
```vue
<template>
  <div class="security-container">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="page-header">
      <h1 class="page-title">{{ $t('user.security.title') }}</h1>
    </div>

    <!-- ä¿®æ”¹å¯†ç åŒºåŸŸ -->
    <BaseCard class="security-card">
      <template #header>
        <div class="card-title">{{ $t('user.security.changePassword') }}</div>
      </template>

      <el-form
        ref="passwordFormRef"
        :model="passwordForm"
        :rules="passwordRules"
        label-width="120px"
        class="password-form"
      >
        <!-- åŸå¯†ç  -->
        <el-form-item :label="$t('user.security.oldPassword')" prop="oldPassword">
          <el-input
            v-model="passwordForm.oldPassword"
            type="password"
            :placeholder="$t('user.security.oldPasswordPlaceholder')"
            show-password
            clearable
          />
        </el-form-item>

        <!-- æ–°å¯†ç  -->
        <el-form-item :label="$t('user.security.newPassword')" prop="newPassword">
          <el-input
            v-model="passwordForm.newPassword"
            type="password"
            :placeholder="$t('user.security.newPasswordPlaceholder')"
            show-password
            clearable
            @input="checkPasswordStrength"
          />
          <!-- å¯†ç å¼ºåº¦æŒ‡ç¤ºå™¨ -->
          <div v-if="passwordForm.newPassword" class="password-strength">
            <div class="strength-bar">
              <div
                class="strength-fill"
                :class="passwordStrengthLevel"
              ></div>
            </div>
            <div class="strength-text">
              <span class="strength-level" :class="passwordStrengthLevel">
                {{ passwordStrengthText }}
              </span>
              <span class="strength-tips">
                {{ passwordStrengthTips }}
              </span>
            </div>
          </div>
        </el-form-item>

        <!-- ç¡®è®¤å¯†ç  -->
        <el-form-item :label="$t('user.security.confirmPassword')" prop="confirmPassword">
          <el-input
            v-model="passwordForm.confirmPassword"
            type="password"
            :placeholder="$t('user.security.confirmPasswordPlaceholder')"
            show-password
            clearable
          />
        </el-form-item>

        <!-- è¡¨å•æ“ä½œæŒ‰é’® -->
        <div class="form-actions">
          <BaseButton
            type="primary"
            size="large"
            :loading="changing"
            @click="handleChangePassword"
          >
            {{ $t('user.security.changePassword') }}
          </BaseButton>
          <BaseButton size="large" @click="handleResetPassword">
            {{ $t('common.reset') }}
          </BaseButton>
        </div>
      </el-form>
    </BaseCard>

    <!-- ç™»å½•æ—¥å¿—åŒºåŸŸ -->
    <BaseCard class="security-card">
      <template #header>
        <div class="card-title">{{ $t('user.security.loginLogs') }}</div>
      </template>

      <!-- ç­›é€‰æ¡ä»¶ -->
      <div class="log-filters">
        <el-select
          v-model="logFilters.status"
          :placeholder="$t('user.security.selectStatus')"
          style="width: 150px"
          @change="handleFilterChange"
        >
          <el-option :label="$t('common.all')" value="all" />
          <el-option :label="$t('user.security.loginSuccess')" value="success" />
          <el-option :label="$t('user.security.loginFailed')" value="failed" />
          <el-option :label="$t('user.security.abnormalLogin')" value="warning" />
        </el-select>
        
        <el-date-picker
          v-model="logFilters.dateRange"
          type="daterange"
          :range-separator="$t('common.to')"
          :start-placeholder="$t('common.startDate')"
          :end-placeholder="$t('common.endDate')"
          style="width: 280px"
          @change="handleFilterChange"
        />
      </div>

      <!-- ç™»å½•æ—¥å¿—è¡¨æ ¼ - ä½¿ç”¨Element Plusè¡¨æ ¼ç»„ä»¶ -->
      <div class="log-table">
        <el-table
          :data="filteredLogs"
          style="width: 100%"
          :loading="logsLoading"
          :empty-text="$t('common.noData')"
        >
          <el-table-column
            prop="loginTime"
            :label="$t('user.security.loginTime')"
            width="150"
            sortable
          />
          <el-table-column
            prop="ip"
            :label="$t('user.security.loginIP')"
            width="120"
          />
          <el-table-column
            prop="location"
            :label="$t('user.security.loginLocation')"
            width="150"
          />
          <el-table-column
            prop="browser"
            :label="$t('user.security.browser')"
            width="120"
          />
          <el-table-column
            prop="os"
            :label="$t('user.security.operatingSystem')"
            width="120"
          />
          <el-table-column
            prop="status"
            :label="$t('user.security.loginStatus')"
            width="100"
            align="center"
          >
            <template #default="{ row }">
              <el-tag
                :type="getStatusTagType(row.status)"
                size="small"
                effect="light"
              >
                {{ getStatusText(row.status) }}
              </el-tag>
            </template>
          </el-table-column>
        </el-table>

        <!-- åˆ†é¡µç»„ä»¶ -->
        <BasePagination
          v-if="loginLogs.length > 0"
          :current="pagination.current"
          :size="pagination.size"
          :total="pagination.total"
          @change="handlePageChange"
          @size-change="handlePageSizeChange"
        />
      </div>
    </BaseCard>
  </div>
</template>
```

### 2. æ ¸å¿ƒåŠŸèƒ½å®ç°
```javascript
<script setup>
import { ref, reactive, computed, onMounted } from 'vue'
import { useI18n } from 'vue-i18n'
import { ElMessage, ElMessageBox } from 'element-plus'
import { BaseCard, BaseButton, BasePagination } from '@/components/Common'
import { changePassword, getLoginLogs } from '@/api/User'
import { validatePassword, validatePasswordLength } from '@/utils/validate'
import { formatDate } from '@/utils/date'
import { createLogger } from '@/utils/simpleLogger'
import { LOGIN_STATUS_TAG_CONFIG } from '@/utils/constants'

const { t } = useI18n()
const logger = createLogger('SecuritySettings')

// å“åº”å¼æ•°æ®
const passwordFormRef = ref()
const changing = ref(false)
const logsLoading = ref(false)

// å¯†ç è¡¨å•
const passwordForm = reactive({
  oldPassword: '',
  newPassword: '',
  confirmPassword: ''
})

// å¯†ç éªŒè¯è§„åˆ™
const passwordRules = {
  oldPassword: [
    { required: true, message: t('user.security.oldPasswordRequired'), trigger: 'blur' }
  ],
  newPassword: [
    { required: true, message: t('user.security.newPasswordRequired'), trigger: 'blur' },
    { 
      validator: (rule, value, callback) => {
        if (!validatePasswordLength(value, 8, 32)) {
          callback(new Error(t('user.security.passwordMinLength')))
        } else if (!validatePassword(value)) {
          callback(new Error(t('user.security.passwordStrength')))
        } else {
          callback()
        }
      }, 
      trigger: 'blur' 
    }
  ],
  confirmPassword: [
    { required: true, message: t('user.security.confirmPasswordRequired'), trigger: 'blur' },
    {
      validator: (rule, value, callback) => {
        if (value !== passwordForm.newPassword) {
          callback(new Error(t('user.security.passwordMismatch')))
        } else {
          callback()
        }
      },
      trigger: 'blur'
    }
  ]
}

// å¯†ç å¼ºåº¦
const passwordStrength = ref(0)

const checkPasswordStrength = () => {
  const pwd = passwordForm.newPassword
  if (!pwd) {
    passwordStrength.value = 0
    return
  }

  let strength = 0

  // é•¿åº¦æ£€æŸ¥
  if (pwd.length >= 8) strength++
  if (pwd.length >= 12) strength++

  // åŒ…å«æ•°å­—
  if (/\d/.test(pwd)) strength++

  // åŒ…å«å°å†™å­—æ¯
  if (/[a-z]/.test(pwd)) strength++

  // åŒ…å«å¤§å†™å­—æ¯
  if (/[A-Z]/.test(pwd)) strength++

  // åŒ…å«ç‰¹æ®Šå­—ç¬¦
  if (/[^a-zA-Z0-9]/.test(pwd)) strength++

  // è®¡ç®—å¼ºåº¦ç­‰çº§
  if (strength <= 2) {
    passwordStrength.value = 1 // å¼±
  } else if (strength <= 4) {
    passwordStrength.value = 2 // ä¸­
  } else {
    passwordStrength.value = 3 // å¼º
  }
}

const passwordStrengthLevel = computed(() => {
  const levels = ['', 'weak', 'medium', 'strong']
  return levels[passwordStrength.value]
})

const passwordStrengthText = computed(() => {
  const texts = ['', t('user.security.weak'), t('user.security.medium'), t('user.security.strong')]
  return texts[passwordStrength.value]
})

const passwordStrengthTips = computed(() => {
  switch (passwordStrength.value) {
    case 1:
      return t('user.security.weakTips')
    case 2:
      return t('user.security.mediumTips')
    case 3:
      return t('user.security.strongTips')
    default:
      return ''
  }
})

// ä¿®æ”¹å¯†ç 
const handleChangePassword = async () => {
  try {
    await passwordFormRef.value.validate()

    await ElMessageBox.confirm(
      t('user.security.changePasswordConfirm'),
      t('user.security.changePasswordTitle'),
      {
        confirmButtonText: t('common.confirm'),
        cancelButtonText: t('common.cancel'),
        type: 'warning'
      }
    )

    changing.value = true
    
    // TODO: è°ƒç”¨APIä¿®æ”¹å¯†ç 
    // await changePassword({
    //   oldPassword: passwordForm.oldPassword,
    //   newPassword: passwordForm.newPassword
    // })
    
    // æ¨¡æ‹Ÿä¿®æ”¹å¯†ç 
    await new Promise(resolve => setTimeout(resolve, 1000))
    ElMessage.success(t('user.security.changePasswordSuccess'))
    
    // æ¸…ç©ºè¡¨å•
    passwordFormRef.value.resetFields()
    passwordStrength.value = 0
    
    // è·³è½¬åˆ°ç™»å½•é¡µ
    setTimeout(() => {
      // TODO: å®ç°è·³è½¬åˆ°ç™»å½•é¡µ
      // router.push('/login')
      ElMessage.info(t('user.security.redirectToLogin'))
    }, 2000)
    
  } catch (error) {
    if (error !== 'cancel') {
      ElMessage.error(t('user.security.changePasswordError'))
    }
    changing.value = false
  }
}

// é‡ç½®å¯†ç è¡¨å•
const handleResetPassword = () => {
  passwordFormRef.value.resetFields()
  passwordStrength.value = 0
}

// ç™»å½•æ—¥å¿—æ•°æ®
const loginLogs = ref([])

// æ—¥å¿—ç­›é€‰
const logFilters = reactive({
  dateRange: [],
  status: 'all'
})

// åˆ†é¡µ
const pagination = reactive({
  current: 1,
  size: 10,
  total: 0
})

// æ¨¡æ‹Ÿæ•°æ®ï¼ˆåç«¯å®Œæˆååˆ é™¤ï¼‰
// const mockLoginLogs = [
//   {
//     id: 1,
//     loginTime: '2024-03-15 14:30:25',
//     ip: '192.168.1.100',
//     location: 'åŒ—äº¬å¸‚æµ·æ·€åŒº',
//     browser: 'Chrome 120',
//     os: 'Windows 10',
//     status: 'success'
//   },
//   {
//     id: 2,
//     loginTime: '2024-03-14 09:15:42',
//     ip: '192.168.1.100',
//     location: 'åŒ—äº¬å¸‚æµ·æ·€åŒº',
//     browser: 'Chrome 120',
//     os: 'Windows 10',
//     status: 'success'
//   },
//   {
//     id: 3,
//     loginTime: '2024-03-13 18:22:10',
//     ip: '101.201.45.123',
//     location: 'ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒº',
//     browser: 'Safari 17',
//     os: 'macOS 14',
//     status: 'warning'
//   },
//   {
//     id: 4,
//     loginTime: '2024-03-12 08:45:33',
//     ip: '192.168.1.100',
//     location: 'åŒ—äº¬å¸‚æµ·æ·€åŒº',
//     browser: 'Chrome 120',
//     os: 'Windows 10',
//     status: 'success'
//   },
//   {
//     id: 5,
//     loginTime: '2024-03-11 16:20:15',
//     ip: '192.168.1.100',
//     location: 'åŒ—äº¬å¸‚æµ·æ·€åŒº',
//     browser: 'Chrome 120',
//     os: 'Windows 10',
//     status: 'success'
//   },
//   {
//     id: 6,
//     loginTime: '2024-03-10 11:10:08',
//     ip: '192.168.1.100',
//     location: 'åŒ—äº¬å¸‚æµ·æ·€åŒº',
//     browser: 'Chrome 119',
//     os: 'Windows 10',
//     status: 'failed'
//   }
// ]

// è¿‡æ»¤ä¸åˆ†é¡µå»ºè®®ç”±åç«¯å®Œæˆï¼Œè¿™é‡Œç›´æ¥å±•ç¤ºåç«¯è¿”å›çš„æ•°æ®
const filteredLogs = computed(() => loginLogs.value)

const handleFilterChange = () => {
  pagination.current = 1
}

const handlePageChange = (page) => {
  pagination.current = page
}

const handlePageSizeChange = (size) => {
  pagination.size = size
  pagination.current = 1
}

const getStatusText = (status) => {
  const statusMap = {
    success: t('user.security.loginSuccess'),
    failed: t('user.security.loginFailed'),
    warning: t('user.security.abnormalLogin')
  }
  return statusMap[status] || status
}

const getStatusTagType = (status) => {
  return LOGIN_STATUS_TAG_CONFIG[status]?.type || 'info'
}

const loadLoginLogs = async () => {
  try {
    logsLoading.value = true
    
    // TODO: è°ƒç”¨APIè·å–ç™»å½•æ—¥å¿—ï¼ˆç”±åç«¯å®Œæˆç­›é€‰ä¸åˆ†é¡µï¼‰
    // const response = await getLoginLogs({
    //   page: pagination.current,
    //   size: pagination.size,
    //   status: logFilters.status,
    //   startDate: logFilters.dateRange?.[0],
    //   endDate: logFilters.dateRange?.[1]
    // })
    // loginLogs.value = response.data.list
    // pagination.total = response.data.total
    
    // ä¸´æ—¶æ¨¡æ‹Ÿï¼ˆåç«¯å®Œæˆååˆ é™¤ï¼‰
    // await new Promise(resolve => setTimeout(resolve, 500))
    // loginLogs.value = [...mockLoginLogs]
    // pagination.total = loginLogs.value.length
    
  } catch (error) {
    ElMessage.error(t('user.security.loadLogsError'))
  } finally {
    logsLoading.value = false
  }
}

onMounted(() => {
  loadLoginLogs()
})
</script>
```

### 3. æ ·å¼å®ç°
```scss
<style lang="scss" scoped>
.security-container {
  padding: 20px;
  background: #f7f9fc;
  min-height: calc(100vh - 56px);
}

.page-header {
  margin-bottom: 20px;
}

.page-title {
  font-size: 24px;
  font-weight: 600;
  color: #1e3a8a;
  margin: 0;
}

.security-card {
  background: #ffffff;
  border-radius: 8px;
  padding: 24px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
  border: 1px solid #e5e7eb;
  margin-bottom: 20px;
}

.card-title {
  font-size: 18px;
  font-weight: 600;
  color: #374151;
  margin-bottom: 20px;
  padding-bottom: 12px;
  border-bottom: 1px solid #e5e7eb;
}

/* å¯†ç è¡¨å•æ ·å¼ */
.password-form {
  max-width: 600px;
}

/* å¯†ç å¼ºåº¦æŒ‡ç¤ºå™¨ */
.password-strength {
  margin-top: 8px;
}

.strength-bar {
  height: 6px;
  background: #e5e7eb;
  border-radius: 3px;
  overflow: hidden;
  margin-bottom: 8px;
}

.strength-fill {
  height: 100%;
  transition: all 0.3s;
  border-radius: 3px;
}

.strength-fill.weak {
  width: 33%;
  background: #dc2626;
}

.strength-fill.medium {
  width: 66%;
  background: #f59e0b;
}

.strength-fill.strong {
  width: 100%;
  background: #16a34a;
}

.strength-text {
  font-size: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.strength-level {
  font-weight: 500;
}

.strength-level.weak {
  color: #dc2626;
}

.strength-level.medium {
  color: #f59e0b;
}

.strength-level.strong {
  color: #16a34a;
}

.strength-tips {
  color: #6b7280;
}

/* è¡¨å•æ“ä½œæŒ‰é’® */
.form-actions {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-top: 32px;
  padding-top: 20px;
  border-top: 1px solid #e5e7eb;
}

/* ç™»å½•æ—¥å¿—è¡¨æ ¼ */
.log-filters {
  display: flex;
  gap: 16px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.log-table {
  margin-top: 20px;
}

/* Element Plusè¡¨æ ¼æ ·å¼è¦†ç›– */
:deep(.el-table) {
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid #e5e7eb;
}

:deep(.el-table__header) {
  background: #f8fafc;
}

:deep(.el-table th) {
  background: #f8fafc;
  color: #374151;
  font-weight: 600;
  font-size: 14px;
  border-bottom: 1px solid #e5e7eb;
}

:deep(.el-table td) {
  font-size: 14px;
  color: #6b7280;
  border-bottom: 1px solid #e5e7eb;
}

:deep(.el-table--striped .el-table__body tr.el-table__row--striped td) {
  background: #fafbfc;
}

:deep(.el-table__body tr:hover > td) {
  background: #f8fafc;
}

:deep(.el-table__body tr:last-child td) {
  border-bottom: none;
}

/* çŠ¶æ€æ ‡ç­¾ */
:deep(.el-tag) {
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
  padding: 4px 12px;
}

:deep(.el-tag--success) {
  background: #dcfce7;
  color: #16a34a;
  border-color: #bbf7d0;
}

:deep(.el-tag--danger) {
  background: #fee2e2;
  color: #dc2626;
  border-color: #fecaca;
}

:deep(.el-tag--warning) {
  background: #fef3c7;
  color: #f59e0b;
  border-color: #fde68a;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .security-container {
    padding: 16px;
  }
  
  .log-filters {
    flex-direction: column;
  }
  
  .log-filters .el-date-picker,
  .log-filters .el-select {
    width: 100% !important;
  }
  
  .form-actions {
    flex-direction: column;
    align-items: center;
  }
  
  :deep(.el-table) {
    font-size: 12px;
  }
  
  :deep(.el-table th),
  :deep(.el-table td) {
    padding: 8px 12px;
  }
}
</style>
```

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

1. **å¯†ç å¼ºåº¦æ£€æµ‹**ï¼šå®æ—¶æ£€æµ‹å¯†ç å¼ºåº¦ï¼Œæä¾›è§†è§‰åé¦ˆ
2. **Element Plusè¡¨æ ¼**ï¼šä½¿ç”¨`el-table`ã€`el-table-column`æ›¿ä»£åŸç”ŸHTMLè¡¨æ ¼
3. **ç™»å½•æ—¥å¿—**ï¼šæ”¯æŒçŠ¶æ€ç­›é€‰ã€æ—¥æœŸèŒƒå›´ç­›é€‰ã€åˆ†é¡µ
4. **çŠ¶æ€æ ‡ç­¾**ï¼šä½¿ç”¨`el-tag`ç»„ä»¶æ˜¾ç¤ºç™»å½•çŠ¶æ€
5. **åˆ†é¡µç»„ä»¶**ï¼šä½¿ç”¨`BasePagination`ç»„ä»¶
6. **å“åº”å¼è®¾è®¡**ï¼šç§»åŠ¨ç«¯é€‚é…
7. **å›½é™…åŒ–æ”¯æŒ**ï¼šæ‰€æœ‰æ–‡æœ¬ä½¿ç”¨$t()å‡½æ•°
8. **Mockæ•°æ®**ï¼šåŒ…å«TODOæ³¨é‡Šï¼Œä¾¿äºåç«¯é›†æˆ

**æœ€ç»ˆè¦æ±‚ï¼šç”Ÿæˆçš„ä»£ç å¿…é¡»ä¸åŸå‹å›¾çš„è§†è§‰æ•ˆæœå’Œäº¤äº’é€»è¾‘å®Œå…¨ä¸€è‡´ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨Element Plusè¡¨æ ¼ç»„ä»¶æ›¿ä»£åŸç”ŸHTMLè¡¨æ ¼ï¼**
