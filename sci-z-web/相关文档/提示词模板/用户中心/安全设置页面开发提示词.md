# 安全设置页面开发提示词

## 📋 页面信息
- **原型图路径**：`原型图/用户中心/安全设置.html`
- **页面类型**：表单页面
- **页面名称**：安全设置
- **主要功能**：密码修改、密码强度检测、登录日志查看
- **对应文件路径**：`src/views/User/Security.vue`

## 🎨 原型图视觉分析

### **整体布局**
- 单栏布局：密码修改 + 登录日志
- 背景色：`#f7f9fc`
- 容器：`padding: 20px`，`min-height: calc(100vh - 56px)`
- 页面标题：`font-size: 24px`，`color: #1e3a8a`，`font-weight: 600`

### **密码修改区域**
- 白色卡片：`background: #ffffff`，`border-radius: 8px`，`padding: 24px`
- 表单布局：`max-width: 600px`
- 密码强度指示器：`height: 6px`，`border-radius: 3px`
- 强度等级：弱(33%)、中(66%)、强(100%)

### **登录日志区域**
- 筛选条件：状态选择器、日期范围选择器
- **使用Element Plus表格组件**：`el-table`、`el-table-column`
- 状态标签：成功(绿色)、失败(红色)、异常(黄色)
- 分页组件：`BasePagination`

### **密码强度检测**
- 实时检测：长度、数字、字母、特殊字符
- 视觉反馈：颜色渐变、进度条、提示文本
- 强度等级：弱、中、强三个等级

## 🔧 技术实现要求

### 1. 页面结构
```vue
<template>
  <div class="security-container">
    <!-- 页面标题 -->
    <div class="page-header">
      <h1 class="page-title">{{ $t('user.security.title') }}</h1>
    </div>

    <!-- 修改密码区域 -->
    <BaseCard class="security-card">
      <template #header>
        <div class="card-title">{{ $t('user.security.changePassword') }}</div>
      </template>

      <el-form
        ref="passwordFormRef"
        :model="passwordForm"
        :rules="passwordRules"
        label-width="120px"
        class="password-form"
      >
        <!-- 原密码 -->
        <el-form-item :label="$t('user.security.oldPassword')" prop="oldPassword">
          <el-input
            v-model="passwordForm.oldPassword"
            type="password"
            :placeholder="$t('user.security.oldPasswordPlaceholder')"
            show-password
            clearable
          />
        </el-form-item>

        <!-- 新密码 -->
        <el-form-item :label="$t('user.security.newPassword')" prop="newPassword">
          <el-input
            v-model="passwordForm.newPassword"
            type="password"
            :placeholder="$t('user.security.newPasswordPlaceholder')"
            show-password
            clearable
            @input="checkPasswordStrength"
          />
          <!-- 密码强度指示器 -->
          <div v-if="passwordForm.newPassword" class="password-strength">
            <div class="strength-bar">
              <div
                class="strength-fill"
                :class="passwordStrengthLevel"
              ></div>
            </div>
            <div class="strength-text">
              <span class="strength-level" :class="passwordStrengthLevel">
                {{ passwordStrengthText }}
              </span>
              <span class="strength-tips">
                {{ passwordStrengthTips }}
              </span>
            </div>
          </div>
        </el-form-item>

        <!-- 确认密码 -->
        <el-form-item :label="$t('user.security.confirmPassword')" prop="confirmPassword">
          <el-input
            v-model="passwordForm.confirmPassword"
            type="password"
            :placeholder="$t('user.security.confirmPasswordPlaceholder')"
            show-password
            clearable
          />
        </el-form-item>

        <!-- 表单操作按钮 -->
        <div class="form-actions">
          <BaseButton
            type="primary"
            size="large"
            :loading="changing"
            @click="handleChangePassword"
          >
            {{ $t('user.security.changePassword') }}
          </BaseButton>
          <BaseButton size="large" @click="handleResetPassword">
            {{ $t('common.reset') }}
          </BaseButton>
        </div>
      </el-form>
    </BaseCard>

    <!-- 登录日志区域 -->
    <BaseCard class="security-card">
      <template #header>
        <div class="card-title">{{ $t('user.security.loginLogs') }}</div>
      </template>

      <!-- 筛选条件 -->
      <div class="log-filters">
        <el-select
          v-model="logFilters.status"
          :placeholder="$t('user.security.selectStatus')"
          style="width: 150px"
          @change="handleFilterChange"
        >
          <el-option :label="$t('common.all')" value="all" />
          <el-option :label="$t('user.security.loginSuccess')" value="success" />
          <el-option :label="$t('user.security.loginFailed')" value="failed" />
          <el-option :label="$t('user.security.abnormalLogin')" value="warning" />
        </el-select>
        
        <el-date-picker
          v-model="logFilters.dateRange"
          type="daterange"
          :range-separator="$t('common.to')"
          :start-placeholder="$t('common.startDate')"
          :end-placeholder="$t('common.endDate')"
          style="width: 280px"
          @change="handleFilterChange"
        />
      </div>

      <!-- 登录日志表格 - 使用Element Plus表格组件 -->
      <div class="log-table">
        <el-table
          :data="filteredLogs"
          style="width: 100%"
          :loading="logsLoading"
          :empty-text="$t('common.noData')"
        >
          <el-table-column
            prop="loginTime"
            :label="$t('user.security.loginTime')"
            width="150"
            sortable
          />
          <el-table-column
            prop="ip"
            :label="$t('user.security.loginIP')"
            width="120"
          />
          <el-table-column
            prop="location"
            :label="$t('user.security.loginLocation')"
            width="150"
          />
          <el-table-column
            prop="browser"
            :label="$t('user.security.browser')"
            width="120"
          />
          <el-table-column
            prop="os"
            :label="$t('user.security.operatingSystem')"
            width="120"
          />
          <el-table-column
            prop="status"
            :label="$t('user.security.loginStatus')"
            width="100"
            align="center"
          >
            <template #default="{ row }">
              <el-tag
                :type="getStatusTagType(row.status)"
                size="small"
                effect="light"
              >
                {{ getStatusText(row.status) }}
              </el-tag>
            </template>
          </el-table-column>
        </el-table>

        <!-- 分页组件 -->
        <BasePagination
          v-if="loginLogs.length > 0"
          :current="pagination.current"
          :size="pagination.size"
          :total="pagination.total"
          @change="handlePageChange"
          @size-change="handlePageSizeChange"
        />
      </div>
    </BaseCard>
  </div>
</template>
```

### 2. 核心功能实现
```javascript
<script setup>
import { ref, reactive, computed, onMounted } from 'vue'
import { useI18n } from 'vue-i18n'
import { ElMessage, ElMessageBox } from 'element-plus'
import { BaseCard, BaseButton, BasePagination } from '@/components/Common'
import { changePassword, getLoginLogs } from '@/api/User'
import { validatePassword, validatePasswordLength } from '@/utils/validate'
import { formatDate } from '@/utils/date'
import { createLogger } from '@/utils/simpleLogger'
import { LOGIN_STATUS_TAG_CONFIG } from '@/utils/constants'

const { t } = useI18n()
const logger = createLogger('SecuritySettings')

// 响应式数据
const passwordFormRef = ref()
const changing = ref(false)
const logsLoading = ref(false)

// 密码表单
const passwordForm = reactive({
  oldPassword: '',
  newPassword: '',
  confirmPassword: ''
})

// 密码验证规则
const passwordRules = {
  oldPassword: [
    { required: true, message: t('user.security.oldPasswordRequired'), trigger: 'blur' }
  ],
  newPassword: [
    { required: true, message: t('user.security.newPasswordRequired'), trigger: 'blur' },
    { 
      validator: (rule, value, callback) => {
        if (!validatePasswordLength(value, 8, 32)) {
          callback(new Error(t('user.security.passwordMinLength')))
        } else if (!validatePassword(value)) {
          callback(new Error(t('user.security.passwordStrength')))
        } else {
          callback()
        }
      }, 
      trigger: 'blur' 
    }
  ],
  confirmPassword: [
    { required: true, message: t('user.security.confirmPasswordRequired'), trigger: 'blur' },
    {
      validator: (rule, value, callback) => {
        if (value !== passwordForm.newPassword) {
          callback(new Error(t('user.security.passwordMismatch')))
        } else {
          callback()
        }
      },
      trigger: 'blur'
    }
  ]
}

// 密码强度
const passwordStrength = ref(0)

const checkPasswordStrength = () => {
  const pwd = passwordForm.newPassword
  if (!pwd) {
    passwordStrength.value = 0
    return
  }

  let strength = 0

  // 长度检查
  if (pwd.length >= 8) strength++
  if (pwd.length >= 12) strength++

  // 包含数字
  if (/\d/.test(pwd)) strength++

  // 包含小写字母
  if (/[a-z]/.test(pwd)) strength++

  // 包含大写字母
  if (/[A-Z]/.test(pwd)) strength++

  // 包含特殊字符
  if (/[^a-zA-Z0-9]/.test(pwd)) strength++

  // 计算强度等级
  if (strength <= 2) {
    passwordStrength.value = 1 // 弱
  } else if (strength <= 4) {
    passwordStrength.value = 2 // 中
  } else {
    passwordStrength.value = 3 // 强
  }
}

const passwordStrengthLevel = computed(() => {
  const levels = ['', 'weak', 'medium', 'strong']
  return levels[passwordStrength.value]
})

const passwordStrengthText = computed(() => {
  const texts = ['', t('user.security.weak'), t('user.security.medium'), t('user.security.strong')]
  return texts[passwordStrength.value]
})

const passwordStrengthTips = computed(() => {
  switch (passwordStrength.value) {
    case 1:
      return t('user.security.weakTips')
    case 2:
      return t('user.security.mediumTips')
    case 3:
      return t('user.security.strongTips')
    default:
      return ''
  }
})

// 修改密码
const handleChangePassword = async () => {
  try {
    await passwordFormRef.value.validate()

    await ElMessageBox.confirm(
      t('user.security.changePasswordConfirm'),
      t('user.security.changePasswordTitle'),
      {
        confirmButtonText: t('common.confirm'),
        cancelButtonText: t('common.cancel'),
        type: 'warning'
      }
    )

    changing.value = true
    
    // TODO: 调用API修改密码
    // await changePassword({
    //   oldPassword: passwordForm.oldPassword,
    //   newPassword: passwordForm.newPassword
    // })
    
    // 模拟修改密码
    await new Promise(resolve => setTimeout(resolve, 1000))
    ElMessage.success(t('user.security.changePasswordSuccess'))
    
    // 清空表单
    passwordFormRef.value.resetFields()
    passwordStrength.value = 0
    
    // 跳转到登录页
    setTimeout(() => {
      // TODO: 实现跳转到登录页
      // router.push('/login')
      ElMessage.info(t('user.security.redirectToLogin'))
    }, 2000)
    
  } catch (error) {
    if (error !== 'cancel') {
      ElMessage.error(t('user.security.changePasswordError'))
    }
    changing.value = false
  }
}

// 重置密码表单
const handleResetPassword = () => {
  passwordFormRef.value.resetFields()
  passwordStrength.value = 0
}

// 登录日志数据
const loginLogs = ref([])

// 日志筛选
const logFilters = reactive({
  dateRange: [],
  status: 'all'
})

// 分页
const pagination = reactive({
  current: 1,
  size: 10,
  total: 0
})

// 模拟数据（后端完成后删除）
// const mockLoginLogs = [
//   {
//     id: 1,
//     loginTime: '2024-03-15 14:30:25',
//     ip: '192.168.1.100',
//     location: '北京市海淀区',
//     browser: 'Chrome 120',
//     os: 'Windows 10',
//     status: 'success'
//   },
//   {
//     id: 2,
//     loginTime: '2024-03-14 09:15:42',
//     ip: '192.168.1.100',
//     location: '北京市海淀区',
//     browser: 'Chrome 120',
//     os: 'Windows 10',
//     status: 'success'
//   },
//   {
//     id: 3,
//     loginTime: '2024-03-13 18:22:10',
//     ip: '101.201.45.123',
//     location: '上海市浦东新区',
//     browser: 'Safari 17',
//     os: 'macOS 14',
//     status: 'warning'
//   },
//   {
//     id: 4,
//     loginTime: '2024-03-12 08:45:33',
//     ip: '192.168.1.100',
//     location: '北京市海淀区',
//     browser: 'Chrome 120',
//     os: 'Windows 10',
//     status: 'success'
//   },
//   {
//     id: 5,
//     loginTime: '2024-03-11 16:20:15',
//     ip: '192.168.1.100',
//     location: '北京市海淀区',
//     browser: 'Chrome 120',
//     os: 'Windows 10',
//     status: 'success'
//   },
//   {
//     id: 6,
//     loginTime: '2024-03-10 11:10:08',
//     ip: '192.168.1.100',
//     location: '北京市海淀区',
//     browser: 'Chrome 119',
//     os: 'Windows 10',
//     status: 'failed'
//   }
// ]

// 过滤与分页建议由后端完成，这里直接展示后端返回的数据
const filteredLogs = computed(() => loginLogs.value)

const handleFilterChange = () => {
  pagination.current = 1
}

const handlePageChange = (page) => {
  pagination.current = page
}

const handlePageSizeChange = (size) => {
  pagination.size = size
  pagination.current = 1
}

const getStatusText = (status) => {
  const statusMap = {
    success: t('user.security.loginSuccess'),
    failed: t('user.security.loginFailed'),
    warning: t('user.security.abnormalLogin')
  }
  return statusMap[status] || status
}

const getStatusTagType = (status) => {
  return LOGIN_STATUS_TAG_CONFIG[status]?.type || 'info'
}

const loadLoginLogs = async () => {
  try {
    logsLoading.value = true
    
    // TODO: 调用API获取登录日志（由后端完成筛选与分页）
    // const response = await getLoginLogs({
    //   page: pagination.current,
    //   size: pagination.size,
    //   status: logFilters.status,
    //   startDate: logFilters.dateRange?.[0],
    //   endDate: logFilters.dateRange?.[1]
    // })
    // loginLogs.value = response.data.list
    // pagination.total = response.data.total
    
    // 临时模拟（后端完成后删除）
    // await new Promise(resolve => setTimeout(resolve, 500))
    // loginLogs.value = [...mockLoginLogs]
    // pagination.total = loginLogs.value.length
    
  } catch (error) {
    ElMessage.error(t('user.security.loadLogsError'))
  } finally {
    logsLoading.value = false
  }
}

onMounted(() => {
  loadLoginLogs()
})
</script>
```

### 3. 样式实现
```scss
<style lang="scss" scoped>
.security-container {
  padding: 20px;
  background: #f7f9fc;
  min-height: calc(100vh - 56px);
}

.page-header {
  margin-bottom: 20px;
}

.page-title {
  font-size: 24px;
  font-weight: 600;
  color: #1e3a8a;
  margin: 0;
}

.security-card {
  background: #ffffff;
  border-radius: 8px;
  padding: 24px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
  border: 1px solid #e5e7eb;
  margin-bottom: 20px;
}

.card-title {
  font-size: 18px;
  font-weight: 600;
  color: #374151;
  margin-bottom: 20px;
  padding-bottom: 12px;
  border-bottom: 1px solid #e5e7eb;
}

/* 密码表单样式 */
.password-form {
  max-width: 600px;
}

/* 密码强度指示器 */
.password-strength {
  margin-top: 8px;
}

.strength-bar {
  height: 6px;
  background: #e5e7eb;
  border-radius: 3px;
  overflow: hidden;
  margin-bottom: 8px;
}

.strength-fill {
  height: 100%;
  transition: all 0.3s;
  border-radius: 3px;
}

.strength-fill.weak {
  width: 33%;
  background: #dc2626;
}

.strength-fill.medium {
  width: 66%;
  background: #f59e0b;
}

.strength-fill.strong {
  width: 100%;
  background: #16a34a;
}

.strength-text {
  font-size: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.strength-level {
  font-weight: 500;
}

.strength-level.weak {
  color: #dc2626;
}

.strength-level.medium {
  color: #f59e0b;
}

.strength-level.strong {
  color: #16a34a;
}

.strength-tips {
  color: #6b7280;
}

/* 表单操作按钮 */
.form-actions {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-top: 32px;
  padding-top: 20px;
  border-top: 1px solid #e5e7eb;
}

/* 登录日志表格 */
.log-filters {
  display: flex;
  gap: 16px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.log-table {
  margin-top: 20px;
}

/* Element Plus表格样式覆盖 */
:deep(.el-table) {
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid #e5e7eb;
}

:deep(.el-table__header) {
  background: #f8fafc;
}

:deep(.el-table th) {
  background: #f8fafc;
  color: #374151;
  font-weight: 600;
  font-size: 14px;
  border-bottom: 1px solid #e5e7eb;
}

:deep(.el-table td) {
  font-size: 14px;
  color: #6b7280;
  border-bottom: 1px solid #e5e7eb;
}

:deep(.el-table--striped .el-table__body tr.el-table__row--striped td) {
  background: #fafbfc;
}

:deep(.el-table__body tr:hover > td) {
  background: #f8fafc;
}

:deep(.el-table__body tr:last-child td) {
  border-bottom: none;
}

/* 状态标签 */
:deep(.el-tag) {
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
  padding: 4px 12px;
}

:deep(.el-tag--success) {
  background: #dcfce7;
  color: #16a34a;
  border-color: #bbf7d0;
}

:deep(.el-tag--danger) {
  background: #fee2e2;
  color: #dc2626;
  border-color: #fecaca;
}

:deep(.el-tag--warning) {
  background: #fef3c7;
  color: #f59e0b;
  border-color: #fde68a;
}

/* 响应式设计 */
@media (max-width: 768px) {
  .security-container {
    padding: 16px;
  }
  
  .log-filters {
    flex-direction: column;
  }
  
  .log-filters .el-date-picker,
  .log-filters .el-select {
    width: 100% !important;
  }
  
  .form-actions {
    flex-direction: column;
    align-items: center;
  }
  
  :deep(.el-table) {
    font-size: 12px;
  }
  
  :deep(.el-table th),
  :deep(.el-table td) {
    padding: 8px 12px;
  }
}
</style>
```

## ⚠️ 重要注意事项

1. **密码强度检测**：实时检测密码强度，提供视觉反馈
2. **Element Plus表格**：使用`el-table`、`el-table-column`替代原生HTML表格
3. **登录日志**：支持状态筛选、日期范围筛选、分页
4. **状态标签**：使用`el-tag`组件显示登录状态
5. **分页组件**：使用`BasePagination`组件
6. **响应式设计**：移动端适配
7. **国际化支持**：所有文本使用$t()函数
8. **Mock数据**：包含TODO注释，便于后端集成

**最终要求：生成的代码必须与原型图的视觉效果和交互逻辑完全一致，特别是使用Element Plus表格组件替代原生HTML表格！**
