# 高校科研项目管理平台需求文档

## 目录

- [高校科研项目管理平台需求文档](#高校科研项目管理平台需求文档)
  - [目录](#目录)
  - [1. 引言](#1-引言)
    - [1.1 目的](#11-目的)
    - [1.2 范围](#12-范围)
    - [1.3 目标用户](#13-目标用户)
    - [1.4 术语与缩略语](#14-术语与缩略语)
  - [2. 总体系统描述](#2-总体系统描述)
  - [3. 功能需求](#3-功能需求)
    - [3.1 用户管理模块](#31-用户管理模块)
    - [3.2 申报模块](#32-申报模块)
      - [3.2.1 前端功能](#321-前端功能)
      - [3.2.2 后端功能](#322-后端功能)
    - [3.3 执行模块（项目管理）](#33-执行模块项目管理)
      - [3.3.1 前端功能](#331-前端功能)
      - [3.3.2 后端功能](#332-后端功能)
    - [3.4 验收模块](#34-验收模块)
      - [3.4.1 前端功能](#341-前端功能)
      - [3.4.2 后端功能](#342-后端功能)
  - [4. 非功能需求](#4-非功能需求)
    - [4.1 性能需求](#41-性能需求)
    - [4.2 安全性需求](#42-安全性需求)
    - [4.3 可用性需求](#43-可用性需求)
    - [4.4 可扩展性需求](#44-可扩展性需求)
    - [4.5 可维护性需求](#45-可维护性需求)
    - [4.6 兼容性需求](#46-兼容性需求)
  - [5. 技术架构](#5-技术架构)
    - [5.1 总体架构](#51-总体架构)
    - [5.2 技术栈](#52-技术栈)
      - [5.2.1 前端技术栈](#521-前端技术栈)
      - [5.2.2 后端技术栈](#522-后端技术栈)
  - [6. 数据交互与 Dify 工作流](#6-数据交互与-dify-工作流)
  - [7. 参考文献](#7-参考文献)

---

## 1. 引言

### 1.1 目的

本需求文档旨在详细描述高校科研项目管理平台的功能需求、非功能需求以及技术架构。该平台将为高校科研人员提供从项目申报、执行到验收的全生命周期管理服务，旨在提升科研项目管理的效率和智能化水平。通过本平台，科研人员可以便捷地进行项目申报、实验数据和文献资料的上传与管理、科研成果的展示与检索，并最终自动化生成项目验收报告。本文档将作为平台开发、测试和部署的指导性文件。

### 1.2 范围

本平台的核心功能涵盖科研项目的申报、执行（项目管理）和验收三大阶段。具体包括：

- **申报模块：** 支持用户在线填写研究方向和研究领域，并触发 Dify 工作流进行申报。
- **执行模块：** 提供文件上传（支持多种格式）、Dify 知识库存储与检索、文件预览等功能，实现科研数据的集中管理。
- **验收模块：** 支持自动化生成科技报告和自评报告，报告数据来源于执行阶段上传的资料，并通过 Dify 工作流进行编排生成。

### 1.3 目标用户

- **科研人员：** 项目负责人、团队成员，主要使用申报、执行、验收功能。
- **科研管理部门：** 负责项目审批、进度监督、成果管理、验收审核等。
- **Dify 管理员：** 负责 Dify 工作流和知识库的配置与维护。

### 1.4 术语与缩略语

| 术语/缩略语     | 解释                                                     |
| --------------- | -------------------------------------------------------- |
| Dify            | 一个 LLM 应用开发平台，用于编排工作流和管理知识库。      |
| LLM             | Large Language Model，大型语言模型。                     |
| Vue.js          | 一种用于构建用户界面的渐进式 JavaScript 框架。           |
| SpringBoot      | 一种用于简化 Spring 应用开发和部署的框架。               |
| PostgreSQL      | 一种功能强大的开源对象-关系型数据库系统。                |
| Redis           | 一种高性能的键值存储，常用于缓存和消息队列。             |
| LangChain4j     | Java 语言的 LLM 应用开发框架，用于与 LLM 进行交互。      |
| Kafka           | 一种分布式流处理平台，用于构建实时数据管道和流应用程序。 |
| Minio           | 一种高性能、兼容 Amazon S3 的对象存储服务。              |
| Vector Database | 向量数据库，用于存储和检索向量嵌入，支持语义搜索。       |
| UI              | User Interface，用户界面。                               |
| API             | Application Programming Interface，应用程序编程接口。    |

## 2. 总体系统描述

高校科研项目管理平台是一个基于前后端分离架构的 Web 应用系统，旨在为高校科研活动提供全面的信息化支持。系统以 Dify 工作流为核心，实现科研项目从申报、执行到验收的智能化、自动化管理。前端采用 Vue.js 技术栈，提供直观友好的用户界面；后端采用 Java 11 和 SpringBoot 构建，提供稳定高效的服务。平台将集成多种先进技术，如对象存储（Minio）、向量数据库、消息队列（Kafka）等，确保系统的高性能、可扩展性和数据安全性。

## 3. 功能需求

### 3.1 用户管理模块

用户管理模块是平台的基础，负责用户身份的识别、权限的分配与管理，确保系统安全与数据隔离。

- **用户注册与登录：** 平台应支持科研人员通过学工号/教工号等进行注册和登录。系统将集成**Sa-Token**框架，提供安全、高效的认证服务。
- **角色与权限管理：** 系统需区分科研人员、科研管理人员等不同角色，并根据角色分配相应的功能模块和数据访问权限，实现精细化的权限控制。
- **个人信息管理：** 用户登录后可查看和修改个人基本信息，如联系方式、所属院系等。

### 3.2 申报模块

申报模块是科研项目生命周期的起点，主要负责接收科研人员的项目申报信息，并触发 Dify 工作流进行初步处理。高校科研项目申报流程通常包括前期准备、项目申请书撰写、项目评审与立项等环节 [1]。

#### 3.2.1 前端功能

- **项目申报入口：** 提供清晰的界面入口，引导用户开始申报流程。
- **申报信息填写：** 包含“研究方向”和“研究领域”两个必填文本输入框，用户需在此处输入相关信息。
- **“开始执行”按钮：** 用户完成信息填写后，点击此按钮触发项目申报流程。
- **申报状态显示：** 实时向用户反馈 Dify 工作流的执行状态，例如“申报中”、“申报成功”、“申报失败”等提示信息。
- **历史申报记录：** 展示用户提交过的所有项目申报列表，包括项目名称、申报时间、当前状态等。

#### 3.2.2 后端功能

- **申报 API 接口：** 提供 RESTful API 接收前端提交的申报请求。
- **输入参数校验：** 对接收到的“研究方向”和“研究领域”字段进行数据格式、长度和内容有效性校验，确保数据质量。
- **Dify 工作流调用：**
  - 后端服务将用户输入的“研究方向”和“研究领域”封装为参数。
  - 通过**LangChain4j**调用 Dify 平台中预先编排好的“申报工作流 API”。
  - 处理 Dify 工作流返回的结果，包括申报成功/失败状态、Dify 生成的项目唯一标识符（项目 ID）等。
- **申报数据存储：** 将申报请求的关键信息（如用户 ID、研究方向、研究领域、Dify 项目 ID、申报状态、时间戳等）持久化存储到**PostgreSQL**数据库中。
- **异步通知机制（可选）：** 对于耗时较长的申报处理，可通过**Kafka**消息队列发送处理状态通知，实现异步响应，提升用户体验。

### 3.3 执行模块（项目管理）

执行模块是科研项目管理的核心，旨在为科研人员提供一个集中管理项目数据、文献资料和科研进展的平台，并充分利用 Dify 知识库的强大能力。科研项目执行过程中会产生大量的实验数据、历史数据、文献资料等，这些数据需要有效的管理和共享机制 [2]。

#### 3.3.1 前端功能

- **项目列表展示：** 清晰展示用户当前正在执行或已申报成功的项目列表，每个项目包含名称、当前状态、关键进度指标等。
- **文件上传界面：** 提供直观易用的文件上传功能，支持用户批量上传多种格式的科研资料，包括但不限于 doc、docx、xlsx、pdf、jpg、png 等文件类型。
- **已上传文件列表：** 展示特定项目下所有已上传的文件，并提供文件名称、上传时间、文件类型等信息。
- **文件在线预览：** 支持用户点击文件列表中的文件进行在线预览，无需下载到本地。
- **知识库搜索功能：** 提供一个搜索框，允许用户输入关键词在 Dify 知识库中检索相关文件或内容，支持模糊搜索和精确匹配。
- **知识库搜索结果展示：** 以列表形式展示搜索结果，并支持点击结果查看文件详情或直接进行预览。
- **项目进度更新：** 提供界面供用户手动更新项目执行的阶段性进展和状态。

#### 3.3.2 后端功能

- **文件上传 API：** 提供 RESTful API 接收前端上传的文件。
- **文件存储服务：**
  - 接收到文件后，首先将文件上传至**Minio**对象存储服务，并获取文件在 Minio 中的存储路径。
  - 将文件元数据（如文件名、Minio 路径、文件类型、上传用户、上传时间、关联项目 ID 等）存储到**PostgreSQL**数据库。
- **Dify 知识库集成：**
  - 通过**LangChain4j**调用 Dify 知识库 API，将上传文件的内容（或其向量嵌入表示）和相关元数据同步至 Dify 知识库。
  - 确保 Dify 知识库中的数据与项目 ID 进行关联，便于后续检索和报告生成。
- **文件管理 API：** 提供文件删除、文件元数据修改等管理接口。
- **知识库检索 API：**
  - 接收前端的搜索请求（关键词）。
  - 通过**LangChain4j**调用 Dify 知识库的检索 API，执行语义搜索或关键词匹配，获取相关文件或内容片段。
  - 将 Dify 返回的检索结果进行处理并返回给前端。
- **文件预览链接生成：** 根据存储在 Minio 中的文件路径，生成临时的、带权限验证的文件访问 URL，供前端进行在线预览。
- **项目状态与进度管理：** 更新项目在**PostgreSQL**数据库中的执行状态和进度信息。

### 3.4 验收模块

验收模块是科研项目生命周期的收尾阶段，核心功能是根据执行阶段积累的数据，自动化生成科技报告和自评报告，并支持用户进行管理。验收通常依据项目合同和申报书确定的研究内容和技术指标进行，侧重对项目研究成果的水平与质量进行评议 [3]。

#### 3.4.1 前端功能

- **验收申请入口：** 提供清晰的界面，引导用户进入项目验收流程。
- **报告生成触发：** 提供“生成科技报告”和“生成自评报告”按钮，用户点击后触发报告生成流程。
- **报告预览与下载：** 报告生成完成后，提供在线预览功能，并支持用户将报告下载到本地。
- **验收状态跟踪：** 实时显示项目的验收进度和当前状态。
- **历史报告列表：** 展示项目已生成的所有报告列表，包括报告类型、生成时间、状态等。

#### 3.4.2 后端功能

- **报告生成 API：** 提供 RESTful API 接收前端的报告生成请求（包含项目 ID、报告类型）。
- **Dify 工作流调用：**
  - 后端服务通过**LangChain4j**调用 Dify 平台中预先编排好的“科技报告生成工作流 API”或“自评报告生成工作流 API”。
  - Dify 工作流将自动从其知识库中获取指定项目在执行阶段上传的所有相关数据和文档。
  - Dify 工作流根据预设的逻辑、模板和规则（可能涉及文本分析、数据聚合、内容总结、引用管理等）生成报告内容，特别是支持生成百万字级别的科技报告。
  - Dify 将生成的报告内容返回给后端服务。
- **报告存储：** 后端将 Dify 返回的报告内容存储到**Minio**对象存储中，并记录报告的元数据（如报告类型、Minio 路径、生成时间、关联项目 ID 等）到**PostgreSQL**数据库。
- **报告下载链接生成：** 根据存储在 Minio 中的报告路径，生成下载链接，供前端用户下载。
- **验收状态更新：** 更新项目在**PostgreSQL**数据库中的验收状态。
- **异步处理：** 报告生成通常是耗时操作，后端可利用**Kafka**消息队列将报告生成任务进行异步处理，避免前端长时间等待，并通过 WebSocket 或轮询机制通知前端任务完成状态。

## 4. 非功能需求

### 4.1 性能需求

- **响应时间：** 大部分用户操作（如页面加载、数据查询）应在 3 秒内响应。
- **并发用户数：** 系统应支持至少 500 个并发用户。
- **文件上传速度：** 单个文件上传速度应在合理范围内，大文件上传应支持断点续传。
- **报告生成时间：** 科技报告（百万字）的生成时间应控制在可接受范围内，并提供异步处理机制。

### 4.2 安全性需求

- **用户认证与授权：** 采用 Sa-Token 框架，实现基于角色的访问控制，确保数据隔离和权限最小化。
- **数据加密：** 敏感数据（如用户密码）应进行加密存储和传输。
- **文件存储安全：** Minio 存储应配置访问控制和数据备份机制。
- **API 安全：** 所有 API 接口应进行身份验证和授权检查，防止未授权访问。
- **日志审计：** 记录关键操作日志，便于安全审计和问题追溯。

### 4.3 可用性需求

- **系统稳定性：** 系统年可用性应达到 99.9%以上。
- **容错性：** 系统应具备故障恢复能力，例如数据库主从复制、服务集群部署。
- **备份与恢复：** 定期对数据库和文件存储进行备份，并具备快速恢复能力。

### 4.4 可扩展性需求

- **模块化设计：** 系统采用模块化设计，便于新功能扩展和现有功能升级。
- **微服务架构（可选）：** 考虑未来业务增长，可逐步演进为微服务架构。
- **Dify 工作流扩展：** Dify 工作流应易于配置和扩展，以适应未来科研业务流程的变化。

### 4.5 可维护性需求

- **代码规范：** 遵循统一的编码规范和开发标准。
- **文档完善：** 提供详细的开发文档、API 文档和部署手册。
- **监控与告警：** 部署系统监控和告警机制，及时发现和解决问题。

### 4.6 兼容性需求

- **浏览器兼容：** 支持主流浏览器（Chrome, Firefox, Edge, Safari）的最新版本。
- **文件格式兼容：** 支持 doc、docx、xlsx、pdf、jpg、png 等常见文件格式的上传、存储和预览。

## 5. 技术架构

### 5.1 总体架构

平台采用前后端分离的架构模式，通过 RESTful API 进行通信。核心业务逻辑由后端处理，并深度集成 Dify 平台进行智能化工作流编排和知识库管理。Minio 作为统一的文件存储服务，PostgreSQL 作为关系型数据库，Redis 提供缓存和会话管理，Kafka 用于异步消息处理。

```mermaid
graph TD
    A[用户] -->|访问| B[前端应用 (Vue.js)]
    B -->|API请求 (Axios)| C[后端服务 (SpringBoot)]

    C -->|数据存储/查询| D[PostgreSQL]
    C -->|缓存/会话| E[Redis]
    C -->|文件存储| F[Minio]
    C -->|异步消息| G[Kafka]
    C -->|LLM集成 (LangChain4j)| H[Dify平台]

    H -->|知识库管理| I[Dify知识库 (Vector Database)]
    H -->|工作流编排| J[Dify工作流引擎]

    subgraph 前端
        B
    end

    subgraph 后端
        C
        D
        E
        F
        G
    end

    subgraph AI平台
        H
        I
        J
    end
```

### 5.2 技术栈

#### 5.2.1 前端技术栈

| 技术                        | 版本/说明  | 用途                                          |
| --------------------------- | ---------- | --------------------------------------------- |
| Vue.js                      | 最新稳定版 | 核心 JavaScript 框架，用于构建用户界面。      |
| Vue Router                  | 最新稳定版 | Vue.js 官方路由管理器，实现单页面应用导航。   |
| Vuex                        | 最新稳定版 | Vue.js 官方状态管理库，集中管理应用状态。     |
| Element UI / Ant Design Vue | 最新稳定版 | UI 组件库，提供丰富的界面组件，加速开发。     |
| Axios                       | 最新稳定版 | 基于 Promise 的 HTTP 客户端，用于前后端通信。 |

#### 5.2.2 后端技术栈

| 技术            | 版本/说明           | 用途                                         |
| --------------- | ------------------- | -------------------------------------------- |
| Java            | 11 (LTS)            | 编程语言，提供稳定高效的后端服务。           |
| SpringBoot      | 最新稳定版          | 快速构建 Spring 应用的框架，简化配置和部署。 |
| PostgreSQL      | 最新稳定版          | 关系型数据库，存储结构化数据。               |
| Redis           | 最新稳定版          | 内存数据库，用于缓存、会话管理。             |
| LangChain4j     | 最新稳定版          | LLM 集成框架，简化与 Dify 平台的交互。       |
| Kafka           | 最新稳定版          | 消息队列，用于异步通信和解耦。               |
| Maven           | 最新稳定版          | 项目管理和构建工具。                         |
| MybatisPlus     | 最新稳定版          | Mybatis 增强工具，简化数据库操作。           |
| Sa-Token        | 最新稳定版          | 轻量级 Java 权限认证框架，处理认证与授权。   |
| Minio           | 最新稳定版          | 对象存储服务，存储非结构化文件。             |
| Vector Database | Dify 内置或独立部署 | 向量数据库，支持 Dify 知识库的语义搜索。     |

## 6. 数据交互与 Dify 工作流

Dify 平台是本系统的核心组成部分，负责处理复杂的业务逻辑和智能化任务，特别是数据交互和报告生成。以下是 Dify 在各阶段的集成方式：

- **申报阶段：** 用户在前端输入“研究方向”和“研究领域”后，后端调用 Dify 的申报工作流 API。Dify 工作流根据预设逻辑处理申报信息，并返回结果。
- **执行阶段：** 用户上传文件至平台后，后端将文件存储至 Minio，并调用 Dify 知识库 API 将文件内容（或其向量嵌入）同步至 Dify 知识库。知识库的展示、搜索和文件预览功能均通过后端调用 Dify 知识库 API 实现。
- **验收阶段：** 验收报告（科技报告、自评报告）的生成是本系统的关键功能。后端调用 Dify 编排好的报告生成工作流 API。Dify 工作流将从其知识库中获取执行阶段上传的所有相关数据和文档，并利用其强大的 LLM 能力进行分析、整合、总结，最终生成百万字级别的科技报告和自评报告。

这种集成方式确保了平台能够充分利用 Dify 的 AI 能力，实现科研项目管理流程的智能化和自动化，同时保持系统架构的灵活性和可扩展性。

## 7. 参考文献

[1] 特讯信息咨询. (2024, December 2). 高校科研项目申报流程\_高校科研项目申报流程及时间. Retrieved from https://www.sztexun.net/article/7477.html
[2] 赵怡, 郑杰欣. (2019). 高校科研管理系统信息共享机制研究. 中国管理信息化, 22(20), 175-176. Retrieved from http://library.ttcdw.com/dev/upload/webUploader/201911/1573455674700e6a50a5fff693.pdf
[3] 河北省高等学校科学技术研究项目验收流程. (n.d.). Retrieved from https://www1.hebeinu.edu.cn/keyanchu/index.php?s=/Show/index/cid/17/id/10.html
