<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>交互-加载与反馈</title>
    <link rel="icon" href="../images/favicon.ico" type="image/x-icon" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/element-plus/dist/index.css"
    />
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://unpkg.com/element-plus"></script>
    <link rel="stylesheet" href="样式.css" />
  </head>
  <body>
    <div id="app" class="content">
      <div class="card">
        <h3 class="title">加载与反馈（示例）</h3>
        <el-button type="primary" @click="globalLoading">全局加载</el-button>
        <el-button @click="success">成功提示</el-button>
        <el-button type="danger" @click="error">失败提示</el-button>
        <el-button type="warning" @click="undo">可撤销操作</el-button>
      </div>
    </div>
    <script>
      const { createApp } = Vue;
      createApp({
        setup() {
          const globalLoading = () => {
            const l = ElLoading.service({ text: "加载中..." });
            setTimeout(() => l.close(), 1200);
          };
          const success = () => ElMessage.success("操作成功");
          const error = () => ElMessage.error("操作失败");
          const undo = () => {
            let undone = false;
            ElMessage({
              type: "warning",
              showClose: true,
              duration: 5000,
              message: "已删除，5秒内可撤销",
              onClose: () => {
                if (!undone) console.log("最终生效");
              },
            });
            setTimeout(() => {
              if (!undone) {
                /* 可执行最终删除 */
              }
            }, 5000);
          };
          return { globalLoading, success, error, undo };
        },
      }).mount("#app");
    </script>
  </body>
</html>
