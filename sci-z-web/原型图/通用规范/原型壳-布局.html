<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>é«˜æ ¡ç§‘ç ”é¡¹ç›®ç®¡ç†å¹³å°</title>
    <link rel="icon" href="../images/favicon.ico" type="image/x-icon" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/element-plus/dist/index.css"
    />
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://unpkg.com/element-plus"></script>
    <script src="https://unpkg.com/@element-plus/icons-vue@2.3.1/dist/index.iife.js"></script>
    <!-- <script>
      // å¤‡ç”¨å›¾æ ‡åŠ è½½æ–¹æ¡ˆ
      if (typeof ElementPlusIconsVue === "undefined") {
        console.warn("Element Plus Icons not loaded, using fallback icons");
        window.ElementPlusIconsVue = {
          Odometer: "ğŸ›ï¸",
          Document: "ğŸ“„",
          List: "ğŸ“‹",
          Plus: "â•",
          View: "ğŸ‘ï¸",
          Folder: "ğŸ“",
          TrendCharts: "ğŸ“ˆ",
          Setting: "âš™ï¸",
          User: "ğŸ‘¤",
          Key: "ğŸ”‘",
          ChatDotRound: "ğŸ’­",
          Search: "ğŸ”",
          ChatDotSquare: "ğŸ’¬",
          FolderOpened: "ğŸ“‚",
          UserFilled: "ğŸ‘¤",
          Refresh: "ğŸ”„",
          DataAnalysis: "ğŸ“Š",
          Monitor: "ğŸ–¥ï¸",
          Check: "âœ…",
          ChatLineRound: "ğŸ’­",
          ChatLineSquare: "ğŸ’¬",
        };
      }
    </script> -->
    <link rel="stylesheet" href="æ ·å¼.css" />
    <style>
      /* èœå•å­—ä½“åŒºåˆ†æ ·å¼ - ä½¿ç”¨åœ†æ¶¦å­—ä½“ */
      .el-menu .el-sub-menu__title {
        font-family: "Inter", "SF Pro Display", -apple-system,
          BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial,
          sans-serif !important;
        font-size: 15px !important;
        font-weight: 400 !important;
        color: #374151 !important;
        padding: 0 20px !important;
        letter-spacing: 0.01em !important;
        height: 48px !important;
        line-height: 48px !important;
      }

      .el-menu .el-sub-menu__title:hover {
        background-color: #f8fafc !important;
        color: #1e3a8a !important;
      }

      .el-menu .el-menu-item {
        font-size: 12px !important;
        font-weight: 400 !important;
        color: #6b7280 !important;
        padding: 0 20px 0 56px !important;
        height: 40px !important;
        line-height: 40px !important;
        margin: 2px 8px !important;
        border-radius: 6px !important;
      }

      .el-menu .el-menu-item:hover {
        background-color: #f0f9ff !important;
        color: #1e3a8a !important;
      }

      .el-menu .el-menu-item.is-active {
        background-color: #1e3a8a !important;
        color: #ffffff !important;
        font-weight: 600 !important;
        border-radius: 12px !important;
        margin: 2px 8px !important;
      }

      .el-menu .el-menu-item .el-icon {
        margin-right: 8px !important;
        font-size: 16px !important;
      }

      .el-menu .el-sub-menu__title .el-icon {
        margin-right: 8px !important;
        font-size: 16px !important;
      }

      /* ä¸€çº§èœå•é¡¹æ ·å¼ï¼ˆå¦‚ä»ªè¡¨æ¿ï¼‰ */
      .el-menu .el-menu-item:not(.el-sub-menu__title) {
        font-family: "Inter", "SF Pro Display", -apple-system,
          BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial,
          sans-serif !important;
        font-size: 15px !important;
        font-weight: 400 !important;
        color: #374151 !important;
        padding: 0 20px !important;
        height: 48px !important;
        line-height: 48px !important;
        letter-spacing: 0.01em !important;
        margin: 2px 8px !important;
        border-radius: 6px !important;
      }

      /* ä¸€çº§èœå•é¡¹æ‚¬åœæ•ˆæœ */
      .el-menu .el-menu-item:not(.el-sub-menu__title):hover {
        background-color: #f8fafc !important;
        color: #1e3a8a !important;
      }

      /* ä¸€çº§èœå•é¡¹é€‰ä¸­çŠ¶æ€ */
      .el-menu .el-menu-item:not(.el-sub-menu__title).is-active {
        background-color: #1e3a8a !important;
        color: #ffffff !important;
        font-weight: 600 !important;
        border-radius: 12px !important;
        margin: 2px 8px !important;
      }

      .el-menu {
        border-right: none !important;
        overflow-x: hidden !important;
      }

      /* éšè—æ°´å¹³æ»šåŠ¨æ¡ */
      .sidebar {
        overflow-x: hidden !important;
      }

      .el-menu--collapse {
        overflow-x: hidden !important;
      }

      /* Emojiå›¾æ ‡æ ·å¼ */
      .menu-icon {
        margin-right: 8px !important;
        font-size: 16px !important;
        display: inline-block;
        width: 16px;
        text-align: center;
      }

      /* æŠ˜å æŒ‰é’®æ ·å¼ */
      .menu-toggle-btn {
        position: absolute;
        top: 60px;
        right: -15px;
        width: 30px;
        height: 30px;
        background: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transition: all 0.3s;
        z-index: 1000;
      }

      .menu-toggle-btn:hover {
        background: #f8fafc;
        border-color: #1e3a8a;
        color: #1e3a8a;
      }

      .menu-toggle-btn .el-icon {
        font-size: 14px;
        transition: transform 0.3s;
      }

      /* ä¾§è¾¹æ å®¹å™¨ */
      .sidebar {
        position: relative;
        transition: width 0.3s;
      }

      .sidebar.collapsed {
        width: 64px !important;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <div class="layout">
        <div class="header">
          <div class="logo">
            <img src="../images/logo.svg" alt="Logo" />é«˜æ ¡ç§‘ç ”ç®¡ç†å¹³å°
          </div>
          <div class="header-right">
            <el-dropdown @command="handleCommand">
              <span class="user-info">
                <el-avatar :size="32" src="../images/favicon.ico"></el-avatar>
                <span>ç®¡ç†å‘˜</span>
              </span>
              <template #dropdown>
                <el-dropdown-menu>
                  <el-dropdown-item command="profile"
                    >ä¸ªäººä¸­å¿ƒ</el-dropdown-item
                  >
                  <el-dropdown-item divided command="logout"
                    >é€€å‡ºç™»å½•</el-dropdown-item
                  >
                </el-dropdown-menu>
              </template>
            </el-dropdown>
          </div>
        </div>
        <div class="main">
          <div class="sidebar" :class="{ collapsed: collapsed }">
            <el-menu
              :default-active="activeMenu"
              :collapse="collapsed"
              @select="handleMenuSelect"
            >
              <!-- è®¤è¯æ¨¡å—èœå•å·²éšè— - ç™»å½•æˆåŠŸåä¸å†æ˜¾ç¤º -->
              <!-- <el-sub-menu index="auth">
                <template #title>
                  <el-icon><User /></el-icon>
                  <span>è®¤è¯æ¨¡å—</span>
                </template>
                <el-menu-item index="auth/login">
                  <el-icon><Key /></el-icon>
                  <span>ç™»å½•</span>
                </el-menu-item>
                <el-menu-item index="auth/register">
                  <el-icon><UserFilled /></el-icon>
                  <span>æ³¨å†Œ</span>
                </el-menu-item>
                <el-menu-item index="auth/reset-password">
                  <el-icon><Refresh /></el-icon>
                  <span>é‡ç½®å¯†ç </span>
                </el-menu-item>
              </el-sub-menu> -->

              <el-menu-item index="dashboard">
                <el-icon><Odometer /></el-icon>
                <span>ä»ªè¡¨æ¿</span>
              </el-menu-item>

              <el-sub-menu index="declaration">
                <template #title>
                  <el-icon><Document /></el-icon>
                  <span>ç”³æŠ¥ç®¡ç†</span>
                </template>
                <el-menu-item index="declaration/list">
                  <el-icon><List /></el-icon>
                  <span>ç”³æŠ¥åˆ—è¡¨</span>
                </el-menu-item>
                <!-- éšè—æ–°å»ºç”³æŠ¥å’Œç”³æŠ¥è¯¦æƒ…å­èœå• -->
                <!-- <el-menu-item index="declaration/create">
                  <el-icon><Plus /></el-icon>
                  <span>æ–°å»ºç”³æŠ¥</span>
                </el-menu-item>
                <el-menu-item index="declaration/detail">
                  <el-icon><View /></el-icon>
                  <span>ç”³æŠ¥è¯¦æƒ…</span>
                </el-menu-item> -->
              </el-sub-menu>

              <el-sub-menu index="project">
                <template #title>
                  <el-icon><Folder /></el-icon>
                  <span>é¡¹ç›®ç®¡ç†</span>
                </template>
                <el-menu-item index="project/list">
                  <el-icon><List /></el-icon>
                  <span>é¡¹ç›®åˆ—è¡¨</span>
                </el-menu-item>
                <!-- <el-menu-item index="project/detail">
                  <el-icon><View /></el-icon>
                  <span>é¡¹ç›®è¯¦æƒ…</span>
                </el-menu-item>
                <el-menu-item index="project/progress">
                  <el-icon><TrendCharts /></el-icon>
                  <span>é¡¹ç›®è¿›åº¦</span>
                </el-menu-item> -->
              </el-sub-menu>

              <el-sub-menu index="acceptance">
                <template #title>
                  <el-icon><Check /></el-icon>
                  <span>éªŒæ”¶ç®¡ç†</span>
                </template>
                <!-- <el-menu-item index="acceptance/list">
                  <el-icon><List /></el-icon>
                  <span>æŠ¥å‘Šåˆ—è¡¨</span>
                </el-menu-item> -->
                <el-menu-item index="acceptance/report">
                  <el-icon><List /></el-icon>
                  <span>æŠ¥å‘Šç®¡ç†</span>
                </el-menu-item>
                <!-- <el-menu-item index="acceptance/generate">
                  <el-icon><Plus /></el-icon>
                  <span>æŠ¥å‘Šç”Ÿæˆ</span>
                </el-menu-item> -->
              </el-sub-menu>

              <el-sub-menu index="ai">
                <template #title>
                  <el-icon><Monitor /></el-icon>
                  <span>AIåŠ©æ‰‹</span>
                </template>
                <el-menu-item index="ai/knowledge">
                  <el-icon><Reading /></el-icon>
                  <span>çŸ¥è¯†åº“</span>
                </el-menu-item>
                <el-menu-item index="ai/chat">
                  <el-icon><Avatar /></el-icon>
                  <span>AIå¯¹è¯</span>
                </el-menu-item>
              </el-sub-menu>

              <el-sub-menu index="user">
                <template #title>
                  <el-icon><User /></el-icon>
                  <span>ç”¨æˆ·ä¸­å¿ƒ</span>
                </template>
                <el-menu-item index="user/profile">
                  <el-icon><House /></el-icon>
                  <span>ä¸ªäººä¿¡æ¯</span>
                </el-menu-item>
                <el-menu-item index="user/security">
                  <el-icon><Lock /></el-icon>
                  <span>å®‰å…¨è®¾ç½®</span>
                </el-menu-item>
              </el-sub-menu>

              <el-sub-menu index="system">
                <template #title>
                  <el-icon><Setting /></el-icon>
                  <span>ç³»ç»Ÿç®¡ç†</span>
                </template>
                <el-menu-item index="system/user">
                  <el-icon><User /></el-icon>
                  <span>ç”¨æˆ·ç®¡ç†</span>
                </el-menu-item>
                <el-menu-item index="system/role">
                  <el-icon><Key /></el-icon>
                  <span>è§’è‰²æƒé™</span>
                </el-menu-item>
                <el-menu-item index="system/config">
                  <el-icon><Setting /></el-icon>
                  <span>ç³»ç»Ÿé…ç½®</span>
                </el-menu-item>
                <el-menu-item index="system/logs">
                  <el-icon><Document /></el-icon>
                  <span>æ—¥å¿—ç®¡ç†</span>
                </el-menu-item>
              </el-sub-menu>
            </el-menu>
            <!-- æŠ˜å æŒ‰é’® -->
            <div class="menu-toggle-btn" @click="toggleMenu">
              <el-icon>
                <component :is="collapsed ? 'Expand' : 'Fold'" />
              </el-icon>
            </div>
          </div>
          <div class="content">
            <div class="breadcrumb">
              <el-breadcrumb separator="/"
                ><el-breadcrumb-item>é¦–é¡µ</el-breadcrumb-item
                ><el-breadcrumb-item v-for="item in breadcrumbs" :key="item"
                  >{{item}}</el-breadcrumb-item
                ></el-breadcrumb
              >
            </div>
            <div class="page-content">
              <iframe
                :src="currentPage"
                frameborder="0"
                width="100%"
                height="100%"
              ></iframe>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      const { createApp, ref, computed } = Vue;
      const { ElMessage } = ElementPlus;
      const {
        Odometer,
        Document,
        List,
        Plus,
        View,
        Folder,
        TrendCharts,
        Setting,
        User,
        Key,
        ChatDotRound,
        Reading,
        ChatDotSquare,
        FolderOpened,
        UserFilled,
        Refresh,
        DataAnalysis,
        Monitor,
        Check,
        ChatLineRound,
        ChatLineSquare,
        Fold,
        Expand,
        Avatar,
        Lock,
        House,
      } = ElementPlusIconsVue;

      createApp({
        components: {
          Odometer,
          Document,
          List,
          Plus,
          View,
          Folder,
          TrendCharts,
          Setting,
          User,
          Key,
          ChatDotRound,
          Reading,
          ChatDotSquare,
          FolderOpened,
          UserFilled,
          Refresh,
          DataAnalysis,
          Monitor,
          Check,
          ChatLineRound,
          ChatLineSquare,
          Fold,
          Expand,
          Avatar,
          Lock,
          House,
        },
        setup() {
          const activeMenu = ref("dashboard");
          const collapsed = ref(false);
          const currentPage = ref("../ä»ªè¡¨æ¿/ä»ªè¡¨æ¿.html");
          const breadcrumbs = ref(["ä»ªè¡¨æ¿"]);

          const menuMap = {
            "auth/login": {
              page: "../è®¤è¯æ¨¡å—/ç™»å½•.html",
              breadcrumb: ["è®¤è¯", "ç™»å½•"],
            },
            "auth/register": {
              page: "../è®¤è¯æ¨¡å—/æ³¨å†Œ.html",
              breadcrumb: ["è®¤è¯", "æ³¨å†Œ"],
            },
            "auth/reset-password": {
              page: "../è®¤è¯æ¨¡å—/é‡ç½®å¯†ç .html",
              breadcrumb: ["è®¤è¯", "é‡ç½®å¯†ç "],
            },
            "user/profile": {
              page: "../ç”¨æˆ·ä¸­å¿ƒ/ä¸ªäººä¿¡æ¯.html",
              breadcrumb: ["ç”¨æˆ·ä¸­å¿ƒ", "ä¸ªäººä¿¡æ¯"],
            },
            "user/security": {
              page: "../ç”¨æˆ·ä¸­å¿ƒ/å®‰å…¨è®¾ç½®.html",
              breadcrumb: ["ç”¨æˆ·ä¸­å¿ƒ", "å®‰å…¨è®¾ç½®"],
            },
            dashboard: {
              page: "../ä»ªè¡¨æ¿/ä»ªè¡¨æ¿.html",
              breadcrumb: ["ä»ªè¡¨æ¿"],
            },
            "declaration/list": {
              page: "../ç”³æŠ¥æ¨¡å—/ç”³æŠ¥åˆ—è¡¨.html",
              breadcrumb: ["ç”³æŠ¥ç®¡ç†", "ç”³æŠ¥åˆ—è¡¨"],
            },
            "declaration/create": {
              page: "../ç”³æŠ¥æ¨¡å—/æ–°å»ºç”³æŠ¥.html",
              breadcrumb: ["ç”³æŠ¥ç®¡ç†", "æ–°å»ºç”³æŠ¥"],
            },
            "declaration/detail": {
              page: "../ç”³æŠ¥æ¨¡å—/ç”³æŠ¥è¯¦æƒ….html",
              breadcrumb: ["ç”³æŠ¥ç®¡ç†", "ç”³æŠ¥è¯¦æƒ…"],
            },
            "project/create": {
              page: "../é¡¹ç›®æ¨¡å—/æ–°å»ºé¡¹ç›®.html",
              breadcrumb: ["é¡¹ç›®ç®¡ç†", "æ–°å»ºé¡¹ç›®"],
            },
            "project/list": {
              page: "../é¡¹ç›®æ¨¡å—/é¡¹ç›®åˆ—è¡¨.html",
              breadcrumb: ["é¡¹ç›®ç®¡ç†", "é¡¹ç›®åˆ—è¡¨"],
            },
            "project/detail": {
              page: "../é¡¹ç›®æ¨¡å—/é¡¹ç›®è¯¦æƒ….html",
              breadcrumb: ["é¡¹ç›®ç®¡ç†", "é¡¹ç›®è¯¦æƒ…"],
            },
            "project/progress": {
              page: "../é¡¹ç›®æ¨¡å—/é¡¹ç›®è¿›åº¦.html",
              breadcrumb: ["é¡¹ç›®ç®¡ç†", "é¡¹ç›®è¿›åº¦"],
            },
            "acceptance/list": {
              page: "../éªŒæ”¶æ¨¡å—/æŠ¥å‘Šåˆ—è¡¨.html",
              breadcrumb: ["éªŒæ”¶ç®¡ç†", "æŠ¥å‘Šåˆ—è¡¨"],
            },
            "acceptance/generate": {
              page: "../éªŒæ”¶æ¨¡å—/æŠ¥å‘Šç”Ÿæˆ.html",
              breadcrumb: ["éªŒæ”¶ç®¡ç†", "æŠ¥å‘Šç”Ÿæˆ"],
            },
            "acceptance/report": {
              page: "../éªŒæ”¶æ¨¡å—/æŠ¥å‘Šåˆ—è¡¨.html",
              breadcrumb: ["éªŒæ”¶ç®¡ç†", "æŠ¥å‘Šç®¡ç†"],
            },
            "system/user": {
              page: "../ç³»ç»Ÿç®¡ç†/ç”¨æˆ·ç®¡ç†.html",
              breadcrumb: ["ç³»ç»Ÿç®¡ç†", "ç”¨æˆ·ç®¡ç†"],
            },
            "system/role": {
              page: "../ç³»ç»Ÿç®¡ç†/è§’è‰²æƒé™.html",
              breadcrumb: ["ç³»ç»Ÿç®¡ç†", "è§’è‰²æƒé™"],
            },
            "system/config": {
              page: "../ç³»ç»Ÿç®¡ç†/ç³»ç»Ÿé…ç½®.html",
              breadcrumb: ["ç³»ç»Ÿç®¡ç†", "ç³»ç»Ÿé…ç½®"],
            },
            "system/logs": {
              page: "../ç³»ç»Ÿç®¡ç†/æ—¥å¿—ç®¡ç†.html",
              breadcrumb: ["ç³»ç»Ÿç®¡ç†", "æ—¥å¿—ç®¡ç†"],
            },
            "ai/chat": {
              page: "../AIåŠ©æ‰‹/AIå¯¹è¯.html",
              breadcrumb: ["AIåŠ©æ‰‹", "AIå¯¹è¯"],
            },
            "ai/knowledge": {
              page: "../AIåŠ©æ‰‹/çŸ¥è¯†åº“.html",
              breadcrumb: ["AIåŠ©æ‰‹", "çŸ¥è¯†åº“"],
            },
          };

          const handleMenuSelect = (index) => {
            console.log("èœå•é€‰æ‹©:", index);
            const menuItem = menuMap[index];
            if (menuItem) {
              activeMenu.value = index;
              currentPage.value = menuItem.page;
              breadcrumbs.value = menuItem.breadcrumb;
              console.log("åŠ è½½é¡µé¢:", menuItem.page);
            } else {
              console.warn("æœªæ‰¾åˆ°èœå•é¡¹:", index);
            }
          };

          const handleCommand = (command) => {
            console.log("ç”¨æˆ·èœå•å‘½ä»¤:", command);
            switch (command) {
              case "profile":
                // è·³è½¬åˆ°ä¸ªäººä¿¡æ¯é¡µé¢
                handleMenuSelect("user/profile");
                break;
              case "logout":
                ElMessage.success("é€€å‡ºç™»å½•æˆåŠŸ");
                // æ¸…é™¤æœ¬åœ°å­˜å‚¨
                localStorage.removeItem("auth_token");
                localStorage.removeItem("remember_token");
                // è·³è½¬åˆ°ç™»å½•é¡µé¢
                setTimeout(() => {
                  window.location.href = "../è®¤è¯æ¨¡å—/ç™»å½•.html";
                }, 1000);
                break;
            }
          };

          // æŠ˜å èœå•åˆ‡æ¢å‡½æ•°
          const toggleMenu = () => {
            collapsed.value = !collapsed.value;
          };

          // ç›‘å¬æ¥è‡ªiframeçš„æ¶ˆæ¯
          window.addEventListener("message", (event) => {
            console.log("æ”¶åˆ°iframeæ¶ˆæ¯:", event.data);
            if (event.data && event.data.type === "navigate") {
              handleMenuSelect(event.data.path);
            }
          });

          // åˆå§‹åŒ–æ—¶åŠ è½½ç™»å½•é¡µé¢
          console.log("åˆå§‹åŒ–åº”ç”¨ï¼ŒåŠ è½½ç™»å½•é¡µé¢");

          return {
            activeMenu,
            collapsed,
            currentPage,
            breadcrumbs,
            handleMenuSelect,
            handleCommand,
            toggleMenu,
          };
        },
      })
        .use(ElementPlus)
        .mount("#app");
    </script>
  </body>
</html>
