<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>é¡¹ç›®è¿›åº¦ - é«˜æ ¡ç§‘ç ”é¡¹ç›®ç®¡ç†å¹³å°</title>
    <link rel="icon" href="../images/favicon.ico" type="image/x-icon" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/element-plus@2.3.14/dist/index.css"
    />
    <script src="https://unpkg.com/vue@3.2.47/dist/vue.global.prod.js"></script>
    <script src="https://unpkg.com/element-plus@2.3.14"></script>
    <link rel="stylesheet" href="../é€šç”¨è§„èŒƒ/æ ·å¼.css" />
    <style>
      .project-progress-container {
        padding: 20px;
        background: #f7f9fc;
        min-height: calc(100vh - 56px);
      }

      .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .page-title {
        font-size: 24px;
        font-weight: 600;
        color: #1e3a8a;
        margin: 0;
      }

      .content-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 20px;
      }

      .card {
        background: #ffffff;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
        border: 1px solid #e5e7eb;
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 1px solid #e5e7eb;
      }

      .card-title {
        font-size: 16px;
        font-weight: 600;
        color: #111827;
        margin: 0;
      }

      /* è¿›åº¦æ¦‚è§ˆæ ·å¼ */
      .progress-overview {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .overall-progress {
        text-align: center;
        padding: 20px;
        background: #f8fafc;
        border-radius: 8px;
      }

      .progress-percentage {
        font-size: 48px;
        font-weight: 700;
        color: #1e3a8a;
        margin-bottom: 8px;
      }

      .progress-label {
        font-size: 16px;
        color: #6b7280;
        margin-bottom: 16px;
      }

      .progress-bar-large {
        width: 100%;
        height: 12px;
        background: #e5e7eb;
        border-radius: 6px;
        overflow: hidden;
        margin-bottom: 16px;
      }

      .progress-fill-large {
        height: 100%;
        background: linear-gradient(90deg, #1e3a8a 0%, #0ea5e9 100%);
        border-radius: 6px;
        transition: width 0.5s ease;
      }

      .progress-time {
        display: flex;
        justify-content: space-between;
        font-size: 14px;
        color: #6b7280;
      }

      .progress-stats {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 16px;
      }

      .stat-item {
        text-align: center;
        padding: 16px;
        background: #f8fafc;
        border-radius: 8px;
      }

      .stat-number {
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 4px;
      }

      .stat-label {
        font-size: 12px;
        color: #6b7280;
      }

      .stat-completed .stat-number {
        color: #16a34a;
      }

      .stat-progress .stat-number {
        color: #f59e0b;
      }

      .stat-planned .stat-number {
        color: #2563eb;
      }

      .stat-delayed .stat-number {
        color: #dc2626;
      }

      /* é‡Œç¨‹ç¢‘åˆ—è¡¨æ ·å¼ */
      .milestone-list {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      .milestone-item {
        padding: 16px;
        background: #f8fafc;
        border-radius: 8px;
        border-left: 4px solid #e5e7eb;
      }

      .milestone-item.completed {
        border-left-color: #16a34a;
        background: #f0fdf4;
      }

      .milestone-item.progress {
        border-left-color: #f59e0b;
        background: #fffbeb;
      }

      .milestone-item.planned {
        border-left-color: #2563eb;
        background: #eff6ff;
      }

      .milestone-item.delayed {
        border-left-color: #dc2626;
        background: #fef2f2;
      }

      .milestone-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
      }

      .milestone-name {
        font-size: 16px;
        font-weight: 600;
        color: #111827;
      }

      .milestone-status {
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 500;
      }

      .status-completed {
        background: #d1fae5;
        color: #059669;
      }

      .status-progress {
        background: #fef3c7;
        color: #d97706;
      }

      .status-planned {
        background: #dbeafe;
        color: #1e40af;
      }

      .status-delayed {
        background: #fee2e2;
        color: #dc2626;
      }

      .milestone-description {
        font-size: 14px;
        color: #6b7280;
        margin-bottom: 12px;
      }

      .milestone-progress {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 8px;
      }

      .milestone-progress-bar {
        flex: 1;
        height: 6px;
        background: #e5e7eb;
        border-radius: 3px;
        overflow: hidden;
      }

      .milestone-progress-fill {
        height: 100%;
        border-radius: 3px;
        transition: width 0.3s ease;
      }

      .milestone-progress-fill.completed {
        background: #16a34a;
      }

      .milestone-progress-fill.progress {
        background: #f59e0b;
      }

      .milestone-progress-fill.planned {
        background: #2563eb;
      }

      .milestone-progress-fill.delayed {
        background: #dc2626;
      }

      .milestone-progress-text {
        font-size: 12px;
        color: #6b7280;
        min-width: 35px;
      }

      .milestone-time {
        display: flex;
        justify-content: space-between;
        font-size: 12px;
        color: #9ca3af;
      }

      .milestone-actions {
        display: flex;
        gap: 8px;
        margin-top: 12px;
      }

      /* æ—¶é—´è½´è§†å›¾æ ·å¼ */
      .timeline-container {
        position: relative;
        padding-left: 24px;
      }

      .timeline-line {
        position: absolute;
        left: 12px;
        top: 0;
        bottom: 0;
        width: 2px;
        background: #e5e7eb;
      }

      .timeline-item {
        position: relative;
        margin-bottom: 24px;
        padding-left: 24px;
      }

      .timeline-dot {
        position: absolute;
        left: -6px;
        top: 8px;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: 3px solid #ffffff;
        box-shadow: 0 0 0 2px #e5e7eb;
      }

      .timeline-dot.completed {
        background: #16a34a;
        box-shadow: 0 0 0 2px #16a34a;
      }

      .timeline-dot.progress {
        background: #f59e0b;
        box-shadow: 0 0 0 2px #f59e0b;
      }

      .timeline-dot.planned {
        background: #2563eb;
        box-shadow: 0 0 0 2px #2563eb;
      }

      .timeline-dot.delayed {
        background: #dc2626;
        box-shadow: 0 0 0 2px #dc2626;
      }

      .timeline-content {
        background: #ffffff;
        border-radius: 8px;
        padding: 16px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
      }

      .timeline-title {
        font-size: 16px;
        font-weight: 600;
        color: #111827;
        margin-bottom: 4px;
      }

      .timeline-time {
        font-size: 12px;
        color: #6b7280;
        margin-bottom: 8px;
      }

      .timeline-description {
        font-size: 14px;
        color: #374151;
        line-height: 1.5;
      }

      /* æ·»åŠ é‡Œç¨‹ç¢‘å¯¹è¯æ¡† */
      .milestone-form {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }

      .loading-container {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 40px;
        color: #6b7280;
        font-size: 14px;
      }

      .loading-container .el-icon {
        margin-right: 8px;
        font-size: 16px;
      }

      .empty-state {
        text-align: center;
        padding: 40px 20px;
        color: #6b7280;
      }

      .empty-state-icon {
        font-size: 48px;
        margin-bottom: 16px;
        opacity: 0.5;
      }

      .empty-state-text {
        font-size: 16px;
        margin-bottom: 8px;
      }

      .empty-state-hint {
        font-size: 14px;
        color: #9ca3af;
      }

      /* å“åº”å¼è®¾è®¡ */
      @media (max-width: 768px) {
        .content-grid {
          grid-template-columns: 1fr;
        }

        .progress-stats {
          grid-template-columns: repeat(2, 1fr);
        }

        .form-row {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div id="app">
      <div class="project-progress-container">
        <!-- é¡µé¢å¤´éƒ¨ -->
        <div class="page-header">
          <h1 class="page-title">é¡¹ç›®è¿›åº¦</h1>
          <div>
            <el-button @click="handleBack">
              <el-icon><ArrowLeft /></el-icon>
              è¿”å›è¯¦æƒ…
            </el-button>
            <el-button type="primary" @click="showAddDialog = true">
              <el-icon><Plus /></el-icon>
              æ·»åŠ é‡Œç¨‹ç¢‘
            </el-button>
          </div>
        </div>

        <!-- åŠ è½½çŠ¶æ€ -->
        <div v-if="loading" class="loading-container">
          <el-icon class="is-loading"><Loading /></el-icon>
          <span>åŠ è½½ä¸­...</span>
        </div>

        <!-- ä¸»è¦å†…å®¹ -->
        <div v-else class="content-grid">
          <!-- å·¦ä¾§ï¼šè¿›åº¦æ¦‚è§ˆ -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">è¿›åº¦æ¦‚è§ˆ</h2>
            </div>

            <div class="progress-overview">
              <!-- æ•´ä½“è¿›åº¦ -->
              <div class="overall-progress">
                <div class="progress-percentage">{{ overallProgress }}%</div>
                <div class="progress-label">æ•´ä½“å®Œæˆè¿›åº¦</div>
                <div class="progress-bar-large">
                  <div
                    class="progress-fill-large"
                    :style="{ width: overallProgress + '%' }"
                  ></div>
                </div>
                <div class="progress-time">
                  <span>å¼€å§‹æ—¶é—´ï¼š{{ projectStartTime }}</span>
                  <span>é¢„è®¡å®Œæˆï¼š{{ projectEndTime }}</span>
                </div>
              </div>

              <!-- è¿›åº¦ç»Ÿè®¡ -->
              <div class="progress-stats">
                <div class="stat-item stat-completed">
                  <div class="stat-number">{{ stats.completed }}</div>
                  <div class="stat-label">å·²å®Œæˆ</div>
                </div>
                <div class="stat-item stat-progress">
                  <div class="stat-number">{{ stats.progress }}</div>
                  <div class="stat-label">è¿›è¡Œä¸­</div>
                </div>
                <div class="stat-item stat-planned">
                  <div class="stat-number">{{ stats.planned }}</div>
                  <div class="stat-label">æœªå¼€å§‹</div>
                </div>
                <div class="stat-item stat-delayed">
                  <div class="stat-number">{{ stats.delayed }}</div>
                  <div class="stat-label">å·²å»¶æœŸ</div>
                </div>
              </div>
            </div>
          </div>

          <!-- å³ä¾§ï¼šé‡Œç¨‹ç¢‘åˆ—è¡¨ -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">é‡Œç¨‹ç¢‘ç®¡ç†</h2>
            </div>

            <div v-if="milestones.length > 0" class="milestone-list">
              <div
                v-for="milestone in milestones"
                :key="milestone.id"
                class="milestone-item"
                :class="milestone.status"
              >
                <div class="milestone-header">
                  <div class="milestone-name">{{ milestone.name }}</div>
                  <span :class="`milestone-status status-${milestone.status}`">
                    {{ getStatusText(milestone.status) }}
                  </span>
                </div>

                <div class="milestone-description">
                  {{ milestone.description }}
                </div>

                <div class="milestone-progress">
                  <div class="milestone-progress-bar">
                    <div
                      class="milestone-progress-fill"
                      :class="milestone.status"
                      :style="{ width: milestone.progress + '%' }"
                    ></div>
                  </div>
                  <span class="milestone-progress-text"
                    >{{ milestone.progress }}%</span
                  >
                </div>

                <div class="milestone-time">
                  <span>å¼€å§‹ï¼š{{ milestone.startTime }}</span>
                  <span>ç»“æŸï¼š{{ milestone.endTime }}</span>
                </div>

                <div class="milestone-actions">
                  <el-button
                    size="small"
                    @click="handleEditMilestone(milestone.id)"
                  >
                    ç¼–è¾‘
                  </el-button>
                  <el-button
                    size="small"
                    type="danger"
                    @click="handleDeleteMilestone(milestone.id)"
                  >
                    åˆ é™¤
                  </el-button>
                </div>
              </div>
            </div>

            <!-- ç©ºçŠ¶æ€ -->
            <div v-else class="empty-state">
              <div class="empty-state-icon">ğŸ“…</div>
              <div class="empty-state-text">æš‚æ— é‡Œç¨‹ç¢‘</div>
              <div class="empty-state-hint">æ·»åŠ é¡¹ç›®é‡Œç¨‹ç¢‘</div>
            </div>
          </div>
        </div>

        <!-- æ—¶é—´è½´è§†å›¾ -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">æ—¶é—´è½´è§†å›¾</h2>
          </div>

          <div v-if="milestones.length > 0" class="timeline-container">
            <div class="timeline-line"></div>
            <div
              v-for="milestone in milestones"
              :key="milestone.id"
              class="timeline-item"
            >
              <div :class="`timeline-dot ${milestone.status}`"></div>
              <div class="timeline-content">
                <div class="timeline-title">{{ milestone.name }}</div>
                <div class="timeline-time">
                  {{ milestone.startTime }} - {{ milestone.endTime }}
                </div>
                <div class="timeline-description">
                  {{ milestone.description }}
                </div>
              </div>
            </div>
          </div>

          <!-- ç©ºçŠ¶æ€ -->
          <div v-else class="empty-state">
            <div class="empty-state-icon">ğŸ“…</div>
            <div class="empty-state-text">æš‚æ— æ—¶é—´è½´æ•°æ®</div>
            <div class="empty-state-hint">æ·»åŠ é‡Œç¨‹ç¢‘åæ˜¾ç¤ºæ—¶é—´è½´</div>
          </div>
        </div>

        <!-- æ·»åŠ é‡Œç¨‹ç¢‘å¯¹è¯æ¡† -->
        <el-dialog
          v-model="showAddDialog"
          title="æ·»åŠ é‡Œç¨‹ç¢‘"
          width="600px"
          :before-close="handleCloseDialog"
        >
          <div class="milestone-form">
            <el-form :model="milestoneForm" label-width="100px">
              <el-form-item label="é‡Œç¨‹ç¢‘åç§°" required>
                <el-input
                  v-model="milestoneForm.name"
                  placeholder="è¯·è¾“å…¥é‡Œç¨‹ç¢‘åç§°"
                />
              </el-form-item>

              <el-form-item label="æè¿°">
                <el-input
                  v-model="milestoneForm.description"
                  type="textarea"
                  :rows="3"
                  placeholder="è¯·è¾“å…¥é‡Œç¨‹ç¢‘æè¿°"
                />
              </el-form-item>

              <div class="form-row">
                <el-form-item label="å¼€å§‹æ—¶é—´" required>
                  <el-date-picker
                    v-model="milestoneForm.startTime"
                    type="date"
                    placeholder="é€‰æ‹©å¼€å§‹æ—¶é—´"
                    style="width: 100%"
                  />
                </el-form-item>

                <el-form-item label="ç»“æŸæ—¶é—´" required>
                  <el-date-picker
                    v-model="milestoneForm.endTime"
                    type="date"
                    placeholder="é€‰æ‹©ç»“æŸæ—¶é—´"
                    style="width: 100%"
                  />
                </el-form-item>
              </div>

              <el-form-item label="ä¼˜å…ˆçº§">
                <el-select
                  v-model="milestoneForm.priority"
                  placeholder="é€‰æ‹©ä¼˜å…ˆçº§"
                  style="width: 100%"
                >
                  <el-option label="é«˜" value="high" />
                  <el-option label="ä¸­" value="medium" />
                  <el-option label="ä½" value="low" />
                </el-select>
              </el-form-item>
            </el-form>
          </div>

          <template #footer>
            <el-button @click="handleCloseDialog">å–æ¶ˆ</el-button>
            <el-button type="primary" @click="handleAddMilestone"
              >ç¡®å®š</el-button
            >
          </template>
        </el-dialog>
      </div>
    </div>

    <script>
      const { createApp, ref, onMounted } = Vue;
      const { ElMessage, ElMessageBox } = ElementPlus;

      // æ³¨å†ŒLoadingå›¾æ ‡
      const Loading = {
        template:
          '<svg class="el-icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 896a32 32 0 0 1-32-32V736a32 32 0 0 1 64 0v192a32 32 0 0 1-32 32zm448-480a32 32 0 0 1-32 32H736a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM96 512a32 32 0 0 1 32-32h192a32 32 0 0 1 0 64H128a32 32 0 0 1-32-32zm778.24-200.96a32 32 0 0 1 45.248 45.248l-135.68 135.68a32 32 0 1 1-45.248-45.248l135.68-135.68zm-636.48 636.48a32 32 0 0 1 45.248 45.248l-135.68 135.68a32 32 0 1 1-45.248-45.248l135.68-135.68zM778.24 712.96a32 32 0 0 1-45.248 45.248l-135.68-135.68a32 32 0 1 1 45.248-45.248l135.68 135.68zM141.76 311.04a32 32 0 0 1-45.248-45.248l135.68-135.68a32 32 0 1 1 45.248 45.248l-135.68 135.68z"/></svg>',
      };

      createApp({
        components: {
          Loading,
        },
        setup() {
          // å“åº”å¼æ•°æ®
          const loading = ref(false);
          const milestones = ref([]);
          const showAddDialog = ref(false);
          const milestoneForm = ref({
            name: "",
            description: "",
            startTime: "",
            endTime: "",
            priority: "medium",
          });

          // è®¡ç®—å±æ€§
          const overallProgress = ref(0);
          const projectStartTime = ref("2024-01-15");
          const projectEndTime = ref("2024-06-30");
          const stats = ref({
            completed: 0,
            progress: 0,
            planned: 0,
            delayed: 0,
          });

          // æ¨¡æ‹Ÿé‡Œç¨‹ç¢‘æ•°æ®
          const mockMilestones = [
            {
              id: 1,
              name: "éœ€æ±‚åˆ†æå®Œæˆ",
              description: "å®Œæˆé¡¹ç›®éœ€æ±‚è°ƒç ”å’Œåˆ†æï¼Œç¡®å®šæŠ€æœ¯æ–¹æ¡ˆ",
              status: "completed",
              progress: 100,
              startTime: "2024-01-15",
              endTime: "2024-01-31",
            },
            {
              id: 2,
              name: "ç³»ç»Ÿè®¾è®¡å®Œæˆ",
              description: "å®Œæˆç³»ç»Ÿæ¶æ„è®¾è®¡å’Œæ•°æ®åº“è®¾è®¡",
              status: "completed",
              progress: 100,
              startTime: "2024-02-01",
              endTime: "2024-02-15",
            },
            {
              id: 3,
              name: "æ ¸å¿ƒåŠŸèƒ½å¼€å‘",
              description: "å¼€å‘ç³»ç»Ÿæ ¸å¿ƒåŠŸèƒ½æ¨¡å—",
              status: "progress",
              progress: 65,
              startTime: "2024-02-16",
              endTime: "2024-04-15",
            },
            {
              id: 4,
              name: "ç³»ç»Ÿæµ‹è¯•",
              description: "è¿›è¡Œç³»ç»ŸåŠŸèƒ½æµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•",
              status: "planned",
              progress: 0,
              startTime: "2024-04-16",
              endTime: "2024-05-15",
            },
            {
              id: 5,
              name: "é¡¹ç›®éªŒæ”¶",
              description: "é¡¹ç›®æœ€ç»ˆéªŒæ”¶å’Œäº¤ä»˜",
              status: "planned",
              progress: 0,
              startTime: "2024-05-16",
              endTime: "2024-06-30",
            },
          ];

          // è·å–çŠ¶æ€æ–‡æœ¬
          const getStatusText = (status) => {
            const statusMap = {
              planned: "æœªå¼€å§‹",
              progress: "è¿›è¡Œä¸­",
              completed: "å·²å®Œæˆ",
              delayed: "å·²å»¶æœŸ",
            };
            return statusMap[status] || "æœªçŸ¥";
          };

          // è®¡ç®—æ•´ä½“è¿›åº¦
          const calculateOverallProgress = () => {
            if (milestones.value.length === 0) {
              overallProgress.value = 0;
              return;
            }

            const totalProgress = milestones.value.reduce((sum, milestone) => {
              return sum + milestone.progress;
            }, 0);

            overallProgress.value = Math.round(
              totalProgress / milestones.value.length
            );
          };

          // è®¡ç®—ç»Ÿè®¡æ•°æ®
          const calculateStats = () => {
            stats.value = {
              completed: milestones.value.filter(
                (m) => m.status === "completed"
              ).length,
              progress: milestones.value.filter((m) => m.status === "progress")
                .length,
              planned: milestones.value.filter((m) => m.status === "planned")
                .length,
              delayed: milestones.value.filter((m) => m.status === "delayed")
                .length,
            };
          };

          // åŠ è½½é‡Œç¨‹ç¢‘æ•°æ®
          const loadMilestones = async () => {
            loading.value = true;
            try {
              // æ¨¡æ‹ŸAPIè°ƒç”¨
              await new Promise((resolve) => setTimeout(resolve, 1000));

              milestones.value = mockMilestones;
              calculateOverallProgress();
              calculateStats();
            } catch (error) {
              ElMessage.error("åŠ è½½é‡Œç¨‹ç¢‘æ•°æ®å¤±è´¥");
            } finally {
              loading.value = false;
            }
          };

          // è¿”å›è¯¦æƒ…é¡µ
          const handleBack = () => {
            ElMessage.info("è¿”å›é¡¹ç›®è¯¦æƒ…");
            // æ£€æŸ¥æ˜¯å¦åœ¨iframeä¸­
            if (window.parent !== window) {
              window.parent.postMessage(
                {
                  type: "navigate",
                  path: "project/detail",
                },
                "*"
              );
            } else {
              window.location.href = "é¡¹ç›®è¯¦æƒ….html";
            }
          };

          // ç¼–è¾‘é‡Œç¨‹ç¢‘
          const handleEditMilestone = (milestoneId) => {
            ElMessage.info(`ç¼–è¾‘é‡Œç¨‹ç¢‘: ${milestoneId}`);
            // è¿™é‡Œåº”è¯¥æ‰“å¼€ç¼–è¾‘é‡Œç¨‹ç¢‘å¯¹è¯æ¡†
          };

          // åˆ é™¤é‡Œç¨‹ç¢‘
          const handleDeleteMilestone = async (milestoneId) => {
            try {
              await ElMessageBox.confirm(
                "ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé‡Œç¨‹ç¢‘å—ï¼Ÿ",
                "ç¡®è®¤åˆ é™¤",
                {
                  confirmButtonText: "ç¡®å®š",
                  cancelButtonText: "å–æ¶ˆ",
                  type: "warning",
                }
              );

              ElMessage.success("é‡Œç¨‹ç¢‘åˆ é™¤æˆåŠŸ");
              // è¿™é‡Œåº”è¯¥è°ƒç”¨APIåˆ é™¤é‡Œç¨‹ç¢‘
              loadMilestones();
            } catch (error) {
              // ç”¨æˆ·å–æ¶ˆåˆ é™¤
            }
          };

          // å…³é—­å¯¹è¯æ¡†
          const handleCloseDialog = () => {
            showAddDialog.value = false;
            milestoneForm.value = {
              name: "",
              description: "",
              startTime: "",
              endTime: "",
              priority: "medium",
            };
          };

          // æ·»åŠ é‡Œç¨‹ç¢‘
          const handleAddMilestone = () => {
            if (!milestoneForm.value.name.trim()) {
              ElMessage.warning("è¯·è¾“å…¥é‡Œç¨‹ç¢‘åç§°");
              return;
            }

            if (
              !milestoneForm.value.startTime ||
              !milestoneForm.value.endTime
            ) {
              ElMessage.warning("è¯·é€‰æ‹©å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´");
              return;
            }

            ElMessage.success("é‡Œç¨‹ç¢‘æ·»åŠ æˆåŠŸ");
            handleCloseDialog();
            loadMilestones();
          };

          // ç»„ä»¶æŒ‚è½½æ—¶åŠ è½½æ•°æ®
          onMounted(() => {
            console.log("é¡¹ç›®è¿›åº¦é¡µé¢åŠ è½½ä¸­...");
            loadMilestones();
          });

          return {
            loading,
            milestones,
            showAddDialog,
            milestoneForm,
            overallProgress,
            projectStartTime,
            projectEndTime,
            stats,
            getStatusText,
            handleBack,
            handleEditMilestone,
            handleDeleteMilestone,
            handleCloseDialog,
            handleAddMilestone,
          };
        },
      })
        .use(ElementPlus)
        .mount("#app");
    </script>
  </body>
</html>
