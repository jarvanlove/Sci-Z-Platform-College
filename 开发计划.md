# 高校科研项目管理平台开发计划

## 1. 项目概述

### 1.1 项目信息

- **项目名称**：高校科研项目管理平台（Sci-Z-Platform-College）
- **开发模式**：前后端分离 + 单体应用 + DDD 领域驱动设计
- **技术栈**：Java 21 + Spring Boot 3.2.x + PostgreSQL + Redis + Kafka + MinIO + Dify + Vue 3 + Element Plus
- **硬件集成**：沐曦 GPU + 大模型部署 + Dify 工作流编排
- **目标人群**：高校科研人员、科研管理部门、系统管理员
- **交付目标**：实现申报-执行-验收全流程 + AI 智能化 + 硬件 GPU 加速

### 1.2 核心能力与技术难点

**核心功能**：

- 用户管理（认证授权、RBAC、多行业支持）
- 申报管理（Dify 工作流触发、状态跟踪）
- 项目管理（成员、文档、进度、知识库同步）
- 报告管理（AI 生成、多格式导出）
- 文件管理（MinIO 存储、去重、预览）
- 知识库管理（多层级、AI 问答）
- AI 助手（智能对话、知识检索）
- 系统管理（配置、日志、监控）

**技术难点**：

- 🔥 **沐曦 GPU 大模型部署**：硬件驱动、模型优化、推理加速
- 🔥 **Dify 复杂工作流编排**：多节点流程、条件分支、异常处理
- 🔥 **MinIO 与 Dify 知识库交互**：文件同步、向量化、检索优化
- 🔥 **文件上传与知识库集成**：实时同步、增量更新、冲突处理
- 🔥 **Java 21 虚拟线程**：高并发处理、性能优化
- 🔥 **DDD 领域边界**：单体应用中的领域隔离、事件驱动

---

## 2. 开发周期规划（2 个月/8 周）

### 2.0 可行性分析（2 人团队）

**时间评估**：

- **总工作量**：约 320 人天（按建议时间累加）
- **2 人团队**：8 周 × 5 天 × 2 人 = 80 人天
- **时间缺口**：320 - 80 = 240 人天缺口

**风险分析**：

- ❌ **严重不足**：2 人团队无法在 2 个月内完成
- ❌ **技术难点**：GPU 部署、Dify 工作流、MinIO 同步需要额外时间
- ❌ **测试时间**：并行测试需要额外人力

**建议方案**：

1. **增加人力**：至少需要 4-5 人团队
2. **延长周期**：建议 4-5 个月完成
3. **分阶段交付**：MVP 版本（核心功能）2 个月，完整版本 4 个月

**当前计划调整**：

- 保持 2 个月周期（按需求）
- 每项任务标注建议时间
- 重点标注 🔥 技术难点（需要更多时间）
- 建议并行开发（前后端同时进行）

### 第 1 周：基础环境与硬件部署

#### 1.1 开发环境搭建

- [ ] **Java 21 + Spring Boot 3.2.x** 项目初始化 `[建议时间: 0.5天]`
- [ ] **DDD 分层架构**搭建（interfaces/application/domain/infrastructure）`[建议时间: 1天]`
- [ ] **PostgreSQL 15** + **Redis 7.x** + **Kafka 3.x** 环境配置 `[建议时间: 1天]`
- [ ] **MinIO 集群**部署与配置 `[建议时间: 0.5天]`
- [ ] **Vue 3 + Vite + Element Plus** 前端工程初始化 `[建议时间: 1天]`

#### 1.2 沐曦 GPU 环境部署 🔥

- [ ] **沐曦 GPU 驱动**安装与测试 `[建议时间: 1天]`
- [ ] **CUDA 环境**配置（兼容沐曦 GPU）`[建议时间: 1天]`
- [ ] **大模型部署**（Qwen/GLM 等，支持沐曦 GPU 加速）`[建议时间: 1天]`
- [ ] **模型推理性能**测试与优化 `[建议时间: 0.5天]`
- [ ] **GPU 内存管理**与多模型并发 `[建议时间: 0.5天]`

#### 1.3 Dify 平台部署 🔥

- [ ] **Dify 平台**安装与配置 `[建议时间: 1天]`
- [ ] **向量数据库**部署（支持沐曦 GPU 加速）`[建议时间: 0.5天]`
- [ ] **工作流模板**设计（申报、报告生成）`[建议时间: 1天]`
- [ ] **API 接口**测试与认证配置 `[建议时间: 0.5天]`

**里程碑**：基础环境可用，GPU 加速正常，Dify 平台可访问

---

### 第 2 周：数据库设计与核心架构

#### 2.1 数据库设计

- [x] **26 张表**创建（与开发文档 4.2 一致）`[建议时间: 1天]`
- [x] **主键策略**：`BIGINT GENERATED BY DEFAULT AS IDENTITY` `[建议时间: 0.5天]`
- [x] **逻辑删除**：`is_deleted`字段统一 `[建议时间: 0.5天]`
- [x] **索引优化**：查询性能、外键、状态字段 `[建议时间: 1天]`
- [x] **数据迁移脚本**：V1-V4 版本管理 `[建议时间: 0.5天]`

#### 2.2 DDD 领域建模 🔥

- [x] **8 大领域**边界定义（IAM、申报、项目、报告、知识库、文件存储、AI 助手、系统配置）`[建议时间: 1天]`
- [x] **聚合根**设计（User、Declaration、Project、Report 等）`[建议时间: 1天]`
- [x] **领域事件**定义（申报提交、项目创建、报告生成等）`[建议时间: 0.5天]`
- [x] **仓储接口**设计（Repository Pattern）`[建议时间: 0.5天]`

#### 2.3 核心框架集成

- [x] **Sa-Token**权限认证集成 `[建议时间: 1天]`
- [x] **MyBatis-Plus** ORM 配置 `[建议时间: 0.5天]`
- [x] **Kafka**事件发布/消费 `[建议时间: 1天]`
- [x] **统一异常处理**与日志链路追踪 `[建议时间: 0.5天]`

**里程碑**：数据库结构完整，DDD 架构清晰，基础框架可用

---

### 第 3 周：认证模块与权限系统

#### 3.1 后端认证功能

- [ ] **用户注册/登录**API（支持多行业字段）`[建议时间: 1天]`
- [x] **JWT Token**生成与验证 `[建议时间: 0.5天]`
- [] **RBAC 权限**系统（角色、权限、用户关联）`[建议时间: 2天]`
- [ ] **登录日志**记录与查询 `[建议时间: 0.5天]`
- [x] **密码策略**与安全配置 `[建议时间: 0.5天]`

#### 3.2 前端认证界面

- [ ] **登录/注册**页面（多行业动态字段）`[建议时间: 1.5天]`
- [ ] **权限指令**：`v-permission`按钮级控制 `[建议时间: 1天]`
- [ ] **动态菜单**：基于权限树生成 `[建议时间: 1.5天]`
- [ ] **用户中心**：个人信息、安全设置 `[建议时间: 1天]`

#### 3.3 多行业支持 🔥

- [ ] **行业配置**表设计与初始化 `[建议时间: 0.5天]`
- [ ] **动态字段**渲染（不同行业显示不同字段）`[建议时间: 2天]` 🔥
- [ ] **权限树**按行业分类 `[建议时间: 1天]` 🔥
- [ ] **部门管理**按行业筛选 `[建议时间: 0.5天]`

**里程碑**：用户认证完整，权限控制精确，多行业支持可用

---

### 第 4 周：申报模块与 Dify 工作流集成

#### 4.1 申报后端功能

- [ ] **申报提交**API（研究方向、研究领域）`[建议时间: 1天]`
- [ ] **申报列表/详情**查询 `[建议时间: 0.5天]`
- [ ] **申报状态**跟踪与更新 `[建议时间: 0.5天]`
- [ ] **草稿保存**功能 `[建议时间: 0.5天]`

#### 4.2 Dify 工作流集成 🔥

- [ ] **LangChain4j**封装 Dify API 调用 `[建议时间: 2天]` 🔥
- [ ] **工作流触发**：申报提交后自动执行 `[建议时间: 1.5天]` 🔥
- [ ] **状态轮询**：实时跟踪工作流执行进度 `[建议时间: 1天]` 🔥
- [ ] **异常处理**：工作流失败重试与降级 `[建议时间: 1天]` 🔥
- [ ] **结果解析**：工作流输出结果处理 `[建议时间: 0.5天]`

#### 4.3 申报前端界面

- [ ] **新建申报**页面（富文本编辑器、标签输入）`[建议时间: 1.5天]`
- [ ] **申报列表**页面（搜索、筛选、分页）`[建议时间: 1天]`
- [ ] **申报详情**页面（状态流转、工作流进度）`[建议时间: 1天]`
- [ ] **工作流状态**实时显示 `[建议时间: 1天]` 🔥

**里程碑**：申报流程完整，Dify 工作流集成可用

---

### 第 5 周：项目管理与文件上传

#### 5.1 项目核心功能

- [ ] **项目 CRUD**（基于申报自动创建）`[建议时间: 1.5天]`
- [ ] **项目成员**管理（添加、移除、角色分配）`[建议时间: 1天]`
- [ ] **项目进度**管理（里程碑、状态更新）`[建议时间: 1天]`
- [ ] **项目权限**控制（负责人、核心成员、普通成员）`[建议时间: 0.5天]`

#### 5.2 文件上传与 MinIO 集成 🔥

- [ ] **MinIO 客户端**配置与连接测试`[建议时间: 0.5天]`
- [ ] **文件上传**API（单文件、批量上传）`[建议时间: 1.5天]` 🔥
- [ ] **文件去重**：MD5 哈希值检查`[建议时间: 0.5天]`
- [ ] **文件预览**：PDF、图片、Office 文档`[建议时间: 1天]`
- [ ] **签名 URL**生成（临时访问链接）`[建议时间: 0.5天]`
- [ ] **文件删除**：软删除与物理删除`[建议时间: 0.5天]`

#### 5.3 项目前端界面

- [ ] **项目列表**页面（搜索、筛选、状态显示）`[建议时间: 1天]`
- [ ] **项目详情**页面（基本信息、成员、进度）`[建议时间: 1天]`
- [ ] **文档管理**：拖拽上传、列表展示、预览`[建议时间: 1.5天]`
- [ ] **成员管理**：添加、移除、角色分配`[建议时间: 1天]`

**里程碑**：项目管理功能完整，文件上传稳定

---

### 第 6 周：知识库与 Dify 集成 🔥

#### 6.1 知识库管理

- [ ] **知识库 CRUD**（独立知识库、项目关联知识库）`[建议时间: 1.5天]`
- [ ] **文件夹管理**（多层级、重命名、删除）`[建议时间: 1.5天]`
- [ ] **文件关联**（知识库文件与附件系统关联）`[建议时间: 1天]`
- [ ] **知识库共享**设置（私有、公开）`[建议时间: 0.5天]`

#### 6.2 MinIO 与 Dify 知识库交互 🔥

- [ ] **文件同步**：MinIO 文件自动同步到 Dify 知识库`[建议时间: 2天]` 🔥
- [ ] **向量化处理**：文件内容提取与向量化`[建议时间: 2天]` 🔥
- [ ] **增量更新**：文件修改后增量同步`[建议时间: 1.5天]` 🔥
- [ ] **冲突处理**：文件版本冲突解决`[建议时间: 1天]` 🔥
- [ ] **同步状态**跟踪与错误处理`[建议时间: 0.5天]`

#### 6.3 知识库前端界面

- [ ] **知识库列表**页面`[建议时间: 0.5天]`
- [ ] **知识库详情**页面（文件夹树、文件列表）`[建议时间: 1天]`
- [ ] **文件管理**：上传、重命名、删除、移动`[建议时间: 1.5天]`
- [ ] **同步状态**显示`[建议时间: 0.5天]`

**里程碑**：知识库管理完整，MinIO 与 Dify 集成稳定

---

### 第 7 周：报告管理与 AI 生成

#### 7.1 报告管理后端

- [ ] **报告创建**API（选择项目、报告类型）`[建议时间: 0.5天]`
- [ ] **报告生成**：调用 Dify 工作流`[建议时间: 1.5天]` 🔥
- [ ] **报告配置**：风格、详细程度设置`[建议时间: 0.5天]`
- [ ] **报告内容**存储（HTML 格式，支持百万字）`[建议时间: 1天]`
- [ ] **报告导出**：PDF、Word、Markdown 格式`[建议时间: 1.5天]`

#### 7.2 Dify 报告工作流 🔥

- [ ] **报告工作流**设计（科技报告、自评报告）`[建议时间: 1.5天]` 🔥
- [ ] **工作流参数**配置（项目信息、知识库内容）`[建议时间: 0.5天]`
- [ ] **生成进度**跟踪（0-100%实时显示）`[建议时间: 0.5天]`
- [ ] **结果处理**：HTML 内容解析与存储`[建议时间: 0.5天]`
- [ ] **异常处理**：生成失败重试与降级`[建议时间: 0.5天]`

#### 7.3 报告前端界面

- [ ] **报告列表**页面（搜索、筛选、状态）`[建议时间: 0.5天]`
- [ ] **报告生成**页面（参数配置、进度显示）`[建议时间: 1天]`
- [ ] **报告预览**页面（HTML 渲染、导出按钮）`[建议时间: 1天]`
- [ ] **报告下载**功能`[建议时间: 0.5天]`

**里程碑**：报告生成功能完整，AI 工作流稳定

---

### 第 8 周：AI 助手与系统完善

#### 8.1 AI 助手功能

- [ ] **AI 对话**API（基于知识库内容）`[建议时间: 1.5天]` 🔥
- [ ] **会话管理**（创建、列表、删除、置顶）`[建议时间: 0.5天]`
- [ ] **消息历史**存储与查询`[建议时间: 0.5天]`
- [ ] **知识来源**标注与置信度显示`[建议时间: 0.5天]`
- [ ] **流式输出**支持`[建议时间: 0.5天]`

#### 8.2 系统管理功能

- [ ] **用户管理**（CRUD、角色分配、状态控制）`[建议时间: 1天]`
- [ ] **角色权限**管理（权限树、动态加载）`[建议时间: 1.5天]`
- [ ] **系统配置**（行业配置、基本配置、Dify 配置）`[建议时间: 1天]`
- [ ] **日志管理**（操作日志、登录日志、导出）`[建议时间: 1天]`

#### 8.3 前端完善

- [ ] **AI 助手**聊天界面`[建议时间: 1天]`
- [ ] **系统管理**各功能页面`[建议时间: 1.5天]`
- [ ] **仪表板**数据统计与图表`[建议时间: 1天]`
- [ ] **响应式**适配与性能优化`[建议时间: 1天]`

**里程碑**：系统功能完整，AI 助手可用

---

### 测试计划（并行执行，贯穿 8 周）

> 说明：测试与研发并行推进，每周都有明确的测试节点与产出，避免末期堆积风险。

- [ ] 第 1 周（环境验证）

  - [ ] 环境连通性与基础健康检查（DB/Redis/Kafka/MinIO/Dify）
  - [ ] 沐曦 GPU 驱动/模型推理冒烟测试
  - [ ] 前后端工程启动与基础路由冒烟

- [ ] 第 2 周（数据库与框架）

  - [ ] DDL 变更校验（建表脚本 + 回滚脚本验证）
  - [ ] ORM 映射与基础 CRUD 单元测试（MyBatis-Plus）
  - [ ] 统一异常/日志/鉴权切面冒烟

- [ ] 第 3 周（认证与权限）

  - [ ] 认证链路单元/集成测试（登录、注册、JWT、权限拦截）
  - [ ] 权限树/按钮级权限 E2E 用例（前后端联调）
  - [ ] 登录日志与安全策略（弱口令/重放）测试

- [ ] 第 4 周（申报 + 工作流）

  - [ ] 申报提交/列表/详情接口集成测试
  - [ ] Dify 工作流触发/状态轮询/失败重试链路测试
  - [ ] 富文本/标签输入的前端表单校验 E2E

- [ ] 第 5 周（项目 + 文件）

  - [ ] 项目成员/进度/权限集成测试
  - [ ] MinIO 上传/去重/预览/签名 URL 用例
  - [ ] 并发上传与大文件（>100MB）稳定性测试

- [ ] 第 6 周（知识库 + 同步）

  - [ ] 知识库 CRUD/文件夹树/文件操作用例
  - [ ] MinIO → Dify 知识库同步/向量化/增量更新链路测试
  - [ ] 冲突处理与错误回滚用例

- [ ] 第 7 周（报告 + 性能）

  - [ ] 报告生成/进度/导出（PDF/Word/Markdown）E2E 用例
  - [ ] 性能测试：QPS、P95/P99、并发用户 200/500 基线
  - [ ] 资源压测：CPU/GPU/内存/IO 监控与瓶颈定位

- [ ] 第 8 周（AI 助手 + UAT/回归）
  - [ ] AI 对话/会话管理/知识来源/流式输出用例
  - [ ] UAT 指标：关键业务 100% 通过、阻断级缺陷 0、重大缺陷关闭率 100%
  - [ ] 回归测试与上线前 Checklist（配置/脚本/灰度/回滚）

#### 测试用例与覆盖率目标

- [ ] 用例库：按模块维护（auth、declaration、project、report、knowledge、ai、system）
- [ ] 单元测试：覆盖率 ≥ 70%，关键领域服务 ≥ 80%
- [ ] 集成测试：核心链路（申报 → 项目 → 报告）全覆盖
- [ ] E2E 测试：前后端联调脚本（登录 → 申报 → 项目文档 → 知识库同步 → 报告导出）
- [ ] 安全测试：鉴权/越权/注入/上传校验/敏感信息保护
- [ ] 性能测试：基线 + 压测报告（含调优建议与复测结果）

---

## 3. 技术难点与解决方案

### 3.1 沐曦 GPU 大模型部署 🔥

**技术难点**：

- 沐曦 GPU 驱动兼容性
- CUDA 环境配置
- 大模型推理优化
- GPU 内存管理

**解决方案**：

- 使用沐曦官方驱动和 CUDA 工具包
- 模型量化与优化（INT8/FP16）
- 多模型并发管理
- 监控 GPU 使用率和温度

### 3.2 Dify 复杂工作流编排 🔥

**技术难点**：

- 多节点工作流设计
- 条件分支与循环
- 异常处理与重试
- 工作流状态管理

**解决方案**：

- 使用 Dify 可视化工作流编辑器
- 设计标准化的节点模板
- 实现工作流状态机
- 添加监控和告警机制

### 3.3 MinIO 与 Dify 知识库交互 🔥

**技术难点**：

- 文件实时同步
- 向量化处理
- 增量更新
- 冲突解决

**解决方案**：

- 实现文件变更监听
- 使用异步任务处理同步
- 设计文件版本管理
- 实现冲突检测与解决

### 3.4 Java 21 虚拟线程 🔥

**技术难点**：

- 虚拟线程池配置
- 异步编程模式
- 性能调优
- 兼容性测试

**解决方案**：

- 使用 Spring Boot 3.2.x 原生支持
- 配置虚拟线程执行器
- 优化数据库连接池
- 性能测试与监控

---

## 4. 交付清单

### 4.1 代码交付

- [ ] **后端源码**（Java 21 + Spring Boot 3.2.x）
- [ ] **前端源码**（Vue 3 + Element Plus）
- [ ] **数据库脚本**（26 张表 + 初始化数据）
- [ ] **部署脚本**（Docker + Nginx 配置）

### 4.2 文档交付

- [ ] **使用手册**（产品白皮书）
- [ ] **管理员手册**（系统配置、维护）
- [ ] **API 文档**（Swagger/OpenAPI）
- [ ] **部署文档**（环境配置、安装步骤）

### 4.3 硬件交付

- [ ] **沐曦 GPU**部署文档
- [ ] **大模型**安装与配置
- [ ] **Dify 平台**工作流模板
- [ ] **性能测试**报告

### 4.4 测试交付

- [ ] **单元测试**报告
- [ ] **集成测试**报告
- [ ] **性能测试**报告
- [ ] **安全测试**报告

---

## 5. 风险控制

### 5.1 技术风险

- **沐曦 GPU 兼容性**：提前验证驱动和 CUDA 环境
- **Dify 工作流稳定性**：设计降级方案和重试机制
- **文件同步性能**：优化同步算法和批量处理
- **Java 21 新特性**：充分测试和性能调优

### 5.2 进度风险

- **硬件部署**：预留额外时间进行 GPU 环境调试
- **工作流设计**：提前设计 Dify 工作流模板
- **集成测试**：增加集成测试时间
- **文档编写**：并行进行文档编写

### 5.3 质量风险

- **代码质量**：使用 SonarQube 进行代码质量检查
- **性能优化**：定期进行性能测试和优化
- **安全加固**：进行安全扫描和渗透测试
- **兼容性测试**：多浏览器、多设备测试

---

## 6. 团队配置建议

### 6.1 核心团队

- **后端开发**：2 人（Java 21 + Spring Boot + DDD）
- **前端开发**：2 人（Vue 3 + Element Plus）
- **AI 工程师**：1 人（Dify + 大模型 + GPU）
- **DevOps 工程师**：1 人（部署 + 监控 + 运维）

### 6.2 技能要求

- **Java 21**：虚拟线程、记录模式、模式匹配
- **Spring Boot 3.2.x**：最新特性和最佳实践
- **DDD**：领域建模、聚合设计、事件驱动
- **GPU 编程**：CUDA、模型优化、性能调优
- **工作流**：Dify 平台、复杂流程设计

---

**项目周期**：2 个月（8 周）  
**技术栈**：Java 21 + Spring Boot 3.2.x + DDD + 沐曦 GPU + Dify  
**交付目标**：完整的高校科研项目管理平台 + AI 智能化 + 硬件加速

---

## 7. 2 人团队可行性总结

### 7.1 时间缺口分析

| 周次    | 建议时间 | 2 人可用时间 | 缺口  | 风险等级    |
| ------- | -------- | ------------ | ----- | ----------- |
| 第 1 周 | 8 天     | 10 天        | -2 天 | 🟢 可行     |
| 第 2 周 | 6 天     | 10 天        | -4 天 | 🟢 可行     |
| 第 3 周 | 10 天    | 10 天        | 0 天  | 🟡 紧张     |
| 第 4 周 | 12 天    | 10 天        | +2 天 | 🔴 超时     |
| 第 5 周 | 14 天    | 10 天        | +4 天 | 🔴 严重超时 |
| 第 6 周 | 16 天    | 10 天        | +6 天 | 🔴 严重超时 |
| 第 7 周 | 12 天    | 10 天        | +2 天 | 🔴 超时     |
| 第 8 周 | 10 天    | 10 天        | 0 天  | 🟡 紧张     |

**总计缺口**：+18 天（约 3.6 周额外时间）

### 7.2 关键风险点

1. **🔥 技术难点**：

   - 沐曦 GPU 部署（第 1 周）
   - Dify 工作流集成（第 4 周）
   - MinIO 与 Dify 知识库交互（第 6 周）
   - 文件同步与向量化（第 6 周）

2. **⏰ 时间瓶颈**：

   - 第 5-6 周工作量最大（文件管理+知识库）
   - 测试时间未计入开发时间
   - 集成调试需要额外时间

3. **👥 人力不足**：
   - 需要 GPU 专家（沐曦 GPU 部署）
   - 需要 AI 工程师（Dify 工作流）
   - 需要全栈开发（前后端+数据库）

### 7.3 建议方案

#### 方案 A：增加人力（推荐）

- **团队规模**：4-5 人
- **角色分工**：
  - 后端开发：2 人（Java + DDD）
  - 前端开发：1 人（Vue + Element Plus）
  - AI 工程师：1 人（GPU + Dify + 工作流）
  - DevOps：1 人（部署 + 监控）

#### 方案 B：分阶段交付

- **MVP 版本**（2 个月）：
  - 基础功能：认证、申报、项目、文件
  - 简化 AI：基础 Dify 集成，无复杂工作流
  - 无 GPU 加速：使用 CPU 推理
- **完整版本**（4 个月）：
  - 完整 AI 功能：复杂工作流、GPU 加速
  - 知识库同步：MinIO 与 Dify 深度集成
  - 性能优化：虚拟线程、缓存优化

### 7.4 最终建议

**推荐方案 A**：增加人力至 4-5 人团队，保持 2 个月周期，确保项目质量和进度。

**如果必须 2 人团队**：建议采用方案 B，分阶段交付，先完成 MVP 版本，再逐步完善 AI 功能。
